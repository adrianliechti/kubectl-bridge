(window.webpackJsonp=window.webpackJsonp||[]).push([[205],{11767:function(e,t,s){"use strict";s.d(t,"a",(function(){return S}));var a=s(0),l=s(80),i=s(219),n=s(281),o=s(72),r=s(1191),c=s(1921),d=s(88),u=s(7),m=s(40),p=s(5),v=s(10),f=s(15),g=s(6095),k=s(7554);s(8382);const S=({dispatch:e,state:t,taintsFilter:s,diskModeOptions:S=g.h,allNodesHelpTxt:b,lvsNameHelpTxt:D,deviceTypeOptions:N=g.g,fsTypeOptions:y=g.k})=>{const{t:h}=Object(u.useTranslation)(),E=Object(g.j)(h),z=/^\+?([1-9]\d*)$/,[O,w]=a.useState(!1),[x,T]=a.useState(!1),j=/^\+?([0-9]\d*)$/.test(t.minDiskSize||"1"),I=z.test(t.maxDiskSize||"1"),M=z.test(t.maxDiskLimit||"1"),_=""!==t.minDiskSize&&""!==t.maxDiskSize&&Number(t.minDiskSize)>Number(t.maxDiskSize),C=()=>e({type:"setLvsIsSelectNodes",value:!t.lvsIsSelectNodes});a.useEffect(()=>{e(j&&I&&M&&!_?{type:"setIsValidDiskSize",value:!0}:{type:"setIsValidDiskSize",value:!1})},[e,j,I,M,_]);const L=((e,t)=>{let s;return e.diskType===g.c.All&&(s={title:t("lso-plugin~All disk type may include HDD disks. Data Foundation does not support HDD disks as local devices. Select SSD if you plan to use Data Foundation."),variant:l.b.info}),e.diskType===g.c.HDD&&(s={title:t("lso-plugin~Data Foundation does not support HDD disks as local devices. Select SSD if you plan to use Data Foundation."),variant:l.b.info}),s})(t,h);return a.createElement(a.Fragment,null,a.createElement(i.a,{label:h("lso-plugin~LocalVolumeSet Name"),isRequired:!0,fieldId:"create-lvs-volume-set-name"},a.createElement(n.a,{type:n.b.text,id:"create-lvs-volume-set-name",value:t.volumeSetName,onChange:(t,s)=>e({type:"setVolumeSetName",name:s}),isRequired:!0}),D?a.createElement("p",{className:"help-block"},D):null),a.createElement(i.a,{label:h("lso-plugin~StorageClass Name"),fieldId:"create-lvs-storage-class-name"},a.createElement(n.a,{type:n.b.text,id:"create-lvs-storage-class-name",value:t.storageClassName,placeholder:t.volumeSetName,onChange:(t,s)=>e({type:"setStorageClassName",name:s})})),a.createElement(o.a,{component:o.b.h3,className:"lso-create-lvs__filter-volumes-text--margin"},h("lso-plugin~Filter Disks By")),a.createElement(i.a,{fieldId:"create-lvs-radio-group-node-selector"},a.createElement("div",{id:"create-lvs-radio-group-node-selector"},a.createElement(r.a,{label:a.createElement(a.Fragment,null,h("lso-plugin~Disks on all nodes")," (",h("lso-plugin~{{nodes, number}} node",{nodes:t.lvsAllNodes.length,count:t.lvsAllNodes.length}),")"),name:"nodes-selection",id:"create-lvs-radio-all-nodes",className:"lso-create-lvs__all-nodes-radio--padding",value:"allNodes",onChange:C,description:b,checked:!t.lvsIsSelectNodes}),a.createElement(r.a,{label:h("lso-plugin~Disks on selected nodes"),name:"nodes-selection",id:"create-lvs-radio-select-nodes",value:"selectedNodes",onChange:C,description:h("lso-plugin~Uses the available disks that match the selected filters only on selected nodes."),checked:t.lvsIsSelectNodes}))),t.lvsIsSelectNodes&&a.createElement("div",{className:"lso-lvd-body__select-nodes"},a.createElement(m.c,{showTitle:!1,kind:v.NodeModel.kind,ListComponent:k.a,customData:{onRowSelected:t=>{e({type:"setLvsSelectNodes",value:t})},filteredNodes:t.lvsAllNodes.map(f.dd),preSelectedNodes:t.lvsSelectNodes.map(f.dd),hasOnSelect:!0,taintsFilter:s}})),a.createElement(i.a,{label:h("lso-plugin~Disk Type"),fieldId:"create-lvs-disk-type-dropdown"},a.createElement(p.t,{id:"create-lvs-disk-type-dropdown",dropDownClassName:"dropdown--full-width",items:E,title:E[t.diskType],selectedKey:t.diskType,onChange:t=>e({type:"setDiskType",value:t})}),!!L&&a.createElement(l.a,{className:"pf-v5-u-mt-md lso-disk-type__alert",variant:L.variant||l.b.danger,title:L.title,isPlain:!0})),a.createElement(c.a,{toggleText:h("lso-plugin~Advanced"),"data-test-id":"create-lvs-form-advanced"},a.createElement(i.a,{label:h("lso-plugin~Volume Mode"),fieldId:"create-lso-disk-mode-dropdown",className:"lso-create-lvs__disk-mode-dropdown--margin"},a.createElement(p.t,{id:"create-lso-disk-mode-dropdown",dropDownClassName:"dropdown--full-width",items:S,title:t.diskMode,selectedKey:t.diskMode,onChange:t=>{e({type:"setDiskMode",value:g.h[t]})}})),a.createElement(i.a,{label:"Device Type",fieldId:"create-lso-device-type-dropdown",className:"lso-create-lvs__device-type-dropdown--margin"},a.createElement(f.nb,{id:"create-lso-device-type-dropdown",options:[N.DISK,N.PART,N.MPATH],placeholder:"Select disk types",onChange:t=>{e({type:"setDeviceType",value:t})},defaultSelected:[N.DISK,N.PART]})),t.diskMode===g.h.FILESYSTEM&&a.createElement(i.a,{label:h("lso-plugin~File System Type"),fieldId:"create-lso-fs-type-dropdown",className:"lso-create-lvs__fs-type-dropdown--margin"},a.createElement(p.t,{id:"create-lso-fs-type-dropdown",dropDownClassName:"dropdown--full-width",items:y,title:t.fsType,selectedKey:t.fsType,onChange:t=>{e({type:"setFsType",value:g.k[t]})}})),a.createElement(i.a,{label:h("lso-plugin~Disk Size"),fieldId:"create-lvs-disk-size",className:"lso-create-lvs__disk-size-form-group--margin"},a.createElement("div",{id:"create-lvs-disk-size",className:"lso-create-lvs__disk-size-form-group-div"},a.createElement(i.a,{label:h("lso-plugin~Min"),fieldId:"create-lvs-min-disk-size",className:"lso-create-lvs__disk-size-form-group-max-min-input"},a.createElement(d.a,{content:h(j?"lso-plugin~Please enter a value less than or equal to max disk size":"lso-plugin~Please enter a positive Integer"),isVisible:!j||_&&O,trigger:"manual"},a.createElement(n.a,{type:n.b.text,id:"create-lvs-min-disk-size",value:t.minDiskSize,validated:!j||_&&O?"error":"default",className:"lso-create-lvs__disk-input",onFocus:()=>w(!0),onBlur:()=>w(!1),onChange:(t,s)=>{e({type:"setMinDiskSize",value:s})}}))),a.createElement("div",null,"-"),a.createElement(i.a,{label:h("lso-plugin~Max"),fieldId:"create-lvs-max-disk-size",className:"lso-create-lvs__disk-size-form-group-max-min-input"},a.createElement(d.a,{content:h(I?"lso-plugin~Please enter a value greater than or equal to min disk size":"lso-plugin~Please enter a positive Integer"),isVisible:!I||_&&x,trigger:"manual"},a.createElement(n.a,{type:n.b.text,id:"create-lvs-max-disk-size",value:t.maxDiskSize,validated:!I||_&&x?"error":"default",className:"lso-create-lvs__disk-input",onFocus:()=>T(!0),onBlur:()=>T(!1),onChange:(t,s)=>e({type:"setMaxDiskSize",value:s})}))),a.createElement(p.t,{id:"create-lvs-disk-size-unit-dropdown",items:g.i,title:g.i[t.diskSizeUnit],selectedKey:t.diskSizeUnit,onChange:t=>{e({type:"setDiskSizeUnit",value:t})}}))),a.createElement(i.a,{label:h("lso-plugin~Maximum Disks Limit"),fieldId:"create-lvs-max-disk-limit"},a.createElement("p",{className:"help-block lso-create-lvs__max-disk-limit-help-text--margin"},h("lso-plugin~Disks limit will set the maximum number of PVs to create on a node. If the field is empty we will create PVs for all available disks on the matching nodes.")),a.createElement(d.a,{content:"Please enter a positive Integer",isVisible:!M,trigger:"manual"},a.createElement(n.a,{type:n.b.text,id:"create-lvs-max-disk-limit",value:t.maxDiskLimit,validated:M?"default":"error",className:"lso-create-lvs__disk-input",onChange:(t,s)=>e({type:"setMaxDiskLimit",value:s}),placeholder:h("lso-plugin~All")})))))}},11768:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var a=s(0),l=s(563),i=s(72),n=s(7);const o=({className:e,variant:t})=>{const{t:s}=Object(n.useTranslation)();return a.createElement(a.Fragment,null,a.createElement(l.a,null,a.createElement(i.a,{component:t,className:e},s("lso-plugin~Local Volume Set"))),a.createElement("p",{className:"help-block"},s("lso-plugin~A Local Volume Set allows you to filter a set of disks, group them and create a dedicated StorageClass to consume storage from them.")))}},11769:function(e,t,s){"use strict";s.d(t,"a",(function(){return r}));var a=s(22),l=s(8),i=s(6095),n=s(788),o=s(11770);const r=(e,t,s,r)=>{var c;const d=(e=>{const{DISK:t,PART:s,MPATH:a}=i.g;return e.includes(t)&&e.includes(s)||0===e.length?[o.a.RawDisk,o.a.Partition]:e.includes(s)?[o.a.Partition]:e.includes(a)?[o.a.Multipath]:[o.a.RawDisk]})(e.deviceType),u={apiVersion:Object(l.n)(n.LocalVolumeSetModel),kind:n.LocalVolumeSetModel.kind,metadata:{name:e.volumeSetName,namespace:s},spec:{storageClassName:e.storageClassName||e.volumeSetName,volumeMode:e.diskMode,deviceInclusionSpec:{deviceTypes:d},nodeSelector:{nodeSelectorTerms:[{matchExpressions:[{key:i.d,operator:i.e,values:t}]}]}}};return e.fsType&&(u.spec.fsType=e.fsType),a.a(r)||(u.spec.tolerations=[r]),e.maxDiskLimit&&(u.spec.maxDeviceCount=+e.maxDiskLimit),e.minDiskSize&&(u.spec.deviceInclusionSpec.minSize=`${e.minDiskSize}${e.diskSizeUnit}`),e.maxDiskSize&&(u.spec.deviceInclusionSpec.maxSize=`${e.maxDiskSize}${e.diskSizeUnit}`),(null===(c=i.b[e.diskType])||void 0===c?void 0:c.property)&&(u.spec.deviceInclusionSpec.deviceMechanicalProperties=[i.b[e.diskType].property]),u}},11770:function(e,t,s){"use strict";var a,l;s.d(t,"a",(function(){return a})),function(e){e.RawDisk="disk",e.Partition="part",e.Multipath="mpath"}(a||(a={})),function(e){e.NonRotational="NonRotational",e.Rotational="Rotational"}(l||(l={}))},11771:function(e,t,s){"use strict";s.d(t,"a",(function(){return l})),s.d(t,"b",(function(){return i}));var a=s(6095);const l={volumeSetName:"",storageClassName:"",isValidDiskSize:!0,diskType:a.c.All,diskMode:a.h.BLOCK,deviceType:[],fsType:"",maxDiskLimit:"",minDiskSize:"1",maxDiskSize:"",diskSizeUnit:"Gi",lvsSelectNodes:[],lvsAllNodes:[],lvsIsSelectNodes:!1},i=(e,t)=>{switch(t.type){case"setVolumeSetName":return Object.assign({},e,{volumeSetName:t.name});case"setStorageClassName":return Object.assign({},e,{storageClassName:t.name});case"setIsValidDiskSize":return Object.assign({},e,{isValidDiskSize:t.value});case"setDiskType":return Object.assign({},e,{diskType:t.value});case"setDiskMode":return Object.assign({},e,{diskMode:t.value});case"setDeviceType":return Object.assign({},e,{deviceType:t.value});case"setFsType":return Object.assign({},e,{fsType:t.value});case"setMaxDiskLimit":return Object.assign({},e,{maxDiskLimit:t.value});case"setMinDiskSize":return Object.assign({},e,{minDiskSize:t.value});case"setMaxDiskSize":return Object.assign({},e,{maxDiskSize:t.value});case"setDiskSizeUnit":return Object.assign({},e,{diskSizeUnit:t.value});case"setLvsAllNodes":return Object.assign({},e,{lvsAllNodes:t.value});case"setLvsSelectNodes":return Object.assign({},e,{lvsSelectNodes:t.value});case"setLvsIsSelectNodes":return Object.assign({},e,{lvsIsSelectNodes:t.value});default:return l}}},5514:function(e,t,s){"use strict";s.r(t);var a=s(0),l=s(72),i=s(1922),n=s(14),o=s(5),r=s(108),c=s(983),d=s(8),u=s(519),m=s(2234),p=s(788),v=s(7552),f=s(6257),g=s(7553),k=s(11767),S=s(11768),b=s(11769),D=s(11771),N=(s(8382),function(e,t,s,a){return new(s||(s=Promise))((function(l,i){function n(e){try{r(a.next(e))}catch(e){i(e)}}function o(e){try{r(a.throw(e))}catch(e){i(e)}}function r(e){var t;e.done?l(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}r((a=a.apply(e,t||[])).next())}))});t.default=()=>{const{appName:e,ns:t}=Object(n.useParams)(),s=Object(o.uc)(u.a,e,t),[y,h]=a.useReducer(D.b,D.a),[E,z,O]=Object(r.a)(v.a),[w,x,T]=Object(m.a)();a.useEffect(()=>{if(z&&!O&&0!==(null==E?void 0:E.length)){const e=E.filter(f.d);h({type:"setLvsAllNodes",value:e})}},[E,O,z]);return a.createElement(a.Fragment,null,a.createElement("div",{className:"co-create-operand__header"},a.createElement(S.a,{variant:l.b.h1,className:"co-create-operand__header-text"})),a.createElement(i.a,{noValidate:!1,className:"co-m-pane__body lso-form-body__node-list pf-v5-u-w-75",onSubmit:s=>N(void 0,void 0,void 0,(function*(){s.preventDefault();const a=y.lvsIsSelectNodes?y.lvsSelectNodes:y.lvsAllNodes,l=Object(f.b)(a),i=Object(b.a)(y,l,t);w(Object(d.jb)(p.LocalVolumeSetModel,i)).then(()=>{c.b.push(`/k8s/ns/${t}/clusterserviceversions/${e}/${Object(d.Hb)(p.LocalVolumeSetModel)}/${y.volumeSetName}`)}).catch(()=>{})}))},a.createElement(k.a,{dispatch:h,state:y}),a.createElement(g.a,{errorMessage:T,inProgress:x,cancelUrl:s,disableNext:(()=>{const e=y.lvsIsSelectNodes?y.lvsSelectNodes:y.lvsAllNodes;return!y.volumeSetName.trim().length||(e.length<1||!y.isValidDiskSize)})()})))}},6095:function(e,t,s){"use strict";var a;s.d(t,"c",(function(){return a})),s.d(t,"h",(function(){return l})),s.d(t,"f",(function(){return i})),s.d(t,"b",(function(){return n})),s.d(t,"g",(function(){return o})),s.d(t,"k",(function(){return r})),s.d(t,"j",(function(){return c})),s.d(t,"i",(function(){return d})),s.d(t,"a",(function(){return u})),s.d(t,"d",(function(){return m})),s.d(t,"e",(function(){return p})),function(e){e.All="All",e.SSD="SSD",e.HDD="HDD"}(a||(a={}));const l=Object.freeze({BLOCK:"Block",FILESYSTEM:"Filesystem"}),i=["topology.kubernetes.io/zone","failure-domain.beta.kubernetes.io/zone"],n={[a.SSD]:{property:"NonRotational"},[a.HDD]:{property:"Rotational"}},o=Object.freeze({DISK:"Disk",PART:"Part",MPATH:"Mpath"}),r=Object.freeze({EXT4:"ext4",EXT3:"ext3",XFS:"xfs"}),c=e=>Object.freeze({[a.All]:e("lso-plugin~All"),[a.SSD]:e("lso-plugin~SSD / NVMe"),[a.HDD]:e("lso-plugin~HDD")}),d={Ti:"TiB",Gi:"GiB"},u="auto-discover-devices",m="kubernetes.io/hostname",p="In"},6257:function(e,t,s){"use strict";s.d(t,"d",(function(){return i})),s.d(t,"c",(function(){return n})),s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return r}));var a=s(22),l=s(6095);const i=e=>{var t;return a.a(null===(t=e.spec)||void 0===t?void 0:t.taints)},n=e=>{var t,s;return(null===(t=e.metadata.labels)||void 0===t?void 0:t[l.f[0]])||(null===(s=e.metadata.labels)||void 0===s?void 0:s[l.f[1]])},o=(e=[])=>{let[t,s]=[-1,-1];return e.forEach((e,a)=>{var i;s=null===(i=null==e?void 0:e.matchExpressions)||void 0===i?void 0:i.findIndex(e=>e.key===l.d&&e.operator===l.e),-1!==s&&(t=a)}),[t,s]},r=e=>e.map(e=>{var t,s;return null===(s=null===(t=e.metadata)||void 0===t?void 0:t.labels)||void 0===s?void 0:s["kubernetes.io/hostname"]})},7552:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));const a={kind:s(10).NodeModel.kind,namespaced:!1,isList:!0}},7553:function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var a=s(0),l=s(966),i=s(19),n=s(7),o=s(5),r=s(983);const c=({errorMessage:e,inProgress:t,disableNext:s,cancelUrl:c})=>{const{t:d}=Object(n.useTranslation)();return a.createElement(o.g,{errorMessage:e,inProgress:t},a.createElement(l.a,null,a.createElement(i.a,{type:"submit",variant:"primary",isDisabled:s},d("lso-plugin~Create")),a.createElement(i.a,{type:"button",variant:"secondary",onClick:()=>r.b.push(c)},d("lso-plugin~Cancel"))))}},7554:function(e,t,s){"use strict";s.d(t,"a",(function(){return f}));var a=s(0),l=s(72),i=s(54),n=s(18),o=s(107),r=s(7),c=s(40),d=s(5),u=s(15),m=s(2303),p=s(6257);s(7555);const v=[n("pf-v5-u-w-40-on-sm"),n("pf-m-hidden","pf-m-visible-on-sm","pf-v5-u-w-10-on-sm"),n("pf-m-hidden","pf-m-visible-on-sm","pf-v5-u-w-10-on-sm"),n("pf-m-hidden","pf-m-visible-on-sm","pf-v5-u-w-10-on-sm"),n("pf-m-hidden","pf-m-visible-on-sm","pf-v5-u-w-10-on-sm")],f=e=>{const{t:t}=Object(r.useTranslation)(),[s,n]=a.useState(new Set),{hasOnSelect:f,onRowSelected:g}=e.customData,{onSelect:k,selectedRows:S,updateSelectedRows:b}=Object(m.a)(e.data,s,g);return a.createElement(a.Fragment,null,a.createElement("div",{className:"lso-node-selection-table__table--scroll"},a.createElement(c.j,Object.assign({},e,{"aria-label":t("lso-plugin~Select nodes for creating volume filter"),"data-test-id":"create-lvs-form-node-selection-table",Header:()=>[{title:t("lso-plugin~Name"),sortField:"metadata.name",transforms:[i.a],props:{className:v[0]}},{title:t("lso-plugin~Role"),props:{className:v[1]}},{title:t("lso-plugin~CPU"),props:{className:v[2]}},{title:t("lso-plugin~Memory"),props:{className:v[3]}},{title:t("lso-plugin~Zone"),props:{className:v[4]}}],Rows:e=>(({componentProps:e,customData:t},s,l,i,n)=>{const{data:r}=e,{filteredNodes:c,preSelectedNodes:m,taintsFilter:v}=t;let f=r;f=(null==c?void 0:c.length)?r.filter(e=>c.includes(Object(u.dd)(e))):f.filter(e=>Object(p.d)(e)||v&&v(e));const g=f.map(e=>{var t,s,l;const n=Object(u.hd)(e),o=Object(u.fd)(e),r=Object(u.md)(e).sort();return{cells:[{title:a.createElement(d.hb,{kind:"Node",name:Object(u.dd)(e),title:Object(u.dd)(e)})},{title:null!==(t=r.join(", "))&&void 0!==t?t:"-"},{title:""+(Object(d.Yb)(n).string||"-")},{title:null!==(s=Object(d.Wb)(Object(d.Ib)(o)).string)&&void 0!==s?s:"-"},{title:null!==(l=Object(p.c)(e))&&void 0!==l?l:"-"}],selected:i.has(e.metadata.uid),props:{id:e.metadata.uid}}}),k=new Set(f.map(e=>e.metadata.uid));if(!o.a(k,s)&&(l(k),(null==m?void 0:m.length)&&!(null==i?void 0:i.size)&&f.length)){n(f.filter(e=>m.includes(Object(u.dd)(e))))}return g})(e,s,n,S,b),customData:e.customData,onSelect:f&&k,virtualize:!1}))),f&&a.createElement(l.a,{"data-test-id":"create-lvs-form-selected-nodes",component:"h6"},t("lso-plugin~{{nodeCount, number}} node",{nodeCount:null==S?void 0:S.size,count:null==S?void 0:S.size})," ",t("lso-plugin~selected")))}},7555:function(e,t,s){},8382:function(e,t,s){}}]);
//# sourceMappingURL=lso-create-local-volume-set-chunk-7f6ab0544c2ff0010797.min.js.map