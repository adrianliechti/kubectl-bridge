(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{4395:function(e,t,a){"use strict";a.r(t),a.d(t,"totalCount",(function(){return I})),a.d(t,"affectedPodsCount",(function(){return F})),a.d(t,"highestSeverityIndex",(function(){return x})),a.d(t,"ImageManifestVulnDetails",(function(){return w})),a.d(t,"AffectedPods",(function(){return _})),a.d(t,"ImageManifestVulnDetailsPage",(function(){return P})),a.d(t,"ImageManifestVulnTableRow",(function(){return T})),a.d(t,"ImageManifestVulnTableHeader",(function(){return L})),a.d(t,"ImageManifestVulnList",(function(){return D})),a.d(t,"ImageManifestVulnPage",(function(){return A})),a.d(t,"ProjectImageManifestVulnListPage",(function(){return H})),a.d(t,"ContainerVulnerabilities",(function(){return z})),a.d(t,"ImageManifestVulnPodTab",(function(){return U}));var n=a(0),i=a(156),l=a(405),r=a(88),s=a(287),c=a(54),o=a(18),m=a(160),u=a(16),d=a(7),b=a(14),p=a(1447),v=a(872),f=a(40),y=a(1410),g=a(5),E=a(8),h=a(15),N=a(706),j=a(730),O=a(8797),S=a(8800),k=a(2080);a(8802);const C=e=>(null!=e?e:"").replace("@sha256","").split("/").slice(1,3).join("/"),V=e=>(null!=e?e:"").slice(7,18),I=e=>{if(!e.status)return 0;const{highCount:t=0,mediumCount:a=0,lowCount:n=0,unknownCount:i=0}=e.status;return t+a+n+i},F=e=>{var t,a;return Object.keys(null!==(a=null===(t=e.status)||void 0===t?void 0:t.affectedPods)&&void 0!==a?a:{}).length},x=e=>{var t;return Object(N.c)(null===(t=e.status)||void 0===t?void 0:t.highestSeverity).index},w=e=>{const{t:t}=Object(d.useTranslation)(),a=Object(k.quayURLFor)(e.obj);return n.createElement(n.Fragment,null,n.createElement("div",{className:"co-m-pane__body"},n.createElement(g.ob,{text:t("container-security~Image Manifest Vulnerabilities details")}),n.createElement(S.a,{obj:e.obj})),n.createElement("div",{className:"co-m-pane__body"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col-sm-6"},n.createElement(g.lb,{resource:e.obj})),n.createElement("div",{className:"col-sm-6"},n.createElement("dl",{className:"co-m-pane__details"},n.createElement(g.r,{label:t("container-security~Registry"),obj:e.obj,path:"spec.image"}),a&&n.createElement(g.r,{label:t("container-security~Manifest"),obj:e.obj,path:"obj.spec.manifest"},n.createElement(g.z,{text:V(e.obj.spec.manifest),href:a})))))),n.createElement("div",{className:"cs-imagevulnerabilitieslist__wrapper"},n.createElement(O.a,Object.assign({},e))))},_=e=>n.createElement(f.c,{kind:"Pod",namespace:e.obj.metadata.namespace,canCreate:!1,showTitle:!1,ListComponent:t=>{return n.createElement(v.b,Object.assign({},t,{data:(a=t.data,a.filter(t=>{var a,n;return m.a(null!==(n=null===(a=e.obj.status)||void 0===a?void 0:a.affectedPods)&&void 0!==n?n:{}).includes([t.metadata.namespace,t.metadata.name].join("/"))}))}));var a}}),P=()=>{const e=Object(b.useParams)();return n.createElement(f.a,{kindObj:j.a,titleFunc:e=>{var t,a;const n=C(null===(t=null==e?void 0:e.spec)||void 0===t?void 0:t.image),i=(null===(a=null==e?void 0:e.spec)||void 0===a?void 0:a.manifest)?"@"+V(e.spec.manifest):"";return n?`${n}${i}`:null},name:e.name,namespace:e.ns,kind:Object(E.Hb)(j.a),menuActions:[],pages:[g.mc.details(w),g.mc.editYaml(),{href:"pods",nameKey:"container-security~Affected Pods",component:_}]})},M=["",o("pf-m-hidden","pf-m-visible-on-md","co-break-word"),"",o("pf-m-hidden","pf-m-visible-on-md"),o("pf-m-hidden","pf-m-visible-on-lg"),o("pf-m-hidden","pf-m-visible-on-xl"),o("pf-m-hidden","pf-m-visible-on-xl")],T=({obj:e})=>{var t,a;const{name:i,namespace:l}=e.metadata,r=Object(k.quayURLFor)(e);return n.createElement(n.Fragment,null,n.createElement(f.k,{className:M[0]},n.createElement(g.hb,{kind:Object(E.Hb)(j.a),name:i,namespace:l,displayName:C(e.spec.image)})),n.createElement(f.k,{className:M[1],columnID:"namespace"},n.createElement(g.hb,{kind:"Namespace",name:l})),n.createElement(f.k,{className:M[2]},(null===(t=e.status)||void 0===t?void 0:t.highestSeverity)?n.createElement(n.Fragment,null,n.createElement(s.a,{color:Object(N.c)(e.status.highestSeverity).color.value})," ",e.status.highestSeverity):p.a),n.createElement(f.k,{className:M[3]},F(e)),n.createElement(f.k,{className:M[4]},(null===(a=e.status)||void 0===a?void 0:a.fixableCount)||0),n.createElement(f.k,{className:M[5]},I(e)),n.createElement(f.k,{className:M[6]},r?n.createElement(g.z,{text:V(e.spec.manifest),href:r}):n.createElement("span",{className:"small text-muted"},"-")))},L=e=>()=>[{title:e("container-security~Image name"),sortField:"spec.image",transforms:[c.a],props:{className:M[0]}},{title:e("container-security~Namespace"),sortField:"metadata.namespace",transforms:[c.a],props:{className:M[1]},id:"namespace"},{title:e("container-security~Highest severity"),sortFunc:"highestSeverityOrder",transforms:[c.a],props:{className:M[2]}},{title:e("container-security~Affected Pods"),props:{className:M[3]},transforms:[c.a],sortFunc:"affectedPodsOrder"},{title:e("container-security~Fixable"),sortField:"status.fixableCount",transforms:[c.a],props:{className:M[4]}},{title:e("container-security~Total"),sortFunc:"totalOrder",transforms:[c.a],props:{className:M[5]}},{title:e("container-security~Manifest"),props:{className:M[6]},transforms:[c.a],sortField:"spec.manifest"}],D=e=>{const{t:t}=Object(d.useTranslation)();return n.createElement(f.j,Object.assign({},e,{customSorts:{totalOrder:I,affectedPodsOrder:F,highestSeverityOrder:x},"aria-label":t("container-security~Image Manifest Vulnerabilities"),Header:L(t),Row:T,EmptyMsg:()=>n.createElement(i.a,{variant:i.b.lg},n.createElement(l.a,{titleText:n.createElement(n.Fragment,null,n.createElement(h.L,{model:j.a}),t("container-security~No Image vulnerabilities found")),headingLevel:"h4"})),virtualize:!0}))},A=e=>{const{t:t}=Object(d.useTranslation)(),a=Object(b.useParams)(),{showTitle:i=!0,hideNameLabelFilters:l=!0}=e,r=e.namespace||(null==a?void 0:a.ns)||(null==a?void 0:a.name);return n.createElement(f.i,Object.assign({},e,{namespace:r,resources:[{kind:Object(E.Hb)(j.a),namespace:r,namespaced:!0,prop:"imageManifestVuln"}],flatten:e=>u.a(e.imageManifestVuln,"data",[]),title:t("container-security~Image Manifest Vulnerabilities"),textFilter:"image-name",canCreate:!1,showTitle:i,nameFilterPlaceholder:t("container-security~Search by image name..."),hideNameLabelFilters:l,ListComponent:D}))},H=e=>n.createElement(A,Object.assign({},e,{showTitle:!1,hideNameLabelFilters:!1})),R=e=>[e.metadata.namespace,e.metadata.name].join("/"),z=e=>{const{t:t}=Object(d.useTranslation)();return n.createElement("div",{className:"co-m-pane__body"},n.createElement("div",{className:"co-m-table-grid co-m-table-grid--bordered"},n.createElement("div",{className:"row co-m-table-grid__head"},n.createElement("div",{className:"col-md-3"},t("container-security~Container")),n.createElement("div",{className:"col-md-4"},t("container-security~Image")),n.createElement("div",{className:"col-md-2"},n.createElement(r.a,{content:"Results provided by Quay security scanner"},n.createElement("span",null,t("container-security~Security scan"))))),n.createElement("div",{className:"co-m-table-grid__body"},e.pod.status.containerStatuses.map(a=>{return n.createElement("div",{className:"row",key:a.containerID},n.createElement("div",{className:"col-md-3"},n.createElement(y.ContainerLink,{pod:e.pod,name:a.name})),n.createElement("div",{className:"col-md-4 co-truncate co-nowrap co-select-to-copy"},e.pod.spec.containers.find(e=>e.name===a.name).image),n.createElement("div",{className:"col-md-3"},e.loaded?((e,t,a)=>void 0!==e?t(e):a())((i=a,u.a(e.imageManifestVuln,"data",[]).find(t=>t.status.affectedPods[R(e.pod)].some(e=>i.containerID===e)||i.imageID.includes(t.spec.manifest))),t=>n.createElement("span",{style:{display:"flex",alignItems:"center"}},n.createElement(s.a,{color:Object(N.c)(u.a(t.status,"highestSeverity")).color.value})," ",n.createElement(g.hb,{kind:Object(E.Hb)(j.a),name:t.metadata.name,namespace:e.pod.metadata.namespace,displayName:`${Object(N.d)(N.f.findKey(({title:e})=>u.a(t.status,"highestSeverity")===e))(t)} ${t.status.highestSeverity}`,hideIcon:!0})),()=>n.createElement("span",null,n.createElement(h.X,null)," ",t("container-security~No vulnerabilities found"))):n.createElement("div",null,n.createElement(g.R,null))));var i}))))},U=e=>{const t=Object(b.useParams)();return n.createElement(g.C,{resources:[{isList:!0,kind:Object(E.Hb)(j.a),namespace:t.ns,selector:{matchLabels:{[R(e.obj)]:"true"}},prop:"imageManifestVuln"}]},n.createElement(z,Object.assign({pod:e.obj},e)))};A.displayName="ImageManifestVulnPage",D.displayName="ImageManifestVulnList",_.displayName="AffectedPods",U.displayName="ImageManifestVulnPodTab",z.displayName="ContainerVulnerabilities"},6783:function(e,t,a){"use strict";var n;a.d(t,"a",(function(){return n})),a.d(t,"d",(function(){return l})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return s})),function(e){e.allVulnerabilities="All vulnerabilities",e.appDependency="App dependency",e.baseImage="Base image"}(n||(n={}));const i=e=>{const t=(e=>{if(null==e?void 0:e.metadata)try{return JSON.parse(e.metadata)}catch(t){return e.metadata}})(e);return"CodeReadyAnalytics"===(null==t?void 0:t.UpdatedBy)},l=e=>i(e)?n.appDependency:n.baseImage,r=e=>i(e)?"Snyk":"Red Hat",s=e=>null==e?void 0:e.filter(e=>null!==e.fixedby||""!==e.fixedby).length},8797:function(e,t,a){"use strict";var n=a(0),i=a(22),l=a(461),r=a(367),s=a(7),c=a(14),o=a(40),m=a(8),u=a(706),d=a(730),b=a(6783),p=a(8798);t.a=e=>{const{t:t}=Object(s.useTranslation)(),{obj:{metadata:{name:a}}}=e,{ns:v}=Object(c.useParams)(),f=[{filterGroupName:t("container-security~Type"),items:[{id:b.a.appDependency,title:b.a.appDependency},{id:b.a.baseImage,title:b.a.baseImage}],type:"vulnerability-type",reducer:e=>Object(b.d)(e.vulnerability),filter:(e,t)=>{var a;return(null===(a=e.selected)||void 0===a?void 0:a.includes(Object(b.d)(t.vulnerability)))||i.a(e.selected)}},{filterGroupName:t("container-security~Severity"),items:[{id:u.b.Defcon1,title:u.b.Defcon1},{id:u.b.Critical,title:u.b.Critical},{id:u.b.High,title:u.b.High},{id:u.b.Medium,title:u.b.Medium},{id:u.b.Low,title:u.b.Low},{id:u.b.Negligible,title:u.b.Negligible},{id:u.b.Unknown,title:u.b.Unknown}],type:"vulnerability-severity",reducer:e=>e.vulnerability.severity,filter:(e,t)=>{var a;return(null===(a=e.selected)||void 0===a?void 0:a.includes(t.vulnerability.severity))||i.a(e.selected)}}];return n.createElement(o.i,Object.assign({},e,{resources:[{kind:Object(m.Hb)(d.a),namespaced:!0,namespace:v,name:a,isList:!1,prop:"imageVulnerabilities",optional:!0}],title:t("container-security~Vulnerabilities"),flatten:e=>{var t,a,n,i;return l.a(r.a((null!==(i=null===(n=null===(a=null===(t=null==e?void 0:e.imageVulnerabilities)||void 0===t?void 0:t.data)||void 0===a?void 0:a.spec)||void 0===n?void 0:n.features)&&void 0!==i?i:[]).map(e=>{var t;return(null!==(t=null==e?void 0:e.vulnerabilities)&&void 0!==t?t:[]).map(t=>({feature:e,vulnerability:t}))})),e=>{var t;return Object(u.c)(null===(t=null==e?void 0:e.vulnerability)||void 0===t?void 0:t.severity).index})},namespace:v,canCreate:!1,showTitle:!0,textFilter:"vulnerability",rowFilters:f,hideLabelFilter:!0,ListComponent:p.a}))}},8798:function(e,t,a){"use strict";var n=a(0),i=a(54),l=a(7),r=a(40),s=a(5),c=a(6783),o=a(8799);const m=e=>({id:e.name});t.a=e=>{const{t:t}=Object(l.useTranslation)();return n.createElement(r.j,Object.assign({},e,{customSorts:{vulnerabilityType:e=>Object(c.d)(e.vulnerability),vulnerabilitySource:e=>Object(c.c)(e.vulnerability)},"aria-label":t("container-security~Vulnerabilities"),Header:()=>[{title:t("container-security~Name"),transforms:[i.a],sortField:"vulnerability.name",props:{className:o.b[0]}},{title:t("container-security~Severity"),transforms:[i.a],sortField:"vulnerability.severity",props:{className:o.b[1]}},{title:t("container-security~Package"),transforms:[i.a],sortField:"feature.name",props:{className:o.b[2]}},{title:t("container-security~Type"),transforms:[i.a],sortFunc:"vulnerabilityType",props:{className:o.b[3]}},{title:t("container-security~Source"),transforms:[i.a],sortFunc:"vulnerabilitySource",props:{className:o.b[4]}},{title:t("container-security~Current version"),transforms:[i.a],sortField:"feature.version",props:{className:o.b[3]}},{title:t("container-security~Fixed in version"),transforms:[i.a],sortField:"vulnerability.fixedby",props:{className:o.b[4]}}],Row:o.a,EmptyMsg:()=>n.createElement(s.h,{title:t("container-security~No Image vulnerabilities found")}),virtualize:!0,getRowProps:m}))}},8799:function(e,t,a){"use strict";a.d(t,"b",(function(){return m}));var n=a(0),i=a(287),l=a(18),r=a(40),s=a(5),c=a(706),o=a(6783);const m=["","",l("pf-m-hidden","pf-m-visible-on-md"),l("pf-m-hidden","pf-m-visible-on-md"),l("pf-m-hidden","pf-m-visible-on-lg"),l("pf-m-hidden","pf-m-visible-on-xl"),l("pf-m-hidden","pf-m-visible-on-xl")];t.a=e=>{const{obj:{vulnerability:t,feature:a}}=e;return n.createElement(n.Fragment,null,n.createElement(r.k,{className:m[0]},n.createElement(s.z,{text:t.name,href:t.link})),n.createElement(r.k,{className:m[1]},n.createElement(i.a,{color:Object(c.c)(t.severity).color.value})," ",t.severity),n.createElement(r.k,{className:m[2]},a.name),n.createElement(r.k,{className:m[3]},Object(o.d)(t)),n.createElement(r.k,{className:m[4]},Object(o.c)(t)),n.createElement(r.k,{className:m[5]},a.version),n.createElement(r.k,{className:m[6]},t.fixedby||"-"))}},8800:function(e,t,a){"use strict";var n=a(0),i=a(2232),l=a(270),r=a(5376),s=a(3826),c=a(287),o=a(367),m=a(116),u=a(7),d=a(5),b=a(706),p=a(6783);a(8801);t.a=({obj:e})=>{var t;const{t:a}=Object(u.useTranslation)(),v=null===(t=null==e?void 0:e.spec)||void 0===t?void 0:t.features,[f,y]=n.useMemo(()=>{const e=o.a(null==v?void 0:v.map(e=>e.vulnerabilities));return[e,e.length]},[v]),[g,E]=n.useState(p.a.allVulnerabilities),[h,N]=n.useState(y),[j,O]=n.useState(f),S=n.useCallback(e=>{const{id:t}=e.currentTarget;if(E(t),t===p.a.allVulnerabilities)N(y),O(f);else{const e=m.a(f,e=>Object(p.d)(e)===t);N(e.length),O(e)}},[f,y]);return n.createElement(n.Fragment,null,n.createElement(r.a,{"aria-label":a("container-security~Vulnerability type")},n.createElement(s.a,{buttonId:p.a.allVulnerabilities,isSelected:g===p.a.allVulnerabilities,onChange:S,text:a("container-security~All vulnerabilities")}),n.createElement(s.a,{buttonId:p.a.appDependency,isSelected:g===p.a.appDependency,onChange:S,text:a("container-security~App dependency")}),n.createElement(s.a,{buttonId:p.a.baseImage,isSelected:g===p.a.baseImage,onChange:S,text:a("container-security~Base image")})),h>0?n.createElement("div",{className:"cs-imagevulnerability-details"},n.createElement("div",{className:"cs-imagevulnerability-details__donut"},n.createElement(i.a,{colorScale:b.f.map(e=>e.color.value).toArray(),data:b.f.map((e,t)=>({label:e.title,x:e.value,y:Object(b.e)(t)(j)})).toArray(),title:a("container-security~{{totalSelectedVulnCount, number}} total",{totalSelectedVulnCount:h}),titleComponent:n.createElement(l.a,{style:{fill:"var(--pf-v5-global--Color--100)",fontSize:24}})})),n.createElement("div",{className:"cs-imagevulnerability-details__summary"},n.createElement("h3",null,a("container-security~Quay Security Scanner has detected {{totalSelectedVulnCount, number}} vulnerabilities.",{totalSelectedVulnCount:h})),n.createElement("h4",{className:"cs-imagevulnerability-details__details__summary--h4"},a("container-security~Patches are available for {{fixableVulnCount, number}} vulnerabilities.",{fixableVulnCount:Object(p.b)(j)})),n.createElement("div",{className:"cs-imagevulnerability-details__summary-list"},b.f.map((e,t)=>Object(b.e)(t)(j)>0?n.createElement("span",{className:"cs-imagevulnerability-details__summary-list--title",key:e.index},n.createElement(c.a,{color:e.color.value})," ",n.createElement("strong",null,Object(b.e)(t)(j))," ",a("container-security~{{title}} vulnerabilities.",{title:e.title})):null).toArray()))):n.createElement("div",{className:"cs-imagevulnerability-details__empty-text"},n.createElement(d.h,{title:a("container-security~No {{isSelected}} vulnerabilities",{isSelected:g.toLowerCase()})})))}},8801:function(e,t,a){},8802:function(e,t,a){}}]);
//# sourceMappingURL=container-security-chunk-96c48f684aa0b40e1c17.min.js.map