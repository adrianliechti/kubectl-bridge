(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{11839:function(e,a,t){"use strict";var n=t(0),l=t(640),i=t(55),r=t(14),o=t(77),u=t(614),s=t(1941),c=t(10),m=t(11840),d=t(7560);a.a=({name:e,namespace:a,title:t,configMap:b,isCreateFlow:p})=>{const v=Object(r.useNavigate)(),[f]=n.useState(Object(d.a)(a,b,p)),y=()=>v(-1);return n.createElement(i.b,{enableReinitialize:!0,initialValues:f,onSubmit:(t,n)=>{var i;let r;const m=Object(s.c)(t.yamlData);(null==m?void 0:m.metadata)&&!(null===(i=null==m?void 0:m.metadata)||void 0===i?void 0:i.namespace)&&(m.metadata.namespace=a);const f=t.editorType===u.b.Form?Object(d.b)(t,m):m;if(p)r=Object(o.g)({model:c.ConfigMapModel,data:f});else{const t=l.a(b);t.metadata=null==f?void 0:f.metadata,t.data=f.data,t.binaryData=f.binaryData,t.immutable=f.immutable,r=Object(o.r)({model:c.ConfigMapModel,data:t,ns:a,name:e})}r.then(()=>{v(`/k8s/ns/${a}/configmaps/${f.metadata.name}`)}).catch(e=>{n.setStatus({submitError:e.message})})},validationSchema:Object(d.g)()},e=>n.createElement(m.a,Object.assign({title:t,configMap:b,handleCancel:y},e)))}},11840:function(e,a,t){"use strict";t.d(a,"a",(function(){return v}));var n=t(0),l=t(22),i=t(1557),r=t(55),o=t(7),u=t(15),s=t(5962),c=t(10),m=t(1941),d=t(614),b=t(11841),p=t(7560);const v=({values:e,status:a,handleSubmit:t,configMap:v,title:f,isSubmitting:y,dirty:g,handleCancel:h,setStatus:j,setErrors:O,errors:k})=>{var D,E;const{t:C}=Object(o.useTranslation)(),{setFieldValue:w}=Object(r.f)(),T=!!v&&(null===(D=null==v?void 0:v.metadata)||void 0===D?void 0:D.resourceVersion)!==e.resourceVersion,M=!!v&&v.immutable,S=C("public~Cannot update the object when immutable field is set to true"),x=M||(e.editorType===d.b.YAML?!g:!g||!l.a(k))||y,F=n.createElement("div",{className:"co-m-pane__form"},n.createElement(b.a,null)),$=n.createElement(u.C,{name:"yamlData",model:c.ConfigMapModel,showSamples:!(null===(E=null==v?void 0:v.metadata)||void 0===E?void 0:E.name),onSave:()=>t()}),q=n.useCallback(()=>{var a;j({submitSuccess:"",submitError:""}),O({}),e.editorType===d.b.Form&&w("formData",Object(p.c)(v,e.formData.namespace),!1),w("yamlData",Object(m.b)(v,"",{skipInvalid:!0}),!1),w("resourceVersion",null===(a=null==v?void 0:v.metadata)||void 0===a?void 0:a.resourceVersion,!0),w("formReloadCount",e.formReloadCount+1)},[O,w,j,e,v]);return n.useEffect(()=>{j({submitError:null})},[j,e.editorType]),n.createElement(u.P,{onSubmit:t,className:"configmap-form"},n.createElement(u.Q,{flexLayout:!0},n.createElement(u.S,{title:f,helpText:C("public~Config maps hold key-value pairs that can be used in pods to read application configuration.")}),n.createElement(u.fc,{name:"editorType",formContext:{name:"formData",editor:F,sanitizeTo:a=>Object(p.e)(e.formData,a)},yamlContext:{name:"yamlData",editor:$,sanitizeTo:()=>Object(p.f)(e.formData,i.a({},v,Object(m.c)(e.yamlData)))},lastViewUserSettingKey:"console.configMapForm.editor.lastView",noMargin:!0})),n.createElement(u.R,{handleSubmit:t,handleReset:e.isCreateFlow?null:q,errorMessage:(null==a?void 0:a.submitError)||M&&S,successMessage:null==a?void 0:a.submitSuccess,showAlert:T,infoTitle:C("public~This object has been updated."),infoMessage:C("public~Click reload to see the new version."),isSubmitting:y,submitLabel:e.isCreateFlow?C("public~Create"):C("public~Save"),disableSubmit:x,handleCancel:h,handleDownload:e.editorType===d.b.YAML&&(()=>Object(s.a)(e.yamlData)),sticky:!0}))}},11841:function(e,a,t){"use strict";var n=t(0),l=t(55),i=t(7),r=t(1940),o=t(281),u=t(2305),s=t(11842),c=t(7560);a.a=()=>{const{t:e}=Object(i.useTranslation)(),{values:a,setFieldValue:t}=Object(l.f)();return n.createElement(r.a,null,n.createElement(u.h,{type:o.b.text,required:!0,isDisabled:!a.isCreateFlow,name:"formData.name",label:e("public~Name"),"data-test":"configmap-name",helpText:e("public~A unique name for the ConfigMap within the project")}),n.createElement(u.a,{name:"formData.immutable",label:e("public~Immutable"),"data-test":"configmap-immutable",helpText:e("public~Immutable, if set to true, ensures that data stored in the ConfigMap cannot be updated")}),n.createElement(s.a,{label:e("public~Data"),helpText:e("public~Data contains the configuration data that is in UTF-8 range"),name:"formData.data","data-test":"configmap-key-value-pair",entries:[{key:"",value:""}],onChange:(e,a)=>{t(a+".isBase64",Object(c.d)(e))}}),n.createElement(s.a,{label:e("public~Binary Data"),helpText:e("public~BinaryData contains the binary data that is not in UTF-8 range"),name:"formData.binaryData","data-test":"configmap-key-value-pair",entries:[{key:"",value:""}]}))}},11842:function(e,a,t){"use strict";var n=t(0),l=t(219),i=t(241),r=t(130),o=t(19),u=t(281),s=t(297),c=t(319),m=t(157),d=t(408),b=t(407),p=t(55),v=t(16),f=t(840),y=t(7),g=t(15),h=t(114);t(11843);a.a=({name:e,label:a="",helpText:t="",disableRemoveAction:j=!1,entries:O=[{key:"",value:""}],onChange:k})=>{var D;const[E]=Object(p.e)(e),{t:C}=Object(y.useTranslation)(),{values:w}=Object(p.f)(),T=null!==(D=E.value)&&void 0!==D?D:O,M=Object(h.a)(e,"key-value--input"),S=Object(v.a)(w,e,T),[x,F]=n.useState(Object(f.a)());return Object(g.Ge)(E.value),n.createElement(p.a,{key:`${e}-${w.formReloadCount}`,name:e,render:p=>n.createElement(l.a,{fieldId:M,label:a},null==S?void 0:S.map((a,t)=>n.createElement(i.a,{className:"key-value--wrapper","data-test":"key-value-pair",key:`${t.toString()}-${x}`,direction:{default:"column"}},!j&&n.createElement(r.a,{className:"key-value--remove-button"},n.createElement(o.a,{type:"button","data-test":"remove-key-value-button",onClick:()=>{F(Object(f.a)()),p.remove(t)},variant:"link"},n.createElement(d.a,{className:"co-icon-space-r"}),C("console-shared~Remove key/value"))),n.createElement(r.a,null,n.createElement(g.ab,{"data-test":"key-"+t.toString(),type:u.b.text,name:`${e}.${t.toString()}.key`,label:C("console-shared~Key"),required:!0})),n.createElement(r.a,null,n.createElement(g.J,{"data-test":"value-"+t.toString(),name:`${e}.${t.toString()}.value`,label:C("console-shared~Value"),helpText:C("console-shared~Drag and drop file with your value here or browse to upload it."),onChange:a=>{k&&k(a,`${e}.${t.toString()}`)}})))),n.createElement(o.a,{className:"pf-m-link--align-left",onClick:()=>p.push({key:"",value:""}),type:"button","data-test":"add-key-value-button",variant:"link"},n.createElement(b.a,{className:"co-icon-space-r"}),C("console-shared~Add key/value")),n.createElement(s.a,null,n.createElement(c.a,null,n.createElement(m.a,null,t))))})}},11843:function(e,a,t){},4491:function(e,a,t){"use strict";t.r(a);var n=t(0),l=t(137),i=t(7),r=t(14),o=t(10),u=t(108),s=t(139),c=t(11839);a.default=()=>{const{t:e}=Object(i.useTranslation)(),{ns:a,name:t}=Object(r.useParams)(),m=!t,[d,b,p]=Object(u.a)(m?null:{kind:o.ConfigMapModel.kind,name:t,namespace:a}),v=e(m?"public~Create ConfigMap":"public~Edit ConfigMap"),f=m?null:d,y=n.createElement(c.a,{name:t,namespace:a,configMap:f,title:v,isCreateFlow:m});return n.createElement(n.Fragment,null,n.createElement(l.a,null,n.createElement("title",null,v)),m?y:n.createElement(s.h,{loaded:b,loadError:p,label:v,data:f},y))}},5962:function(e,a,t){"use strict";t.d(a,"a",(function(){return i}));var n=t(1416),l=t(380);const i=e=>{const a=new Blob([e],{type:"text/yaml;charset=utf-8"});let t="k8s-object.yaml";try{const a=Object(l.safeLoad)(e);a.kind&&(t=`${a.kind.toLowerCase()}-${a.metadata.name}.yaml`)}catch(e){console.error("Could not parse YAML file:",e)}Object(n.saveAs)(a,t)}},7560:function(e,a,t){"use strict";t.d(a,"d",(function(){return p})),t.d(a,"c",(function(){return f})),t.d(a,"b",(function(){return y})),t.d(a,"f",(function(){return g})),t.d(a,"e",(function(){return h})),t.d(a,"a",(function(){return j})),t.d(a,"g",(function(){return D}));var n=t(4420),l=t(113),i=t(447),r=t(1557),o=t(320),u=t(689),s=t(29),c=t(1941),m=t(614);const d={apiVersion:"v1",kind:"ConfigMap",metadata:{name:""},data:{},binaryData:{}},b={name:"",namespace:"",data:[{key:"",value:""}],binaryData:[],immutable:!1},p=e=>{if(""===e||""===(null==e?void 0:e.trim()))return!1;try{return btoa(atob(e))===e}catch(e){return!1}},v=(e,a)=>{if(!e)return[];const t=[];return e[a]&&n.a(e[a],(e,a)=>{t.push({key:a,value:e})}),t},f=(e,a)=>{var t,n,l;if(!e)return Object.assign(Object.assign({},b),{namespace:a});const i=null!==(n=null===(t=e.metadata)||void 0===t?void 0:t.name)&&void 0!==n?n:"",r=null!==(l=null==e?void 0:e.immutable)&&void 0!==l?l:void 0,o=v(e,"data"),u=v(e,"binaryData");return Object.assign(Object.assign({},b),{namespace:a,name:i,data:o,binaryData:u,immutable:r})},y=(e,a)=>{const{name:t,namespace:n,immutable:l,data:i,binaryData:u}=e.formData,s=i.reduce((e,{key:a,value:t})=>a?(e[a]=t,e):e,{}),c=u.reduce((e,{key:a,value:t})=>{if(!a)return e;const n=p(t);return e[a]=n?t:o.Base64.encode(t),e},{});return r.a({},d,Object.assign(Object.assign({},a),{metadata:Object.assign(Object.assign({},null==a?void 0:a.metadata),{name:t,namespace:n}),immutable:l,data:null!=s?s:{},binaryData:null!=c?c:{}}))},g=(e,a)=>{const t=y({formData:e},a);return Object(c.b)(t,"yamlData",{skipInvalid:!0})},h=(e,a)=>{const t=((e,a)=>{var t,n,r;if(!a)return Object.assign(Object.assign({},b),{namespace:null==e?void 0:e.namespace});let u,s;return u=l.a(a.data)?v(a,"data"):{},l.a(a.binaryData)?(s=v(a,"binaryData"),s=s.map(a=>{const t=e.binaryData.find(e=>e.key===a.key);return t&&t.value===a.value?a:Object.assign(Object.assign({},a),{value:p(a.value)?o.Base64.decode(a.value):a.value})})):s={},Object.assign(Object.assign({},e),{name:i.a(null===(t=null==a?void 0:a.metadata)||void 0===t?void 0:t.name)?null===(n=null==a?void 0:a.metadata)||void 0===n?void 0:n.name:"",immutable:null!==(r=null==a?void 0:a.immutable)&&void 0!==r?r:void 0,data:u,binaryData:s})})(e,a);return r.a({},b,t)},j=(e,a,t)=>{var n,l;const i=f(a,e),r=g(i,a);return{isCreateFlow:t,editorType:m.b.Form,yamlData:r,formData:Object.assign({},i),resourceVersion:null!==(l=null===(n=null==a?void 0:a.metadata)||void 0===n?void 0:n.resourceVersion)&&void 0!==l?l:null,formReloadCount:0}},O=e=>u.array().of(u.object({key:u.string().required(s.a.t("public~Required")).test("unique",s.a.t("public~Key must be unique"),(function(a){const{data:t,binaryData:n}=e.formData,l=[...t,...n].filter(e=>e).filter(e=>e.key===a);return(null==l?void 0:l.length)<=1})),value:u.string()})),k=e=>u.object({name:u.string().required(s.a.t("public~Required")),data:O(e),binaryData:O(e)}),D=()=>u.mixed().test({test:e=>u.object({editorType:u.string().oneOf(Object.values(m.b)).required(s.a.t("public~Required")),formData:u.mixed().when("editorType",{is:m.b.Form,then:k(e)}),yamlData:u.mixed().when("editorType",{is:m.b.YAML,then:u.string().required(s.a.t("public~Required"))})}).validate(e,{abortEarly:!1})})}}]);
//# sourceMappingURL=edit-configmap-page-chunk-3bf0d992fa82cf8b7998.min.js.map