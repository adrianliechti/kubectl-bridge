(window.webpackJsonp=window.webpackJsonp||[]).push([[108],{11535:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var l=a(0),n=a(472),r=a(7),o=a(8),s=a(10);const c=({machineConfigPools:e,onChange:t,selected:a})=>{const{t:c}=Object(r.useTranslation)();return l.createElement("div",{className:"form-group"},l.createElement("label",{id:"version-label"},c("public~Select {{resource}} to pause",{resource:s.NodeModel.labelPlural})),e.map(e=>l.createElement(n.a,{key:e.metadata.uid,label:`${Object(o.hb)(e)?o.g.Worker:e.metadata.name} ${s.NodeModel.labelPlural}`,id:e.metadata.name,isChecked:a.includes(e.metadata.name),onChange:t,"data-test":"pause-mcp-checkbox-"+e.metadata.name})))}},5479:function(e,t,a){"use strict";a.r(t),a.d(t,"clusterUpdateModal",(function(){return k}));var l,n=a(4438),r=a(117),o=a(0),s=a(7),c=a(80),i=a(563),u=a(72),d=a(1191),m=a(108),p=a(5),b=a(2353),g=a(10),h=a(8),v=a(118),f=a(5418),w=a(11535);!function(e){e.Full="Full",e.Partial="Partial"}(l||(l={}));const E=Object(p.Oc)(e=>{var t;const{cancel:a,close:E,cv:k,errorMessage:O,handlePromise:j,inProgress:C}=e,P=!!Object(h.B)(k),y=Object(h.W)(k),N=Object(h.X)(k),F=Object(h.E)(k),M=null==y?void 0:y.find(e=>!Object(h.ib)(F,e.version)),[S,L]=o.useState((P?null==M?void 0:M.version:null===(t=y[0])||void 0===t?void 0:t.version)||""),[U,I]=Object(m.a)({isList:!0,kind:Object(h.Hb)(g.MachineConfigPoolModel)}),[T,V]=o.useState(""),[W,D]=o.useState([]),[R,B]=o.useState(l.Full),[x,K]=o.useState(!1),{t:H}=Object(s.useTranslation)();o.useEffect(()=>{const e=U.filter(e=>!Object(h.fb)(e)&&Object(h.gb)(e)).map(e=>e.metadata.name);D(e)},[]);const J=e=>{B(e)},$=U.filter(e=>!Object(h.fb)(e)).sort(h.Lb),z=$.filter(e=>Object(h.gb)(e)),A=r.a(y,{version:S}),Q=r.a(N,{release:{version:S}}),X=Object(h.N)(null==Q?void 0:Q.conditions),Y=e=>{const t=P&&Object(h.ib)(F,e);return{isDisabled:t,key:e,title:t?o.createElement(o.Fragment,null,e," ",o.createElement(f.UpdateBlockedLabel,null)):e}},q=y.map(({version:e})=>Y(e)),G=N.map(({release:{version:e}})=>Y(e)),Z=[{items:q,key:"recommended",label:H("public~Recommended")}];x&&Z.unshift({items:G,key:"notRecommended",label:H("public~Have known issues")});const _=Object(p.Qb)(p.Lb.updateUsingCustomMachineConfigPools);return o.createElement("form",{onSubmit:e=>{if(e.preventDefault(),!A&&!Q)return void V(H("public~Version {{desiredVersion}} not found among the supported updates. Select another version.",{desiredVersion:S}));let t,a;if(V(""),R===l.Full)t=[],a=Object(h.K)(z,!1);else{const e=$.filter(e=>W.find(t=>t===e.metadata.name)),l=$.filter(t=>!e.includes(t));t=Object(h.K)(e,!0),a=Object(h.K)(l,!1)}const n=[{op:"add",path:"/spec/desiredUpdate",value:Q?Q.release:A}];return j(Promise.all([Object(h.pb)(g.ClusterVersionModel,k,n),...a,...t]),E)},name:"form",className:"modal-content","data-test":"update-cluster-modal"},o.createElement(v.d,null,H("public~Update cluster")),o.createElement(v.a,null,P&&o.createElement(f.ClusterNotUpgradeableAlert,{onCancel:a,cv:k}),o.createElement("div",{className:"form-group"},o.createElement("label",null,H("public~Current version")),o.createElement("p",null,F)),o.createElement("div",{className:"form-group"},o.createElement("label",{id:"version-label"},H("public~Select new version")),o.createElement(b.a,{isFullWidth:!0,onSelect:(e,t)=>{e.preventDefault(),L(t)},options:Z,selected:S,switchIsChecked:x,switchIsDisabled:0===G.length,switchLabel:o.createElement(o.Fragment,null,H("public~Include versions with known issues"),o.createElement(p.B,null,H("public~These versions are supported, but include known issues. Review the known issues before updating."))),switchLabelClassName:"co-switch-label",switchLabelIsReversed:!0,switchOnChange:e=>K(e),toggleLabel:S}),Q&&(null==X?void 0:X.message)&&o.createElement(c.a,{className:"pf-v5-u-mt-sm",isInline:!0,title:H("public~Updating this cluster to {{desiredVersion}} is supported, but includes known issues.  Review the known issues before updating.",{desiredVersion:Q.release.version}),variant:"info","data-test":"update-cluster-modal-not-recommended-alert"},o.createElement(i.a,null,o.createElement(u.a,{component:u.b.p},o.createElement(p.N,null,X.message.split("\n").map(e=>o.createElement(o.Fragment,{key:e},e,o.createElement("br",null)))))))),o.createElement("div",{className:"form-group"},o.createElement("label",null,H("public~Update options"),o.createElement(p.B,null,H("public~Full cluster update allows you to update all your Nodes, but takes longer. Control plane only update allows you to pause worker and custom pool Nodes to accommodate your maintenance schedule, but you'll need to resume the non-control plane Node updates within 60 days to avoid failure."))),o.createElement(d.a,{isChecked:R===l.Full,name:l.Full,onChange:()=>J(l.Full),label:H("public~Full cluster update"),id:l.Full,value:l.Full,description:H("public~{{master}}, {{worker}}, and custom pool {{resource}} are updated concurrently. This might take longer, so make sure to allocate enough time for maintenance.",{master:h.g.Master,worker:h.g.Worker,resource:g.NodeModel.labelPlural}),className:"pf-v5-u-mb-sm",body:I&&z.length>0&&R===l.Full&&o.createElement(c.a,{variant:"warning",isInline:!0,isPlain:!0,title:H('public~Paused {{worker}} or custom pool {{resource}} updates will be resumed. If you want to update only the control plane, select "Control plane only update" below.',{worker:h.g.Worker,resource:g.NodeModel.label}),"data-test":"update-cluster-modal-paused-nodes-warning"}),"data-test":"update-cluster-modal-full-update-radio"}),o.createElement(d.a,{isChecked:R===l.Partial,name:l.Partial,onChange:()=>J(l.Partial),label:H("public~Control plane only update"),id:l.Partial,value:l.Partial,description:H("public~Pause {{worker}} or custom pool {{resource}} updates to accommodate your maintenance schedule.",{worker:h.g.Worker,resource:g.NodeModel.label}),className:"pf-v5-u-mb-md",body:R===l.Partial&&o.createElement(o.Fragment,null,o.createElement(w.a,{machineConfigPools:$,selected:W,onChange:(e,t)=>{const a=[...W];t?a.push(e.currentTarget.id):n.a(a,e.currentTarget.id),D(a)}}),o.createElement(c.a,{variant:"warning",isInline:!0,isPlain:!0,title:H("public~You must resume updates within 60 days to avoid failures."),className:"pf-v5-u-mb-md"},!Object(p.hc)()&&o.createElement(p.z,{href:_},H("public~Learn more")))),"data-test":"update-cluster-modal-partial-update-radio"}))),o.createElement(v.c,{errorMessage:O||T,inProgress:C,submitText:H("public~Update"),cancelText:H("public~Cancel"),cancel:a,submitDisabled:!S||R===l.Partial&&0===W.length}))}),k=Object(v.f)(E)}}]);
//# sourceMappingURL=cluster-update-modal-chunk-9c3afb3ccf370c09b6ac.min.js.map