(window.webpackJsonp=window.webpackJsonp||[]).push([[161],{11903:function(e,t,n){"use strict";n.r(t);var a=n(0),l=n(87),r=n(241),o=n(130),i=n(22),c=n(7),s=n(5591),d=n(6406),u=n(2255),m=n(5911),v=n(6106),f=n(6011),p=n(8410),g=n(6107),E=n(5599),y=n(11908),h=n(6214),b=n(6791),S=n(7315);t.default=({values:e,errors:t,handleSubmit:n,handleReset:k,builderImages:j,status:O,isSubmitting:C,dirty:F,projects:I})=>{var w,D,N,R;const{t:P}=Object(c.useTranslation)(),T=new URLSearchParams(window.location.search),_=T.get("git.repository"),L=T.get("git.revision"),x=T.get("git.contextDir"),U=T.get("formType"),V=T.get("importType"),{git:{validated:M,type:B},build:{option:G}}=e,K=V===E.e.devfile||M!==l.d.default&&B!==s.b.INVALID,H=Object(m.g)(),z=V!==E.e.devfile&&e.import.selectedStrategy.type!==s.c.DEVFILE&&!H,A=(V===E.e.devfile||e.import.selectedStrategy.type===s.c.DEVFILE)&&(null===(R=null===(N=null===(D=null===(w=null==e?void 0:e.devfile)||void 0===w?void 0:w.devfileSuggestedResources)||void 0===D?void 0:D.route)||void 0===N?void 0:N.spec)||void 0===R?void 0:R.tls);return a.createElement("form",{onSubmit:n,"data-test-id":"import-git-form"},a.createElement(r.a,{direction:{default:"column",sm:"row"}},a.createElement(o.a,{flex:{default:"flex_1"},alignSelf:{default:"alignSelfFlexStart"}},a.createElement(u.c,null,a.createElement(g.a,{builderImages:j,defaultSample:_&&{url:_,ref:L,dir:x},formType:U,importType:V}),K&&a.createElement(a.Fragment,null,V===E.e.devfile?a.createElement(p.a,null):a.createElement(y.a,{builderImages:j}),a.createElement(f.a,{project:e.project,noProjectsAvailable:I.loaded&&i.a(I.data)}),"sample"!==U&&V!==E.e.devfile&&a.createElement(b.a,{values:e}),z&&a.createElement(a.Fragment,null,G===E.a.PIPELINES&&a.createElement(d.a,{builderImages:j}),G!==E.a.DISABLED&&a.createElement(S.a,{values:e}),a.createElement(v.a,{values:e})),A&&a.createElement("div",{className:"pf-v5-c-form co-m-pane__form"},a.createElement(h.a,null)))))),a.createElement(u.d,{handleReset:k,errorMessage:O&&O.submitError,isSubmitting:C,submitLabel:P("devconsole~Create"),sticky:!0,disableSubmit:!F||!i.a(t)||C,resetLabel:P("devconsole~Cancel")}))}},11904:function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return f}));var a=n(0),l=n(55),r=n(7),o=n(109),i=n(15),c=n(761),s=n(5649),d=n(11905),u=function(e,t,n,a){return new(n||(n=Promise))((function(l,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function i(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))};const m=(e,t)=>{const{t:n}=Object(r.useTranslation)(),[l,c]=a.useState(null),[s,m]=a.useState(!1),{name:v,git:{url:f,ref:p,dir:g,type:E,secretResource:y},devfile:h}=e,b=Object(d.b)(Object(d.c)(g)),{devfileContent:S,devfilePath:k}=h||{},j=a.useMemo(()=>u(void 0,void 0,void 0,(function*(){if(!v||!f||!S)return null;const e=yield Object(d.a)(S,f,p,g,E,y);return{name:v,git:{URL:f,ref:p,dir:Object(d.b)(g)},devfile:{devfileContent:e,devfilePath:`${b}${k}`}}})),[v,f,S,p,g,E,y,b,k]);return a.useEffect(()=>{const e=e=>{c(e),t("devfile.devfileHasError",!0)},a=()=>{c(null),t("devfile.devfileHasError",!1)};u(void 0,void 0,void 0,(function*(){let l;try{l=yield j}catch(t){return console.warn("Could not fetch devfile resource:",t),void e(t.message||n("devconsole~Could not fetch devfile resources."))}null!==l?(m(!0),t("devfile.devfileSuggestedResources",null),o.c.post("/api/devfile/",l).then(l=>{var r,o,c,s;if(m(!1),l){a();const{imageStream:e,buildResource:n,deployResource:d,service:u,route:m}=l;if((null===(s=null===(c=null===(o=null===(r=d.spec)||void 0===r?void 0:r.template)||void 0===o?void 0:o.spec)||void 0===c?void 0:c.containers)||void 0===s?void 0:s.length)>0){const e=d.spec.template.spec.containers[0];t("image.ports",e.ports||[],!1),t("deployment.env",e.env||[],!1),t("limits",Object(i.Rc)(d),!1),delete d.spec.template.spec.containers}t("devfile.devfileSuggestedResources",{imageStream:e,buildResource:n,deployResource:d,service:u,route:m})}else e(n("devconsole~The Devfile in your Git repository is invalid."))}).catch(t=>{m(!1),e(t.message||n("devconsole~The Devfile in your Git repository is invalid."))})):a()}))},[j,t,n]),[s,l]},v=()=>{const e=new URLSearchParams(window.location.search),t=e.get("git.repository"),n=e.get("devfileName"),r=e.get("formType"),{values:o,setFieldValue:i,setFieldTouched:d}=Object(l.f)(),{import:{recommendedStrategy:u},devfile:m}=o;a.useEffect(()=>{var e;t&&!m.devfileContent&&(i("devfile.devfileSourceUrl",t),i("devfile.devfilePath",null===(e=null==u?void 0:u.detectedFiles)||void 0===e?void 0:e[0]),i("docker.dockerfilePath","Dockerfile"),"sample"===r&&(i("name",Object(s.a)(n)),i("application.initial",c.t),i("application.name",c.t),i("application.selectedKey",c.t)))},[t,n,r,i,d,u,m.devfileContents,m.devfileContent])},f=()=>{const e=new URLSearchParams(window.location.search).get("devfileName"),[t,n]=a.useState();return a.useEffect(()=>{let e=!0;return Object(o.c)("/api/devfile/samples/?registry=https://registry.devfile.io").then(t=>{e&&n(t)}).catch(()=>{e&&n(null)}),()=>e=!1},[]),a.useMemo(()=>null==t?void 0:t.find(t=>t.name===e),[t,e])}},11905:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return v}));var a=n(29),l=n(499),r=n(5591),o=n(109),i=n(1941),c=function(e,t,n,a){return new(n||(n=Promise))((function(l,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function i(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))};const s=e=>e.endsWith("/")?e:e+"/",d=e=>e.startsWith("/")?"."+e:e,u=(e,t,n,l,i,d,u)=>c(void 0,void 0,void 0,(function*(){if(t.startsWith("http://")||t.startsWith("https://"))try{return(yield Object(o.b)(t)).text()}catch(n){throw n.message||(n.message=a.a.t('devconsole~Could not fetch kubernetes resource "{{resourceURI}}" for component "{{componentName}}".',{resourceURI:t,componentName:e})),n}const c=Object(r.e)(n,d,l,i,u);if(!c)throw new Error(a.a.t('devconsole~Could not fetch kubernetes resource "{{resourceURI}}" for component "{{componentName}}". Git provider is not supported.',{resourceURI:t,componentName:e}));let m;if(t.startsWith("/"))m=t;else{m=`${s(i)}${t}`}const v=yield c.getFileContent(m);if(!v)throw new Error(a.a.t('devconsole~Could not fetch kubernetes resource "{{resourcePath}}" for component "{{componentName}}" from Git repository {{url}}.',{resourcePath:m,componentName:e,url:n}));return v})),m=(e,t,n,a,r,o)=>c(void 0,void 0,void 0,(function*(){let i;const c=e;return c.kubernetes&&c.kubernetes.uri?(i=yield u(c.name,c.kubernetes.uri,t,n,a,r,o),i&&(c.kubernetes=l.a(Object.assign(Object.assign({},c.kubernetes),{inlined:i}),["uri"]))):c.openshift&&c.openshift.uri&&(i=yield u(c.name,c.openshift.uri,t,n,a,r,o),i&&(c.openshift=l.a(Object.assign(Object.assign({},c.openshift),{inlined:i}),["uri"]))),c})),v=(e,t,n,a,l,r)=>c(void 0,void 0,void 0,(function*(){var o;const c=Object(i.c)(e);if((null===(o=null==c?void 0:c.components)||void 0===o?void 0:o.length)>0)for(let e of null==c?void 0:c.components)e=yield m(e,t,n,a,l,r);return Object(i.b)(c)}))},11906:function(e,t,n){"use strict";var a=n(0),l=n(404),r=n(8411),o=n(7),i=n(1401),c=n(5);t.a=({devfileSample:e})=>{const{t:t}=Object(o.useTranslation)(),{icon:n,iconClass:s,displayName:d,description:u,git:m,tags:v}=e,f=s?Object(i.d)(s):n||"",p=(null==m?void 0:m.remotes)?Object.values(m.remotes)[0]:"";return a.createElement("div",null,a.createElement("div",{className:"co-catalog-item-details"},f?a.createElement("div",{className:"co-catalog-item-icon"},a.createElement("span",{className:"co-catalog-item-icon__bg"},a.createElement("img",{className:"co-catalog-item-icon__img co-catalog-item-icon__img--large",src:f,alt:d,"aria-hidden":!0}))):a.createElement(l.a,{size:"xl"},a.createElement(r.a,null))," ",a.createElement("div",null,a.createElement("h2",{className:"co-section-heading co-catalog-item-details__name"},d),v&&a.createElement("p",{className:"co-catalog-item-details__tags"},v.map(e=>a.createElement("span",{className:"co-catalog-item-details__tag",key:e},e))))),u&&a.createElement("p",{className:"co-catalog-item-details__description"},u),p&&a.createElement("p",null,t("devconsole~Sample repository:")," ",a.createElement(c.z,{href:p,text:p})))}},11907:function(e,t,n){},11908:function(e,t,n){"use strict";var a=n(0),l=n(80),r=n(516),o=n(164),i=n(19),c=n(615),s=n(11915),d=n(55),u=n(7),m=n(5591),v=n(6790),f=n(8410),p=n(7308),g=n(11909),E=n(5618),y=n(11912);n(11914);t.a=({builderImages:e})=>{const{t:t}=Object(u.useTranslation)(),{values:n,setFieldValue:h,setValues:b}=Object(d.f)(),{import:{strategies:S,loaded:k,loadError:j,selectedStrategy:O,showEditImportStrategy:C,recommendedStrategy:F,strategyChanged:I},devfile:w,docker:D}=n,N=a.useRef(null),R=a.useMemo(()=>({[m.c.DEVFILE]:a.createElement(f.a,null),[m.c.DOCKERFILE]:a.createElement(p.a,null),[m.c.SERVERLESS_FUNCTION]:a.createElement(y.a,{builderImages:e}),[m.c.S2I]:a.createElement(v.a,{builderImages:e})}),[e]),P=a.useMemo(()=>({[m.c.DEVFILE]:t("devconsole~The Devfile at {{filePath}} is recommended.",{filePath:null==w?void 0:w.devfilePath}),[m.c.SERVERLESS_FUNCTION]:t("devconsole~The Serverless function strategy is recommended."),[m.c.DOCKERFILE]:t("devconsole~The Dockerfile at {{filePath}} is recommended.",{filePath:null==D?void 0:D.dockerfilePath}),[m.c.S2I]:t("devconsole~A Builder Image is recommended.")}),[w,D,t]),T=a.useMemo(()=>{let e,n,r;return k&&!j&&S.length>0?(r=l.b.success,F&&!I?(S.length>1?e=t("devconsole~Multiple import strategies detected"):1===S.length&&(e=t("devconsole~{{strategy}} detected.",{strategy:F.name})),n=P[F.type]):I&&(e=t("devconsole~Import strategy changed to {{strategy}}",{strategy:O.name}),n="",r=l.b.info)):(r=l.b.warning,e=t("devconsole~Unable to detect import strategy"),n=a.createElement("span",null,j&&a.createElement(a.Fragment,null,a.createElement("p",null,t("devconsole~Error: {{loadError}}",{loadError:j}))," ",a.createElement("br",null)),a.createElement("p",null,t("devconsole~Select from the options below.")))),{title:e,description:n,variant:r}},[k,j,S.length,F,I,P,t,O.name]),_=a.useCallback(()=>{C?b(N.current):N.current=n,h("import.showEditImportStrategy",!C),h("import.strategyChanged",!1)},[h,b,C,n]);return a.createElement(a.Fragment,null,a.createElement(E.a,null,a.createElement(l.a,{isInline:!0,variant:T.variant,title:T.title},T.description),F&&a.createElement(r.a,null,a.createElement(o.a,{isFilled:!0}),a.createElement(o.a,null,a.createElement(i.a,{variant:i.d.link,className:"odc-import-strategy-section__edit-strategy-button",onClick:_,icon:C?a.createElement(s.a,null):a.createElement(c.a,null),"data-test":"import-strategy-button"},t(C?"devconsole~Revert to recommended":"devconsole~Edit Import Strategy"))))),a.createElement("div",{className:F?"odc-import-strategy-section__strategy-selector":""},C&&a.createElement(a.Fragment,null,a.createElement(E.a,null,a.createElement(g.a,null)),a.createElement("br",null)),R[O.type]))}},11909:function(e,t,n){"use strict";var a=n(0),l=n(219),r=n(379),o=n(88),i=n(184),c=n(7304),s=n(7309),d=n(4373),u=n(8411),m=n(584),v=n(55),f=n(7),p=n(13),g=n(5591),E=n(53),y=n(974),h=n(1402),b=n(132),S=n(76),k=n(15),j=n(11910);n(11911);t.a=()=>{const{t:e}=Object(f.useTranslation)(),{values:{import:{recommendedStrategy:t,selectedStrategy:n},build:{strategy:O},git:{type:C}},setFieldValue:F}=Object(v.f)(),I=Object(k.Kc)("import.selectedStrategy","importStrategySelect"),w=[{name:"Devfile",type:g.c.DEVFILE,build:y.BuildStrategyType.Devfile,priority:2,detectedFiles:[],icon:a.createElement(u.a,null),isDisabled:C===g.b.UNSURE,disabledReason:C===g.b.UNSURE?e("devconsole~Could not get Devfile for an unknown Git type"):null},{name:"Dockerfile",type:g.c.DOCKERFILE,build:y.BuildStrategyType.Docker,priority:1,detectedFiles:[],icon:a.createElement(s.a,null)},{name:"Builder Image",type:g.c.S2I,build:y.BuildStrategyType.Source,priority:0,detectedFiles:[],icon:a.createElement(d.a,null)}],[D]=Object(p.hc)({group:S.p.apiGroup,resource:S.p.plural,namespace:Object(E.c)(),verb:"create"}),N=Object(k.Fe)(b.L)&&D;(null==t?void 0:t.type)===g.c.SERVERLESS_FUNCTION&&N&&w.push({name:"Serverless Function",type:g.c.SERVERLESS_FUNCTION,build:h.k.ServerlessFunction,priority:3,detectedFiles:[],icon:a.createElement(j.a,null)});const R=a.useCallback(e=>{F("import.selectedStrategy.name",e.name),F("import.selectedStrategy.type",e.type),F("import.selectedStrategy.priority",e.priority),F("import.selectedStrategy.detectedFiles",e.detectedFiles),F("build.strategy",e.build),F("import.strategyChanged",!1)},[F]);return Object(k.Ge)(O),a.createElement(l.a,{fieldId:I,label:e("devconsole~Import Strategy")},a.createElement(r.a,{hasGutter:!0},w.map(e=>e.disabledReason?a.createElement(o.a,{content:e.disabledReason},a.createElement(i.a,{span:4,key:e.name},a.createElement(c.a,{className:"odc-import-strategy-selector__tile","data-test":"import-strategy-"+e.name,title:e.name,icon:e.icon,onClick:()=>R(e),isSelected:n.type===e.type,isDisabled:e.isDisabled},(null==t?void 0:t.type)===e.type&&a.createElement("span",{className:"odc-import-strategy-selector__recommended"},a.createElement(m.a,null))))):a.createElement(i.a,{span:4,key:e.name},a.createElement(c.a,{className:"odc-import-strategy-selector__tile","data-test":"import-strategy-"+e.name,title:e.name,icon:e.icon,onClick:()=>R(e),isSelected:n.type===e.type,isDisabled:e.isDisabled},(null==t?void 0:t.type)===e.type&&a.createElement("span",{className:"odc-import-strategy-selector__recommended"},a.createElement(m.a,null)))))))}},11910:function(e,t,n){"use strict";var a=n(0);t.a=()=>a.createElement("svg",{fill:"currentColor",height:"1em",width:"1em",viewBox:"0 0 17 17",transform:"translate(0 4)","aria-hidden":"true",role:"img"},a.createElement("path",{className:"st0",d:"M10 1.5c-1.4-.7-2.7 0-3.4 1.3-.2.4-.2 1.1-.3 1.7-.6 2.8-1.1 5.7-2 8.5-.2.6-.4 1.3-.9 1.7-.4.3-1 .2-1.5 0-.6-.3-1.1.5-.5.9 1.1.6 2.5.4 3.2-.7.6-1 .9-2.3 1.1-3.4.6-2.6 1.2-5.2 1.7-7.8v-.3c0 .1-.1.2 0 0 0-.1.1-.2.2-.3.4-.7 1.1-1.1 1.9-.7.6.2 1.1-.6.5-.9z"}),a.createElement("path",{className:"st0",d:"M4.2 6.2h4.6c.6 0 .6-1 0-1H4.2c-.7 0-.7 1 0 1zM10.5 5.1c-.4 1.9-.7 3.8-1.1 5.6-.1.3-.1.5-.2.8-.1.6.8.9 1 .3.4-1.9.8-3.7 1.2-5.6.1-.3.1-.5.2-.8 0-.6-.9-.9-1.1-.3z"}),a.createElement("path",{className:"st0",d:"M10.9 8.5c-.1.2 0 0 0 0 .1-.3.2-.4.3-.6.2-.4.5-.9.9-1.3s.8-.7 1.3-.9c.3-.1.5-.1.8 0 .2 0 .4.1.5.3 0-.1.1.1.1.2v.1c0 .1 0-.1 0 0v.1c0 .1 0-.2 0 0 0 .1 0 .2-.1.3-.2.9-.4 1.8-.5 2.7-.1.7-.3 1.5-.4 2.2-.1.6.8.9 1 .3.3-1.7.7-3.3 1-5 .1-.6.1-1.1-.3-1.6s-1.2-.6-1.8-.6c-.7.1-1.3.4-1.9.8-.8.7-1.4 1.7-1.8 2.6-.2.4 0 .7.3.7.3.1.5-.1.6-.3z"}))},11911:function(e,t,n){},11912:function(e,t,n){"use strict";var a=n(0),l=n(80),r=n(55),o=n(7),i=n(5618),c=n(5591),s=n(5661),d=n(5),u=n(6789),m=n(6154),v=n(5599),f=n(8029);n(11913);t.a=({builderImages:e})=>{const{t:t}=Object(o.useTranslation)(),{values:n,setFieldValue:p,setFieldError:g,errors:E}=Object(r.f)(),{git:{url:y,type:h,ref:b,dir:S,secretResource:k},image:j}=n,[O,C]=a.useState(),[F,I]=a.useState(!1),[,w]=Object(f.a)(),[D,N]=a.useState("");return a.useEffect(()=>{const n=y&&Object(c.e)(y,h,b,S,k);n&&Object(s.a)(n).then(n=>{w(v.k.KnativeService),C(Object(u.a)(n.values.runtime,e)),u.b.includes(n.values.runtime)?N(t("devconsole~Support for {{runtime}} is not yet available.",{runtime:n.values.runtime})):N(t("devconsole~Unsupported Runtime detected. Please update the Repository URL or change the Build Strategy to continue.")),p("resources",v.k.KnativeService),p("build.env",n.values.builderEnvs),p("deployment.env",n.values.runtimeEnvs)}).catch(e=>{console.warn("Error fetching Serverless Function YAML: ",e),g("ServerlessFunction",e.message)}).finally(()=>{I(!0),p("import.knativeFuncLoaded",!0)})},[p,g,y,h,b,S,k,w,e,N,t]),a.useEffect(()=>{var e;F&&O&&(p("image.tag",null===(e=null==O?void 0:O.recentTag)||void 0===e?void 0:e.name),p("image.selected",null==O?void 0:O.name),p("image.recommended",null==O?void 0:O.name))},[O,p,F]),a.useEffect(()=>{F&&!O&&g("ServerlessFunction","Unsupported Runtime detected")},[g,F,O,E]),F&&!O?a.createElement(i.a,null,a.createElement(l.a,{className:"odc-serverless-function-strategy-section__error-alert",isInline:!0,variant:"danger",title:t("devconsole~Import is not possible.")},D)):F?a.createElement(i.a,{extraMargin:!0},a.createElement(m.a,{selectedBuilderImage:O,selectedImageTag:j.tag})):a.createElement(d.R,null)}},11913:function(e,t,n){},11914:function(e,t,n){},6789:function(e,t,n){"use strict";var a;n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return r})),function(e){e.Node="node",e.NodeJS="nodejs",e.TypeScript="typescript",e.Quarkus="quarkus"}(a||(a={}));const l=["go","rust","springboot","python"],r=(e,t)=>{switch(e){case a.Node:case a.NodeJS:case a.TypeScript:return t.nodejs;case a.Quarkus:return t.java;default:return}}},7308:function(e,t,n){"use strict";var a=n(0),l=n(87),r=n(281),o=n(404),i=n(7309),c=n(55),s=n(7),d=n(5591),u=n(15),m=n(5618),v=function(e,t,n,a){return new(n||(n=Promise))((function(l,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function i(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))};t.a=()=>{const{t:e}=Object(s.useTranslation)(),{values:t,setFieldValue:n,setFieldTouched:f}=Object(c.f)(),{import:{showEditImportStrategy:p,strategies:g,recommendedStrategy:E},git:{url:y,type:h,ref:b,dir:S,secretResource:k},image:{ports:j},docker:O,formType:C}=t,[F,I]=a.useState(l.d.default),w=a.useCallback(()=>v(void 0,void 0,void 0,(function*(){const e=Object(d.e)(y,h,b,S,k,null,O.dockerfilePath),t=e&&(yield e.isDockerfilePresent());O.dockerfilePath&&t?(I(l.d.success),n("docker.dockerfileHasError",!1)):(I(l.d.error),n("docker.dockerfileHasError",!0))})),[S,O.dockerfilePath,b,k,n,h,y]),D=a.useMemo(()=>F===l.d.success?e("devconsole~Validated"):F===l.d.error?e("devconsole~Dockerfile not detected"):e("devconsole~Allows the builds to use a different path to locate your Dockerfile, relative to the Context Dir field."),[e,F]);return a.useEffect(()=>{var e;if(E&&E.type!==d.c.DOCKERFILE){const t=g.find(e=>e.type===d.c.DOCKERFILE);t&&(n("import.selectedStrategy.detectedFiles",t.detectedFiles),n("docker.dockerfilePath",null===(e=t.detectedFiles)||void 0===e?void 0:e[0]),w(),F===l.d.success?n("import.strategyChanged",!0):n("import.strategyChanged",!1)),f("docker.dockerfilePath",!0)}},[E,n,g]),a.useEffect(()=>{const e=y&&Object(d.e)(y,h,b,S,k,null,O.dockerfilePath);e&&e.getDockerfileContent().then(e=>{if(e){const t=new d.a(e).getContainerPort();t&&n("image.ports",[...j,{containerPort:t,protocol:"TCP"}])}})},[O.dockerfilePath,y]),a.createElement(m.a,null,p&&a.createElement(u.ab,{type:r.b.text,name:"docker.dockerfilePath",label:e("devconsole~Dockerfile path"),placeholder:e("devconsole~Enter Dockerfile path"),helpText:D,helpTextInvalid:D,validated:F,onBlur:()=>{w(),F===l.d.success?n("import.strategyChanged",!0):n("import.strategyChanged",!1)},required:!0}),"edit"!==C&&!O.dockerfileHasError&&a.createElement("div",{className:"co-catalog-item-details"},a.createElement(o.a,{size:"xl"},a.createElement(i.a,null))," ",a.createElement("div",null,a.createElement("h2",{className:"co-section-heading co-catalog-item-details__name"},e("devconsole~Dockerfile")))))}},8410:function(e,t,n){"use strict";var a=n(0),l=n(87),r=n(80),o=n(281),i=n(55),c=n(7),s=n(5591),d=n(15),u=n(172),m=n(1941),v=n(5599),f=n(5618),p=n(11904),g=n(11906),E=(n(11907),function(e,t,n,a){return new(n||(n=Promise))((function(l,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function i(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((a=a.apply(e,t||[])).next())}))});t.a=()=>{const{t:e}=Object(c.useTranslation)(),{values:t,setFieldValue:n,setFieldTouched:y}=Object(i.f)(),h=Object(u.a)(),{import:{showEditImportStrategy:b,strategies:S,recommendedStrategy:k,selectedStrategy:j},git:{url:O,type:C,ref:F,dir:I,secretResource:w},devfile:D}=t,[,N]=Object(p.a)(t,n);Object(p.b)();const R=Object(p.c)(),[P,T]=a.useState(l.d.default),_=new URLSearchParams(window.location.search).get("importType"),L=a.useMemo(()=>{var e,t,a,l;let r;if(R)r=R,n("devfile.devfileProjectType",v.m[R.projectType]);else if(D.devfileContent){const n=Object(m.c)(D.devfileContent);r={displayName:(null===(e=n.metadata)||void 0===e?void 0:e.name)||"Devfile",tags:(null===(t=n.metadata)||void 0===t?void 0:t.version)?[n.metadata.version]:[],iconClass:(null===(a=n.metadata)||void 0===a?void 0:a.name)?"icon-"+(null===(l=n.metadata)||void 0===l?void 0:l.name):""}}return r},[R,D.devfileContent,n]),x=a.useCallback(()=>E(void 0,void 0,void 0,(function*(){const e=Object(s.e)(O,C,F,I,w,D.devfilePath),t=e&&(yield e.getDevfileContent());t?(null!=R&&h("Download Devfile from Git",{client:"openshift-console",devfileName:R.name}),n("devfile.devfileContent",t),n("devfile.devfileHasError",!1),T(l.d.success)):(n("devfile.devfileContent",null),n("devfile.devfileHasError",!0),T(l.d.error))})),[D,I,h,F,w,R,n,C,O]),U=a.useMemo(()=>P===l.d.success?e("devconsole~Validated"):P===l.d.error?C===s.b.UNSURE?e("devconsole~Could not get Devfile for an unknown Git type"):e("devconsole~Devfile not detected"):e("devconsole~Allows the builds to use a different path to locate your Devfile, relative to the Context Dir field"),[e,C,P]);return a.useEffect(()=>{var e;if(_!==v.e.devfile&&k&&k.type!==s.c.DEVFILE){const t=S.find(e=>e.type===s.c.DEVFILE);t&&(n("import.selectedStrategy.detectedFiles",t.detectedFiles),n("devfile.devfilePath",null===(e=t.detectedFiles)||void 0===e?void 0:e[0]),n("docker.dockerfilePath","Dockerfile"),x(),P===l.d.success?n("import.strategyChanged",!0):n("import.strategyChanged",!1)),y("devfile.devfilePath",!0)}},[k,n,S]),a.useEffect(()=>{(_===v.e.devfile||j.type===s.c.DEVFILE)&&D.devfilePath&&x()},[_,D.devfilePath,j.type]),a.createElement(a.Fragment,null,N&&a.createElement(f.a,null,a.createElement(r.a,{isInline:!0,className:"odc-devfile-strategy-section__error-alert",variant:"danger",title:e("devconsole~Import is not possible.")},N)),b&&"devfile"!==_&&a.createElement(f.a,null,a.createElement(d.ab,{type:o.b.text,name:"devfile.devfilePath",label:e("devconsole~Devfile Path"),placeholder:e("devconsole~Enter Devfile path"),helpText:U,helpTextInvalid:U,"data-test":"git-form-devfile-path-input",validated:P,onBlur:()=>{x(),P===l.d.success?n("import.strategyChanged",!0):n("import.strategyChanged",!1)},required:!0})),L&&a.createElement(g.a,{devfileSample:L}))}}}]);
//# sourceMappingURL=git-import-form-chunk-524a9e272bb88888e554.min.js.map