(window.webpackJsonp=window.webpackJsonp||[]).push([[76,52],{11869:function(e,a,n){"use strict";var t=n(0),l=n(1922),i=n(967),o=n(406),r=n(219),s=n(281),c=n(242),m=n(72),d=n(297),u=n(319),p=n(157),b=n(516),v=n(164),h=n(354),E=n(165),g=n(294),f=n(205),j=n(87),y=n(6351),O=n(80),A=n(966),x=n(19),C=n(29),L=n(22),k=n(7),S=n(5),M=n(2301),w=n(8),U=n(200),D=n(11870),P=n(8404);function q(e,a){const{maxUnavailable:n,minAvailable:t}=e,l=String(t);return l.includes("%")?parseInt(l.slice(0,-1),10)>=100:0===parseInt(String(n),10)||parseInt(l,10)>=a}a.a=({formData:e,onChange:a,existingResource:n,replicasCount:F})=>{var I,Y;const{t:T}=Object(k.useTranslation)(),B=Object(P.a)(e),[R,V]=t.useState(B),[N,_]=t.useState(""),[K,G]=t.useState(!1),[H,J]=t.useState(""),[$,z]=t.useState(!0),[W,Z]=t.useState([]),[Q,X]=t.useState(null),[ee,ae]=t.useState(!1),ne=t.useMemo(()=>({maxUnavailable:T("console-app~maxUnavailable"),minAvailable:T("console-app~minAvailable")}),[T]),te=((e,a)=>"minAvailable"===e?a.minAvailable:"maxUnavailable"===e?a.maxUnavailable:C.a.t("console-app~Requirement"))(R.requirement,ne),le=t.useCallback(e=>{V(e),a(Object(P.d)(e,n))},[a,n]);t.useEffect(()=>{J(R.requirement),R.requirement!==C.a.t("console-app~Requirement")&&z(!1),!L.a(n)&&L.a(R.name)&&le(Object(P.a)(n))},[n,R,le,H,ne]);const ie=e=>{J(e),ae(!ee),z(!1),le(Object.assign(Object.assign({},R),{requirement:e,minAvailable:"",maxUnavailable:""}))};return t.createElement("div",{className:"co-m-pane__body co-m-pane__form"},t.createElement(l.a,{onSubmit:e=>{e.preventDefault(),G(!0);return(n?Object(P.c)(R,n):Object(w.jb)(U.PodDisruptionBudgetModel,Object(P.d)(R))).then(()=>{G(!1),S.Vb.push(Object(S.uc)(U.PodDisruptionBudgetModel,R.name,R.namespace))}).catch(e=>{_(e.message),G(!1)})}},t.createElement(i.a,{hasGutter:!0},t.createElement(o.a,null,t.createElement(r.a,{label:T("console-app~Name"),isRequired:!0,fieldId:"pdb-name"},t.createElement(s.a,{isRequired:!0,type:"text",name:"name",id:"pdb-name",placeholder:"example",value:R.name,onChange:(e,a)=>le(Object.assign(Object.assign({},R),{name:a})),isDisabled:!!n,autoFocus:!0}))),t.createElement(o.a,null,t.createElement(r.a,{label:T("console-app~Labels"),fieldId:"pdb-labels",labelIcon:t.createElement(M.a,null,t.createElement(c.a,{headingLevel:"h3"},T("console-app~Selector")),t.createElement(m.a,{className:"pdb-form-popover__description"},T("console-app~Label query over pods whose evictions are managed by the disruption budget. Anull selector will match no pods, while an empty ({}) selector will select all pods within the namespace.")))},t.createElement(S.qb,{onChange:e=>(e=>{const a=e.filter(e=>e.includes("=")),t=e.filter(e=>!e.includes("="));le(Object.assign(Object.assign({},R),{selector:{matchLabels:S.qb.objectify(a),matchExpressions:S.qb.arrayToArrayOfObjects(t)}})),Z([...W,...e]),X(n)})(e),tags:[...S.qb.arrayify(R.selector.matchLabels),...S.qb.arrayObjectsToArrayStrings(R.selector.matchExpressions)],labelClassName:"labelClassName"}),Q&&t.createElement(o.a,null,t.createElement(d.a,null,t.createElement(u.a,null,t.createElement(p.a,{variant:"warning"},T("console-app~Resource is already covered by another PodDisruptionBudget"))))))),t.createElement(o.a,null,t.createElement(r.a,{fieldId:"pdb-requirement",label:T("console-app~Availability requirement"),labelIcon:t.createElement(D.a,null)}),t.createElement(b.a,{hasGutter:!0},t.createElement(v.a,{isFilled:!0},t.createElement(h.a,{isOpen:ee,onOpenChange:e=>ae(e),selected:te,onSelect:e=>ie(e),toggle:e=>t.createElement(E.a,{ref:e,isExpanded:ee,isFullWidth:!0,onClick:e=>ae(e)},te)},t.createElement(g.a,null,Object.keys(ne).map(e=>t.createElement(f.a,{key:e,value:e,onClick:()=>ie(e)},ne[e]))))),t.createElement(v.a,{isFilled:!0},t.createElement(s.a,{type:"text","aria-label":T("console-app~Availability requirement value"),onChange:(e,a)=>{le(Object.assign(Object.assign({},R),{[H]:a}))},value:(null===(I=null==R?void 0:R.minAvailable)||void 0===I?void 0:I.toString())||(null===(Y=null==R?void 0:R.maxUnavailable)||void 0===Y?void 0:Y.toString()),placeholder:T("console-app~Value (% or number)"),name:"availability requirement value",isDisabled:$,validated:q(R,F)?j.d.warning:j.d.default})))),q(R,F)&&t.createElement(o.a,null,t.createElement(y.a,null,t.createElement(O.a,{variant:"warning",title:T("console-app~Availability requirement value warning"),"aria-live":"polite",isInline:!0},T("console-app~A maxUnavailable of 0% or 0 or a minAvailable of 100% or greater than or equal to the number of replicas is permitted but can block nodes from being drained.")))),t.createElement(o.a,null,t.createElement(S.g,{errorMessage:N,inProgress:K},t.createElement(A.a,{className:"pf-v5-c-form"},t.createElement(x.a,{type:"submit",id:"save-changes",variant:"primary",isDisabled:!R.name},T(n?"console-app~Save":"console-app~Create")),t.createElement(x.a,{onClick:S.Vb.goBack,id:"cancel",variant:"secondary"},T("console-app~Cancel"))))))))}},11870:function(e,a,n){"use strict";var t=n(0),l=n(967),i=n(406),o=n(242),r=n(72),s=n(7),c=n(5),m=n(2301);a.a=()=>{const{t:e}=Object(s.useTranslation)();return t.createElement(m.a,null,t.createElement(l.a,{hasGutter:!0},t.createElement(i.a,null,t.createElement(o.a,{headingLevel:"h3"},e("console-app~Availability requirement"))),t.createElement(i.a,null,t.createElement(o.a,{headingLevel:"h4"},e("console-app~maxUnavailable"))),t.createElement(i.a,null,t.createElement(r.a,{className:"pdb-form-popover__description"},e('console-app~An eviction is allowed if at most "maxUnavailable" pods selected by "selector" are unavailable after the eviction, i.e. even in absence of the evicted pod. For example, one can prevent all voluntary evictions by specifying 0. This is a mutually exclusive setting with "minAvailable".'))),t.createElement(i.a,null,t.createElement(o.a,{headingLevel:"h4"},e("console-app~minAvailable"))),t.createElement(i.a,null,t.createElement(r.a,null,e('console-app~An eviction is allowed if at least "minAvailable" pods selected by "selector" will still be available after the eviction, i.e. even in the absence of the evicted pod. So for example you can prevent all voluntary evictions by specifying "100%".'))),t.createElement(i.a,null,t.createElement(o.a,{headingLevel:"h5"},e("console-app~More information:"))),t.createElement(i.a,null,t.createElement(c.z,{href:c.o,text:e("console-app~PodDisruptionBudget documentation")}))))}},4389:function(e,a,n){"use strict";n.r(a),n.d(a,"CreateYAMLInner",(function(){return v})),n.d(a,"CreateYAML",(function(){return E})),n.d(a,"EditYAMLPage",(function(){return g}));var t=n(0),l=n(14),i=n(7),o=n(876),r=n(2264),s=n(2258),c=n(567),m=n(282),d=n(5),u=n(8),p=n(765),b=n(1941);const v=e=>{const{params:a,kindsInFlight:l,kindObj:c,hideHeader:v=!1,onChange:h=(()=>null),resourceObjPath:E,isCreate:g=!0}=e,{t:f}=Object(i.useTranslation)(),[j,y]=Object(o.useResolvedExtensions)(t.useCallback(e=>Object(r.a)(e)&&e.properties.model.kind===(null==c?void 0:c.kind),[c])),O=t.useMemo(()=>Object(s.b)(j),[j]);if(!c)return l||!y?t.createElement(d.S,null):t.createElement(p.ErrorPage404,null);const A=a.ns||"default",x=e.template||O.getIn([Object(u.Hb)(c),"default"])||O.getIn(["DEFAULT","default"]),C=Object(b.c)(x);C.kind=c.kind,C.metadata=C.metadata||{},c.namespaced&&(C.metadata.namespace=A),c.crd&&x===O.getIn(["DEFAULT","default"])&&(C.apiVersion=Object(u.n)(c),C.spec=C.spec||{});const L=f("public~Create {{objLabel}}",{objLabel:c.labelKey?f(c.labelKey):c.label});return t.createElement(m.a,{loader:()=>Promise.all([n.e(0),n.e(19),n.e(21),n.e(23),n.e(27),n.e(29),n.e(48)]).then(n.bind(null,5413)).then(e=>e.DroppableEditYAML),initialResource:C,create:g,kind:c.kind,header:L,hideHeader:v,resourceObjPath:E,onChange:h})},h=Object(c.b)(v),E=e=>{const a=Object(l.useParams)();return t.createElement(h,Object.assign({},e,{params:a}))},g=e=>{const a=Object(l.useParams)();return t.createElement(d.C,{resources:[{kind:e.kind,name:a.name,namespace:a.ns,isList:!1,prop:"obj"}]},t.createElement(e=>t.createElement(m.a,Object.assign({},e,{obj:e.obj.data,loader:()=>Promise.all([n.e(0),n.e(19),n.e(21),n.e(23),n.e(27),n.e(29)]).then(n.bind(null,2261)).then(e=>e.EditYAML),create:!1})),null))};E.displayName="CreateYAML",g.displayName="EditYAMLPage"},5539:function(e,a,n){"use strict";n.r(a),n.d(a,"PDBFormPage",(function(){return E}));var t=n(0),l=n(7),i=n(14),o=n(4389),r=n(5),s=n(108),c=n(8),m=n(6692),d=n(614),u=n(1941),p=n(200),b=n(8404),v=n(11869),h=n(2266);const E=()=>{var e,a,n,E;const{t:g}=Object(l.useTranslation)(),f=Object(i.useParams)(),j=Object(i.useLocation)(),y={params:Object.assign(Object.assign({},f),{plural:p.PodDisruptionBudgetModel.plural,appName:""}),isExact:!0,url:"",path:""},O=new URLSearchParams(j.search).get("name"),A=Object(c.F)(f.resourceRef)||[],[x,C,L]=A,[k,S]=Object(s.a)({groupVersionKind:{group:x,kind:L,version:C},name:O,namespaced:!0,namespace:f.ns}),[M,w]=Object(s.a)({groupVersionKind:{group:p.PodDisruptionBudgetModel.apiGroup,kind:p.PodDisruptionBudgetModel.kind,version:p.PodDisruptionBudgetModel.apiVersion},isList:!0,namespaced:!0,namespace:f.ns}),U=Object(h.b)(M,k),D=g("console-app~Create by completing the form."),P=g("console-app~Create by manually entering YAML or JSON definitions, or by dragging and dropping a file into the editor."),q={name:"",namespace:f.ns,selector:{matchLabels:null===(n=null===(a=null===(e=null==k?void 0:k.spec)||void 0===e?void 0:e.template)||void 0===a?void 0:a.metadata)||void 0===n?void 0:n.labels}||{}},[F,I]=t.useState(D),Y=Object(b.d)(q),T=g(U?"console-app~Edit {{label}}":"console-app~Create {{label}}",{label:p.PodDisruptionBudgetModel.label}),B=!S||!w;return t.createElement(t.Fragment,null,B?t.createElement(r.S,null):t.createElement(t.Fragment,null,t.createElement(r.Z,{title:T,helpText:t.createElement(l.Trans,{t:g,ns:"console-app"},F)}),t.createElement(m.a,{context:{formContext:{existingResource:U,params:y.params,replicasCount:null===(E=null==k?void 0:k.spec)||void 0===E?void 0:E.replicas},yamlContext:{}},FormEditor:v.a,initialData:U||Y,initialType:d.b.Form,onChangeEditorType:e=>I(e===d.b.Form?D:P),YAMLEditor:({onChange:e,initialYAML:a=""})=>{const n=Object(b.b)(a,U);return t.createElement(o.CreateYAML,{hideHeader:!0,onChange:e,match:y,template:Object(u.b)(n,"yamlData",{skipInvalid:!0}),isCreate:!U})},lastViewUserSettingKey:"console.pdbForm.editor.lastView",displayConversionError:!0})))}},6692:function(e,a,n){"use strict";n.d(a,"a",(function(){return h}));var t=n(0),l=n(80),i=n(19),o=n(4429),r=n(489),s=n(107),c=n(7),m=n(5),d=n(1941),u=n(614),p=n(2307);const b=["apiVerion","kind","metadata","spec","status"],v={skipInvalid:!0,sortKeys:(e,a)=>o.a(b,e)-o.a(b,a)},h=({context:e={},FormEditor:a,initialType:n=u.b.Form,initialData:o={},onChangeEditorType:b=r.a,onChange:h=r.a,prune:E,YAMLEditor:g,lastViewUserSettingKey:f,displayConversionError:j})=>{const{formContext:y,yamlContext:O}=e,{t:A}=Object(c.useTranslation)(),[x,C]=t.useState(o),[L,k]=t.useState(Object(d.b)(o,"yamlData",{skipInvalid:!0})),[S,M]=t.useState(),[w,U]=t.useState(!1),[D,P,q]=Object(p.a)(f,n),F=(e={})=>{s.a(e,x)||(C(e),h(e))},I=e=>{P(e),b(e)};return q?t.createElement(t.Fragment,null,t.createElement(u.a,{value:D,onChange:e=>{switch(e){case u.b.YAML:k(Object(d.b)(null!==(a=null==E?void 0:E(x))&&void 0!==a?a:x,L,v)),I(u.b.YAML);break;case u.b.Form:void 0===S?I(u.b.Form):U(!0)}var a}}),w&&t.createElement(l.a,{className:"co-synced-editor__yaml-warning",variant:"danger",isInline:!0,title:A("console-shared~Invalid YAML cannot be persisted")},j&&t.createElement("p",null,S),t.createElement("p",null,A("console-shared~Switching to form view will delete any invalid YAML.")),t.createElement(i.a,{variant:"danger",onClick:()=>{M(void 0),U(!1),I(u.b.Form)}},A("console-shared~Switch and delete"))," ",t.createElement(i.a,{variant:"secondary",onClick:()=>{U(!1)}},A("console-shared~Cancel"))),D===u.b.Form?t.createElement(a,Object.assign({formData:x,onChange:F,prune:E},y)):t.createElement(g,Object.assign({initialYAML:L,onChange:(e="")=>{Object(d.a)(e).then(e=>{var a;M(void 0),F(e),k(Object(d.b)(null!==(a=null==E?void 0:E(x))&&void 0!==a?a:x,L,v))}).catch(e=>M(String(e)))}},O))):t.createElement(m.S,null)}},8404:function(e,a,n){"use strict";n.d(a,"d",(function(){return u})),n.d(a,"a",(function(){return p})),n.d(a,"c",(function(){return b})),n.d(a,"b",(function(){return v}));var t=n(29),l=n(499),i=n(1557),o=n(373),r=n(22),s=n(8),c=n(1941),m=n(200);const d=e=>{if(""===e)return e;if("number"==typeof e)return e;return/^[0-9]*$/.test(e)?parseInt(e,10):e},u=(e,a)=>{var n,t;const o="Requirement"===e.requirement?null:e.requirement,r={kind:m.PodDisruptionBudgetModel.kind,apiVersion:`${m.PodDisruptionBudgetModel.apiGroup}/${m.PodDisruptionBudgetModel.apiVersion}`,metadata:{name:e.name,namespace:e.namespace},spec:{selector:{matchLabels:null===(n=null==e?void 0:e.selector)||void 0===n?void 0:n.matchLabels,matchExpressions:null===(t=null==e?void 0:e.selector)||void 0===t?void 0:t.matchExpressions}}},s=l.a(a,["spec.minAvailable","spec.maxUnavailable"]);return o?i.a({},s,r,{spec:{[o]:""!==e.minAvailable?d(e.minAvailable):d(e.maxUnavailable)}}):r},p=e=>{var a,n,l,i,r,s,c,m,d,u,p;return{name:(null===(a=null==e?void 0:e.metadata)||void 0===a?void 0:a.name)||"",namespace:(null===(n=null==e?void 0:e.metadata)||void 0===n?void 0:n.namespace)||"",minAvailable:null!==(i=null===(l=null==e?void 0:e.spec)||void 0===l?void 0:l.minAvailable)&&void 0!==i?i:"",maxUnavailable:null!==(s=null===(r=null==e?void 0:e.spec)||void 0===r?void 0:r.maxUnavailable)&&void 0!==s?s:"",selector:{matchLabels:null===(c=null==e?void 0:e.spec)||void 0===c?void 0:c.selector.matchLabels,matchExpressions:null===(m=null==e?void 0:e.spec)||void 0===m?void 0:m.selector.matchExpressions}||{},requirement:o.a(null===(d=null==e?void 0:e.spec)||void 0===d?void 0:d.minAvailable)&&o.a(null===(u=null==e?void 0:e.spec)||void 0===u?void 0:u.maxUnavailable)?t.a.t("console-app~Requirement"):o.a(null===(p=null==e?void 0:e.spec)||void 0===p?void 0:p.minAvailable)?"maxUnavailable":"minAvailable"}},b=(e,a)=>{var n,t;const l=[];return r.a(e.selector.matchLabels)||l.push({op:"add",path:"/spec/selector/matchLabels",value:e.selector.matchLabels}),r.a(e.selector.matchExpressions)||l.push({op:"add",path:"/spec/selector/matchExpressions",value:e.selector.matchExpressions}),""!==e.minAvailable&&l.push({op:"add",path:"/spec/minAvailable",value:d(e.minAvailable)}),""!==e.maxUnavailable&&l.push({op:"add",path:"/spec/maxUnavailable",value:d(e.maxUnavailable)}),o.a(null===(n=null==a?void 0:a.spec)||void 0===n?void 0:n.minAvailable)||""===e.maxUnavailable||l.push({op:"remove",path:"/spec/minAvailable"},{op:"add",path:"/spec/maxUnavailable",value:d(e.maxUnavailable)}),o.a(null===(t=null==a?void 0:a.spec)||void 0===t?void 0:t.maxUnavailable)||""===e.minAvailable||l.push({op:"remove",path:"/spec/maxUnavailable"},{op:"add",path:"/spec/minAvailable",value:d(e.minAvailable)}),Object(s.pb)(m.PodDisruptionBudgetModel,a,l)},v=(e,a)=>u(p(Object(c.c)(e)),a)}}]);
//# sourceMappingURL=PDBFormPage-chunk-27c6fcfbec60c4f6c7e7.min.js.map