(window.webpackJsonp=window.webpackJsonp||[]).push([[163],{5531:function(e,t,a){"use strict";a.r(t),a.d(t,"AddGitLabPage",(function(){return h}));var n=a(0),r=a(137),c=a(7),l=a(14),i=a(966),o=a(19),s=a(10),u=a(8),d=a(5),m=a(5957),p=a(5958),b=a(6040);const h=()=>{const e=Object(l.useNavigate)(),[t,a]=n.useState(!1),[h,v]=n.useState(""),[g,f]=n.useState("gitlab"),[E,N]=n.useState(""),[y,C]=n.useState(""),[O,j]=n.useState(""),[q,P]=n.useState(""),{t:S}=Object(c.useTranslation)(),A=e=>(a(!0),e.then(e=>(e=>(a(!1),v(""),e))(e),e=>(e=>{const t=e.message||S("public~An error occurred. Please try again.");return a(!1),v(t),Promise.reject(t)})(e))),T=()=>{const e={apiVersion:"v1",kind:"Secret",metadata:{generateName:"gitlab-client-secret-",namespace:"openshift-config"},stringData:{clientSecret:y}};return A(Object(u.jb)(s.SecretModel,e))},w=()=>{if(!q)return Promise.resolve(null);const e={apiVersion:"v1",kind:"ConfigMap",metadata:{generateName:"gitlab-ca-",namespace:"openshift-config"},data:{"ca.crt":q}};return A(Object(u.jb)(s.ConfigMapModel,e))},M=(e,t,a,n)=>{const r={name:g,type:"GitLab",mappingMethod:"claim",gitlab:{url:O,clientID:E,clientSecret:{name:t}}};return a&&(r.gitlab.ca={name:a}),A(Object(m.a)(e,r,n))},k=S("public~Add Identity Provider: GitLab");return n.createElement("div",{className:"co-m-pane__form"},n.createElement(r.a,null,n.createElement("title",null,k)),n.createElement(d.Z,{title:k,helpText:S("public~You can use GitLab integration for users authenticating with GitLab credentials.")}),n.createElement("div",{className:"co-m-pane__body"},n.createElement("form",{onSubmit:t=>{t.preventDefault(),v(""),A(Object(m.b)()).then(t=>{const a=q?m.c.ca:"";M(t,m.c.secret,a,!0).then(()=>{const a=[T(),w()];Promise.all(a).then(([e,a])=>{const n=a?a.metadata.name:"";return M(t,e.metadata.name,n)}).then(()=>{Object(m.d)(e)})}).catch(e=>{v(e)})})},name:"form",className:"co-m-pane__body-group"},n.createElement(p.a,{value:g,onChange:e=>f(e.currentTarget.value)}),n.createElement("div",{className:"form-group"},n.createElement("label",{className:"control-label co-required",htmlFor:"url"},S("public~URL")),n.createElement("input",{className:"pf-v5-c-form-control",type:"url",onChange:e=>j(e.currentTarget.value),value:O,id:"url","aria-describedby":"idp-url-help",required:!0}),n.createElement("p",{className:"help-block",id:"idp-url-help"},S("public~The OAuth server base URL."))),n.createElement("div",{className:"form-group"},n.createElement("label",{className:"control-label co-required",htmlFor:"client-id"},S("public~Client ID")),n.createElement("input",{className:"pf-v5-c-form-control",type:"text",onChange:e=>N(e.currentTarget.value),value:E,id:"client-id",required:!0})),n.createElement("div",{className:"form-group"},n.createElement("label",{className:"control-label co-required",htmlFor:"client-secret"},S("public~Client secret")),n.createElement("input",{className:"pf-v5-c-form-control",type:"password",onChange:e=>C(e.currentTarget.value),value:y,id:"client-secret",required:!0})),n.createElement(b.a,{value:q,onChange:e=>P(e)}),n.createElement(d.g,{errorMessage:h,inProgress:t},n.createElement(i.a,{className:"pf-v5-c-form"},n.createElement(o.a,{type:"submit",variant:"primary","data-test-id":"add-idp"},S("public~Add")),n.createElement(o.a,{type:"button",variant:"secondary",onClick:()=>e(-1)},S("public~Cancel")))))))}},5957:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"d",(function(){return s})),a.d(t,"c",(function(){return u}));var n=a(22),r=a(10),c=a(8),l=a(5);const i=()=>Object(c.kb)(r.OAuthModel,"cluster"),o=(e,t,a)=>{const l=n.a(e.spec.identityProviders)?{op:"add",path:"/spec/identityProviders",value:[t]}:{op:"add",path:"/spec/identityProviders/-",value:t};return Object(c.pb)(r.OAuthModel,e,[l],a?{queryParams:{dryRun:"All"}}:{})},s=e=>{e(Object(l.uc)(r.OAuthModel,"cluster")+"?idpAdded=true")},u={secret:"secret-name",ca:"ca-name"}},5958:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(0),r=a(7);const c=({value:e,onChange:t})=>{const{t:a}=Object(r.useTranslation)();return n.createElement("div",{className:"form-group"},n.createElement("label",{className:"control-label co-required",htmlFor:"idp-name"},a("public~Name")),n.createElement("input",{className:"pf-v5-c-form-control",type:"text",onChange:t,value:e,"aria-describedby":"idp-name-help",id:"idp-name",required:!0}),n.createElement("p",{className:"help-block",id:"idp-name-help"},a("public~Unique name of the new identity provider. This cannot be changed later.")))}},6040:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(0),r=a(7),c=a(5);const l=e=>n.createElement(c.c,Object.assign({loader:()=>Promise.resolve().then(a.bind(null,2223)).then(e=>e.DroppableFileInput)},e)),i=({value:e,onChange:t,isRequired:a=!1})=>{const{t:c}=Object(r.useTranslation)();return n.createElement("div",{className:"form-group"},n.createElement(l,{onChange:t,inputFileData:e,id:"idp-file-input",label:c("public~CA file"),isRequired:a,hideContents:!0}))}}}]);
//# sourceMappingURL=gitlab-idp-form-chunk-f059e966f0de1b560021.min.js.map