(window.webpackJsonp=window.webpackJsonp||[]).push([[182],{5528:function(e,a,t){"use strict";t.r(a),t.d(a,"InstantiateTemplatePage",(function(){return F}));var n=t(0),c=t(31),l=t(14),r=t(547),s=t(839),i=t(50),m=t(22),o=t(137),d=t(18),p=t(155),u=t(88),E=t(19),g=t(219),b=t(867),f=t(318),v=t(1938),h=t(281),N=t(319),y=t(157),j=t(966),O=t(6435),_=t(7),w=t(15),k=t(13),T=t(69),C=t(1634),S=t.n(C),R=t(1401),I=t(5),x=t(10),q=t(77),L=function(e,a,t,n){return new(t||(t=Promise))((function(c,l){function r(e){try{i(n.next(e))}catch(e){l(e)}}function s(e){try{i(n.throw(e))}catch(e){l(e)}}function i(e){var a;e.done?c(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(r,s)}i((n=n.apply(e,a||[])).next())}))};const D=({template:e})=>{const a=r.a(s.a(i.a(e.objects,"kind"))).sort();return m.a(a)?null:n.createElement(n.Fragment,null,n.createElement(p.a,{className:"co-divider"}),n.createElement("p",null,"The following resources will be created:"),n.createElement("ul",null,a.map(e=>n.createElement("li",{key:e},e))))};D.displayName="TemplateResourceDetails";const P=({template:e})=>{const{t:a}=Object(_.useTranslation)(),t=e.metadata.annotations||{},{description:c}=t,l=t[w.d.displayName]||e.metadata.name,r=Object(R.f)(e),s=r?Object(R.d)(r):S.a,o=(t.tags||"").split(/\s*,\s*/),p=t[w.d.documentationURL],u=t[w.d.supportURL];return n.createElement("div",{className:"co-catalog-item-info"},n.createElement("div",{className:"co-catalog-item-details"},n.createElement("div",{className:"co-catalog-item-icon"},n.createElement("span",{className:"co-catalog-item-icon__bg"},s?n.createElement("img",{className:"co-catalog-item-icon__img co-catalog-item-icon__img--large",src:s,alt:l,"aria-hidden":!0}):n.createElement("span",{className:d("co-catalog-item-icon__icon co-catalog-item-icon__icon--large",Object(R.h)(r)),"aria-hidden":!0}))),n.createElement("div",null,n.createElement("h2",{className:"co-section-heading co-catalog-item-details__name"},l),!m.a(o)&&n.createElement("p",{className:"co-catalog-item-details__tags"},i.a(o,(e,a)=>n.createElement("span",{className:"co-catalog-item-details__tag",key:a},e))),(p||u)&&n.createElement("ul",{className:"list-inline"},p&&n.createElement("li",{className:"co-break-word"},n.createElement(I.z,{href:p,text:a("public~View documentation")})),u&&n.createElement("li",{className:"co-break-word"},n.createElement(I.z,{href:u,text:a("public~Get support")}))))),c&&n.createElement("p",{className:"co-catalog-item-details__description"},c),n.createElement(D,{template:e}))};P.displayName="TemplateInfo";const U=({name:e,value:a,displayName:t,description:c,onChange:l,placeholder:r,required:s,helpID:i})=>{const[m,o]=n.useState(!1),{t:d}=Object(_.useTranslation)("public"),p={"aria-describedby":i,placeholder:r,isRequired:s,onChange:l,value:a,id:e,name:e},j=d(m?"Compress to a single line of content. This may strip any new lines you have entered.":"Expand to enter multiple lines of content. This is required if you need to include newline characters."),w=n.createElement(u.a,{aria:"none","aria-live":"polite",content:j},n.createElement(E.a,{"aria-label":j,onClick:()=>o(!m),variant:"control"},m?n.createElement(O.CompressIcon,null):n.createElement(O.ExpandIcon,null)));return n.createElement(g.a,{label:t||e,isRequired:s,fieldId:e},n.createElement(b.a,null,n.createElement(f.a,{isFill:!0},m?n.createElement(v.b,Object.assign({resizeOrientation:"vertical"},p)):n.createElement(h.a,Object.assign({type:"text"},p))),n.createElement(f.a,null,w)),c&&n.createElement(N.a,null,n.createElement(y.a,{id:i},c)))},V=Object(c.connect)(e=>({models:e.k8s.getIn(["RESOURCES","models"])}))(Object(T.A)({perspectiveExtensions:k.Cb})(Object(w.gf)(e=>{const{preselectedNamespace:a="",activePerspective:t,perspectiveExtensions:c,obj:r}=e,[s,i]=n.useState(a),[m,o]=n.useState([]),[d,p]=n.useState(!1),[u,g]=n.useState(""),b=n.useRef(!0),{t:f}=Object(_.useTranslation)(),v=Object(l.useNavigate)();n.useEffect(()=>{if(b.current&&r.loaded){const e=(r.data.parameters||[]).reduce((e,{name:a,value:t})=>(e[a]=t,e),{});o(e),b.current=!1}},[r]);const h=e=>{const{name:a,value:t}=e.currentTarget;o(e=>Object.assign(Object.assign({},e),{[a]:t}))};if(r.loadError)return n.createElement(I.Q,{label:f("public~Template")},r.loadError.message);if(!r.loaded)return n.createElement(I.S,null);const N=r.data,y=N.parameters||[];return n.createElement("div",{className:"row"},n.createElement("div",{className:"col-md-7 col-md-push-5 co-catalog-item-info"},n.createElement(P,{template:N})),n.createElement("div",{className:"col-md-5 col-md-pull-7"},n.createElement("form",{className:"pf-v5-c-form co-instantiate-template-form",onSubmit:e=>{e.preventDefault(),s?(g(""),p(!0),(()=>{const e={apiVersion:"v1",kind:"Secret",metadata:{generateName:r.data.metadata.name+"-parameters-",namespace:s},stringData:m};return Object(q.g)({model:x.SecretModel,data:e})})().then(e=>(e=>{const a={apiVersion:"template.openshift.io/v1",kind:"TemplateInstance",metadata:{generateName:r.data.metadata.name+"-",namespace:s},spec:{template:r.data,secret:{name:e.metadata.name}}};return Object(q.g)({model:x.TemplateInstanceModel,data:a})})(e).then(a=>L(void 0,void 0,void 0,(function*(){yield((e,a)=>{const t=Object.assign(Object.assign({},e),{metadata:Object.assign(Object.assign({},e.metadata),{ownerReferences:[{apiVersion:a.apiVersion,kind:a.kind,name:a.metadata.name,uid:a.metadata.uid}]})});return Object(q.r)({model:x.SecretModel,data:t,name:e.metadata.name,ns:e.metadata.namespace})})(e,a),p(!1);const n=c.find(e=>e.properties.id===t),l=(yield n.properties.importRedirectURL())(s);v(l)})))).catch(e=>{p(!1),g(e.message)})):g("Please complete all fields.")}},n.createElement("div",{className:"form-group"},n.createElement("label",{className:"control-label co-required",htmlFor:"namespace"},f("public~Namespace")),n.createElement(I.W,{selectedKey:s,onChange:e=>i(e),id:"namespace"})),y.map(({name:e,displayName:a,description:t,required:c,generate:l})=>{const r=m[e]||"",s=t?e+"-help":"",i=l?f("public~(generated if empty)"):"",o=c&&!l;return n.createElement(U,{key:e,name:e,value:r,displayName:a,description:t,required:o,onChange:h,placeholder:i,helpID:s})}),n.createElement(I.g,{className:"co-instantiate-template-form__button-bar",errorMessage:u},n.createElement(j.a,{className:"pf-v5-c-form"},n.createElement(E.a,{type:"submit",variant:"primary",isLoading:d},f("public~Create")),n.createElement(E.a,{type:"button",variant:"secondary",onClick:()=>v(-1)},f("public~Cancel")))))))}))),F=e=>{const a="Instantiate Template",t=Object(l.useLocation)(),c=new URLSearchParams(t.search),r=c.get("template"),s=c.get("template-ns"),i=c.get("preselected-ns"),m=[{kind:"Template",name:r,namespace:s,isList:!1,prop:"obj"}];return n.createElement(n.Fragment,null,n.createElement(o.a,null,n.createElement("title",null,a)),n.createElement(I.Z,{title:a}),n.createElement("div",{className:"co-m-pane__body co-m-pane__body--no-top-margin"},n.createElement(I.C,{resources:m},n.createElement(V,Object.assign({preselectedNamespace:i},e)))))}}}]);
//# sourceMappingURL=instantiate-template-chunk-e34d88e022483ea8b5be.min.js.map