(window.webpackJsonp=window.webpackJsonp||[]).push([[293],{11734:function(e,t,a){"use strict";var n=a(0),s=a(55),r=a(109),o=a(11735),l=a(6876),i=a(7548);t.a=({service:e,cancel:t,close:a})=>{const c=e.data.metadata.name,u=e.data.metadata.namespace,d={request:{format:l.a.CloudEvent,contentType:"application/json",isAdvancedSettingsExpanded:!1,type:"",source:"",customHeaders:[[]],body:{data:'{"message": "Hello World!"}'}},response:{status:"",statusCode:null,header:{},body:""}};return n.createElement(s.b,{initialValues:d,onSubmit:(e,t)=>{r.c.post(`/api/console/knative/namespaces/${u}/services/${c}/invoke`,Object(i.b)(e)).then(e=>{Object(i.d)(e,t)}).catch(e=>{t.setFieldValue("response.status",e.message),t.setFieldValue("response.statusCode",500),t.setFieldValue("response.body",`{ "error": "${e.message}" }`),t.setStatus({error:e.message})})},onReset:t,initialStatus:{error:""}},s=>n.createElement(o.a,Object.assign({},s,{cancel:t,service:e,close:a})))}},11735:function(e,t,a){"use strict";var n=a(0),s=a(242),r=a(19),o=a(264),l=a(7),i=a(11736),c=a(11737),u=a(6876),d=a(7548);a(7549);t.a=e=>{const{t:t}=Object(l.useTranslation)(),{handleSubmit:a,cancel:m,close:p,isSubmitting:v}=e,[g,b]=n.useState(u.b.Request),f=n.createElement(n.Fragment,null,n.createElement(s.a,{id:"modal-custom-header-label",headingLevel:"h1",size:s.b["2xl"]},t("knative-plugin~Test Serverless Function"))),E=n.createElement(n.Fragment,null,g===u.b.Request?n.createElement("form",{onSubmit:()=>{a(),b(u.b.Response)}},n.createElement(r.a,{type:"submit",variant:"primary","data-test":"test-action",isDisabled:v},t("knative-plugin~Test")),"   ",n.createElement(r.a,{type:"button",variant:"secondary","data-test":"cancel-action",onClick:m},t("knative-plugin~Cancel"))):n.createElement(n.Fragment,null,n.createElement(r.a,{type:"button",variant:"primary","data-test":"back-action",onClick:()=>{Object(d.a)(e),b(u.b.Request)}},t("knative-plugin~Back"))," ",n.createElement(r.a,{type:"button",variant:"secondary","data-test":"close-action",onClick:()=>{Object(d.a)(e),p()}},t("knative-plugin~Close"))));return n.createElement(o.a,{variant:o.b.small,isOpen:!0,header:f,className:"kn-test-sf-modal",onClose:p,position:"top",footer:E,"data-test":"test-serverless-function"},n.createElement("div",{className:"kn-test-sf-modal__body"},g===u.b.Request?n.createElement(i.a,Object.assign({},e)):n.createElement(c.a,Object.assign({},e))))}},11736:function(e,t,a){"use strict";var n=a(0),s=a(1921),r=a(281),o=a(19),l=a(407),i=a(7),c=a(282),u=a(2294),d=a(5918),m=a(6876),p=a(7548);a(7549);const v=e=>n.createElement(c.a,Object.assign({loader:()=>Promise.resolve().then(a.bind(null,1949)).then(e=>e.NameValueEditor)},e));t.a=({setFieldValue:e,values:t})=>{const{t:a}=Object(i.useTranslation)(),[c,g]=n.useState(!1),{request:{customHeaders:b,format:f,contentType:E,isAdvancedSettingsExpanded:h}}=t,[k,y]=n.useState(h),j={[m.a.CloudEvent]:a("knative-plugin~CloudEvent"),[m.a.HTTP]:a("knative-plugin~HTTP")},C=[{value:"application/json",label:a("knative-plugin~application/json"),disabled:!1},{value:"application/yaml",label:a("knative-plugin~application/yaml"),disabled:!1}];return n.createElement(n.Fragment,null,n.createElement(d.a,null,n.createElement(u.s,{label:a("knative-plugin~Format"),name:"request.format",items:j,dataTest:"invoke-format-dropdown",title:a("knative-plugin~"+f),fullWidth:!0,required:!0}),n.createElement(u.mb,{name:"request.contentType",label:a("knative-plugin~Content-Type"),options:C,toggleOnSelection:!0,hideClearButton:!0,required:!0})),n.createElement("div",{className:"kn-test-sf-modal-request__advanced-settings"},n.createElement(s.a,{toggleText:a("knative-plugin~Advanced Settings"),onToggle:(t,a)=>{y(a),e("request.isAdvancedSettingsExpanded",a)},isExpanded:k,"data-test":"advanced-settings"},n.createElement(d.a,null,n.createElement(u.H,{type:r.b.text,name:"request.type",label:a("knative-plugin~Type"),"data-test":"request-type",placeholder:"boson.fn"}),n.createElement(u.H,{type:r.b.text,name:"request.source",label:a("knative-plugin~Source"),"data-test":"request-source",placeholder:"/boson/fn"})),n.createElement("div",{className:"kn-test-sf-modal-request__custom-headers"},c||!(()=>{let e=[];return(f===m.a.HTTP||f===m.a.CloudEvent)&&(e=b.filter(e=>!e.every(e=>""===e))),0===e.length})()?n.createElement(v,{nameValuePairs:b,nameString:a("knative-plugin~Name"),valueString:a("knative-plugin~Value"),addString:a("knative-plugin~Add headers"),readOnly:!1,allowSorting:!1,updateParentData:({nameValuePairs:t})=>{t.forEach(e=>e.length>=3&&e.splice(2,1)),e("request.customHeaders",t)}}):n.createElement(o.a,{className:"pf-m-link--align-left","data-test":"add-optional-header",onClick:()=>g(!0),type:"button",variant:"link"},n.createElement(l.a,{"data-test-id":"pairs-list__add-icon",className:"co-icon-space-r"}),a("knative-plugin~Add optional headers"))))),n.createElement("div",{className:"kn-test-sf-modal__editor"},n.createElement(u.n,{name:"request.body.data",minHeight:"34vh",showSamples:!1,showShortcuts:!1,showMiniMap:!1,language:Object(p.c)(E)})))}},11737:function(e,t,a){"use strict";var n=a(0),s=a(80),r=a(351),o=a(7),l=a(5),i=a(2294);a(7549);t.a=({values:e})=>{const{t:t}=Object(o.useTranslation)(),{statusCode:a,header:c}=e.response;return n.createElement(n.Fragment,null,n.createElement("div",{className:"kn-test-sf-modal-response__notification"},null===a?n.createElement(s.a,{variant:"info",title:t("knative-plugin~Waiting for response"),"data-test":"alert-wait"}):200===a?n.createElement(s.a,{variant:"success",title:t("knative-plugin~The Test was Successful"),"data-test":"alert-success"},n.createElement("div",null," ",n.createElement("strong",null,t("knative-plugin~Response Status Code: ")),n.createElement(r.a,{color:"green"},n.createElement("strong",null,a)))):n.createElement(s.a,{variant:"danger",title:t("knative-plugin~An error occurred"),"data-test":"alert-danger"},n.createElement("div",null," ",n.createElement("strong",null,t("knative-plugin~Response Status Code: ")),n.createElement(r.a,{color:"red"},n.createElement("strong",null,a))))),Object.keys(c).length>0&&n.createElement("div",{className:"kn-test-sf-modal-response__headers"},n.createElement(l.x,{textCollapsed:t("knative-plugin~Show Response Headers"),textExpanded:t("knative-plugin~Hide Response Headers")},n.createElement("div",{className:"header-section"},Object.entries(c).map(([e,t])=>t.map(t=>n.createElement("div",{className:"header-row",key:`${e}-${t}`},n.createElement("span",{className:"header-name"},e,":"),n.createElement("span",{className:"header-value"},t))))))),n.createElement("div",{className:"kn-test-sf-modal__editor"},null!==a?n.createElement(i.n,{name:"response.body",minHeight:"34vh",showSamples:!1,showShortcuts:!1,showMiniMap:!1,language:"json"}):n.createElement(l.R,{className:"kn-test-sf-modal-response__loading"})))}},5501:function(e,t,a){"use strict";a.r(t),a.d(t,"testFunctionModalLauncher",(function(){return u}));var n=a(0),s=a(40),r=a(5),o=a(76),l=a(11734);const i=e=>{const{loaded:t,obj:a}=e;return t?n.createElement(l.a,Object.assign({},e,{service:a})):null},c=e=>{const{obj:t}=e,a=[{kind:o.p.kind,isList:!1,prop:"obj",namespace:t.metadata.namespace,name:t.metadata.name}];return n.createElement(r.C,{resources:a},n.createElement(i,Object.assign({},e)))},u=Object(s.m)(c,!1);t.default=c},5798:function(e,t,a){"use strict";var n=a(83),s=a(768),r=a(10),o=a(2236);t.a=()=>Object(s.a)({groupVersionKind:Object(n.getGroupVersionKindForModel)(r.ConsoleOperatorConfigModel),isList:!1,name:o.a})},5799:function(e,t,a){"use strict";var n=a(875),s=a(10),r=a(8),o=a(2236);t.a=e=>{const t=Object(r.Jb)(s.ConsoleOperatorConfigModel,{name:o.a});return Object(n.b)(t,"PATCH",{headers:{Accept:"application/json","Content-Type":"application/merge-patch+json;charset=UTF-8"},body:JSON.stringify(e)})}},5800:function(e,t,a){"use strict";var n=a(0),s=a(4),r=a(1953),o=a.n(r);t.a=({children:e,isHorizontal:t=!1,isWidthLimited:a=!0})=>n.createElement("div",{className:Object(s.css)(o.a.form,t&&o.a.modifiers.horizontal,a&&o.a.modifiers.limitWidth)},e)},5801:function(e,t,a){"use strict";var n=a(0),s=a(80),r=a(7);t.a=({error:e})=>{var t,a,o;const{t:l}=Object(r.useTranslation)();return e?n.createElement(s.a,{variant:"warning",isInline:!0,title:l("console-shared~Could not load configuration.")},(null===(a=null===(t=e.message)||void 0===t?void 0:t.toString)||void 0===a?void 0:a.call(t))||(null===(o=e.toString)||void 0===o?void 0:o.call(e))):null}},5802:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(0),s=a(80),r=a(7);const o=({status:e,error:t})=>{var a,o,l;const{t:i}=Object(r.useTranslation)();return"successful"===e?n.createElement(s.a,{variant:"success","data-test":"success-alert",isInline:!0,title:i("console-shared~Saved.")},i("console-shared~This config update requires a console rollout, this can take up to a minute and require a browser refresh.")):"error"===e?n.createElement(s.a,{variant:"danger",isInline:!0,title:i("console-shared~Could not save configuration.")},(null===(o=null===(a=null==t?void 0:t.message)||void 0===a?void 0:a.toString)||void 0===o?void 0:o.call(a))||(null===(l=null==t?void 0:t.toString)||void 0===l?void 0:l.call(t))):null}},5803:function(e,t,a){"use strict"},5918:function(e,t,a){"use strict";var n=a(766);a.d(t,"f",(function(){return n.a}));var s=a(5798);a.d(t,"e",(function(){return s.a}));var r=a(5799);a.d(t,"d",(function(){return r.a}));var o=a(5800);a.d(t,"a",(function(){return o.a}));var l=a(5801);a.d(t,"b",(function(){return l.a}));var i=a(5802);a.d(t,"c",(function(){return i.a}));a(5803)},6876:function(e,t,a){"use strict";var n,s;a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return s})),function(e){e.HTTP="HTTP",e.CloudEvent="CloudEvent"}(n||(n={})),function(e){e.Request="Request",e.Response="Response"}(s||(s={}))},7548:function(e,t,a){"use strict";a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return o})),a.d(t,"a",(function(){return l}));var n=a(6876);const s=e=>e.startsWith("application/json")?"json":e.startsWith("application/yaml")?"yaml":"plaintext",r=e=>{const{format:t,contentType:a,customHeaders:s,type:r,source:o,body:l}=e.request,i={"ce-source":[...r?[r]:["boson.fn"]],"ce-type":[...o?[o]:["/boson/fn"]]},c={type:[...r?[r]:["boson.fn"]],source:[...o?[o]:["/boson/fn"]]},u=s.reduce((e,[t,a])=>{var n;return""!==t&&a&&(e[t]=[...null!==(n=e[t])&&void 0!==n?n:[],a]),e},{});return{allowInsecure:!0,body:{"invoke-header":Object.assign(Object.assign({},t===n.a.CloudEvent?i:c),u),"invoke-query":{},"invoke-message":l.data,"invoke-format":t===n.a.CloudEvent?"ce":"http","invoke-contentType":a}}},o=(e,t)=>{const{setFieldValue:a,setStatus:n}=t,{status:s,statusCode:r,header:o,body:l}=e;200===r?(a("response.status",s),a("response.statusCode",200),a("response.header",o),a("response.body",l),n({error:""})):(n({error:l}),a("response.body",`{ "error": ${l} }`),a("response.status",s),a("response.statusCode",r))},l=e=>{const{setFieldValue:t}=e;t("response.body",""),t("response.statusCode",null),t("response.header",{}),t("response.status","")}},7549:function(e,t,a){}}]);
//# sourceMappingURL=test-serverless-function-chunk-2589379c50fae8d9ccb1.min.js.map