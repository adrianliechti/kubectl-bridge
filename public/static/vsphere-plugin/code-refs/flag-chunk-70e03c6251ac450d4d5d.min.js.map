{"version":3,"sources":["webpack:///./packages/vsphere-plugin/src/flag.ts","webpack:///./packages/vsphere-plugin/src/constants.ts"],"names":["useVSphereFlagHandler","setFeatureFlag","InfrastructureModel","group","version","kind","infra","model","name","status","platform","e","console","error","VSPHERE_FEATURE_FLAG","VSPHERE_PLATFORM","VSPHERE_CREDS_SECRET_NAME","VSPHERE_CREDS_SECRET_NAMESPACE","VSPHERE_CONFIGMAP_NAME","VSPHERE_CONFIGMAP_NAMESPACE","KUBE_CONTROLLER_MANAGER_NAME","FAILURE_DOMAIN_NAME"],"mappings":"8dAMO,MAAMA,EAAyBC,IACpC,MAAOC,GAAuB,aAAY,CACxCC,MAAO,sBACPC,QAAS,KACTC,KAAM,mBAGR,YAAgB,KAoBVH,GAnB0B,OAAD,6B,MAC3B,IACE,MAAMI,QAAc,aAAuB,CACzCC,MAAOL,EACPM,KAAM,YAGR,IAAiB,QAAb,EAAAF,aAAK,EAALA,EAAOG,cAAM,eAAEC,YAAa,IAE9B,YADAT,EAAe,KAAsB,GAGvC,MAAOU,GAEPC,QAAQC,MAAM,yCAA0CF,GAG1DV,EAAe,KAAsB,OAMtC,CAACC,EAAqBD,M,kCCpC3B,gRAAO,MAAMa,EAAuB,oBACvBC,EAAmB,UAEnBC,EAA4B,gBAC5BC,EAAiC,cAEjCC,EAAyB,wBACzBC,EAA8B,mBAE9BC,EAA+B,UAE/BC,EAAsB","file":"vsphere-plugin/code-refs/flag-chunk-70e03c6251ac450d4d5d.min.js","sourcesContent":["import * as React from 'react';\nimport { SetFeatureFlag } from '@console/dynamic-plugin-sdk';\nimport { k8sGet, useK8sModel } from '@console/dynamic-plugin-sdk/src/api/core-api';\nimport { VSPHERE_FEATURE_FLAG, VSPHERE_PLATFORM } from './constants';\nimport { Infrastructure } from './resources';\n\nexport const useVSphereFlagHandler = (setFeatureFlag: SetFeatureFlag) => {\n  const [InfrastructureModel] = useK8sModel({\n    group: 'config.openshift.io',\n    version: 'v1',\n    kind: 'Infrastructure',\n  });\n\n  React.useEffect(() => {\n    const doItAsync = async () => {\n      try {\n        const infra = await k8sGet<Infrastructure>({\n          model: InfrastructureModel,\n          name: 'cluster',\n        });\n\n        if (infra?.status?.platform === VSPHERE_PLATFORM) {\n          setFeatureFlag(VSPHERE_FEATURE_FLAG, true);\n          return;\n        }\n      } catch (e) {\n        // eslint-disable-next-line no-console\n        console.error('Error when reading infrastructure CR: ', e);\n      }\n\n      setFeatureFlag(VSPHERE_FEATURE_FLAG, false);\n    };\n\n    if (InfrastructureModel) {\n      doItAsync();\n    }\n  }, [InfrastructureModel, setFeatureFlag]);\n};\n","export const VSPHERE_FEATURE_FLAG = 'VSPHERECONNECTION';\nexport const VSPHERE_PLATFORM = 'VSphere';\n\nexport const VSPHERE_CREDS_SECRET_NAME = 'vsphere-creds';\nexport const VSPHERE_CREDS_SECRET_NAMESPACE = 'kube-system';\n\nexport const VSPHERE_CONFIGMAP_NAME = 'cloud-provider-config';\nexport const VSPHERE_CONFIGMAP_NAMESPACE = 'openshift-config';\n\nexport const KUBE_CONTROLLER_MANAGER_NAME = 'cluster';\n\nexport const FAILURE_DOMAIN_NAME = 'generated-failure-domain';\n"],"sourceRoot":""}