(window.webpackJsonp=window.webpackJsonp||[]).push([[96],{5427:function(e,i,s){"use strict";s.r(i);var t,n=s(0),a=s(354),l=s(165),o=s(294),r=s(205),c=s(1921),u=s(866),d=s(965),v=s(1940),p=s(219),b=s(380),m=s(7),g=s(13),f=s(69),h=s(15),w=s(5918);!function(e){e.Enabled="Enabled",e.Disabled="Disabled",e.AccessReview="AccessReview"}(t||(t={}));const E=({toggleId:e,disabled:i,value:s,onChange:v})=>{var p,g,f,h,w,E,O,R,j;const{t:y}=Object(m.useTranslation)(),C=[{value:"Enabled",title:y("console-app~Enabled"),description:y("console-app~Perspectives are enabled by default."),visibility:{state:t.Enabled},isSelected:!s||!s.state||s.state===t.Enabled},{value:"RequiredNamespace",title:y("console-app~Only visible for privileged users"),description:y("console-app~Privileged users can list all namespaces."),visibility:{state:t.AccessReview,accessReview:{required:[{resource:"namespaces",verb:"get"}]}},isSelected:(null==s?void 0:s.state)===t.AccessReview&&1===(null===(g=null===(p=s.accessReview)||void 0===p?void 0:p.required)||void 0===g?void 0:g.length)&&"namespaces"===s.accessReview.required[0].resource&&"get"===s.accessReview.required[0].verb&&2===Object.values(s.accessReview.required[0]).filter(Boolean).length&&!(null===(h=null===(f=s.accessReview)||void 0===f?void 0:f.missing)||void 0===h?void 0:h.length)},{value:"MissingNamespace",title:y("console-app~Only visible for unprivileged users"),description:y("console-app~Unprivileged users cannot list all namespaces."),visibility:{state:t.AccessReview,accessReview:{missing:[{resource:"namespaces",verb:"get"}]}},isSelected:(null==s?void 0:s.state)===t.AccessReview&&1===(null===(E=null===(w=s.accessReview)||void 0===w?void 0:w.missing)||void 0===E?void 0:E.length)&&"namespaces"===s.accessReview.missing[0].resource&&"get"===s.accessReview.missing[0].verb&&2===Object.values(s.accessReview.missing[0]).filter(Boolean).length&&!(null===(R=null===(O=s.accessReview)||void 0===O?void 0:O.required)||void 0===R?void 0:R.length)},{value:"Disabled",title:y("console-app~Disabled"),description:y("console-app~Disable this perspectives for all users."),visibility:{state:t.Disabled},isSelected:(null==s?void 0:s.state)===t.Disabled}];C.some(e=>e.isSelected)||C.push({value:"Custom",title:y("console-app~Custom"),description:y("console-app~This perspective is shown based on custom access review rules. Please open the console configuration resource to inspect or update this rules."),isSelected:!0});const[S,T]=n.useState(!1),q=null===(j=C.find(e=>e.isSelected))||void 0===j?void 0:j.value;return n.createElement(n.Fragment,null,n.createElement(a.a,{isOpen:S,onSelect:()=>T(!1),selected:q,onOpenChange:e=>T(e),toggle:s=>{var t;return n.createElement(l.a,{isFullWidth:!0,id:e,isDisabled:i,ref:s,onClick:e=>T(e)},null===(t=C.find(e=>e.isSelected))||void 0===t?void 0:t.title)}},n.createElement(o.a,null,C.map(e=>n.createElement(r.a,{key:e.value,value:e.value,description:e.description,onClick:()=>v(e)},e.title)))),"Custom"===q&&(null==s?void 0:s.accessReview)&&n.createElement(c.a,{toggleText:y("console-app~Access review rules")},n.createElement(u.a,null,n.createElement(d.a,null,Object(b.safeDump)(s.accessReview)))))};i.default=({readonly:e})=>{const{t:i}=Object(m.useTranslation)(),s=Object(h.cf)(),t=Object(f.z)(g.Cb),[a,l,o]=Object(w.e)(),[r,c]=n.useState();n.useEffect(()=>{var e,i;a&&l&&!r&&c(null===(i=null===(e=null==a?void 0:a.spec)||void 0===e?void 0:e.customization)||void 0===i?void 0:i.perspectives)},[r,a,l]);const[u,d]=n.useState(),b=Object(w.f)(()=>{d({status:"in-progress"});const e={spec:{customization:{perspectives:r}}};Object(w.d)(e).then(()=>d({status:"successful"})).catch(e=>d({status:"error",error:e}))},2e3),O=e||!t||!l||!!o;return n.createElement(w.a,{isHorizontal:!0},n.createElement(v.a,{title:i("console-app~Perspectives"),"data-test":"perspectives form-section"},t.map(e=>{var i;const t=e.uid,a=e.properties.id,l=null===(i=null==r?void 0:r.find(e=>e.id===a))||void 0===i?void 0:i.visibility;return n.createElement(p.a,{key:e.uid,label:e.properties.name,fieldId:t,"data-test":"perspectives form-group"},n.createElement(E,{toggleId:t,disabled:O,value:l,onChange:i=>{s("Console cluster configuration changed",{customize:"Perspective",id:e.properties.id,name:e.properties.name,visibility:i.value}),i.visibility&&c(e=>{const s=e?[...e]:[],t=s.findIndex(e=>e.id===a);return-1===t?s.push({id:a,visibility:i.visibility}):s[t].visibility=i.visibility,s}),b()}}))}),n.createElement(w.b,{error:o}),n.createElement(w.c,Object.assign({},u))))}},5798:function(e,i,s){"use strict";var t=s(83),n=s(768),a=s(10),l=s(2236);i.a=()=>Object(n.a)({groupVersionKind:Object(t.getGroupVersionKindForModel)(a.ConsoleOperatorConfigModel),isList:!1,name:l.a})},5799:function(e,i,s){"use strict";var t=s(875),n=s(10),a=s(8),l=s(2236);i.a=e=>{const i=Object(a.Jb)(n.ConsoleOperatorConfigModel,{name:l.a});return Object(t.b)(i,"PATCH",{headers:{Accept:"application/json","Content-Type":"application/merge-patch+json;charset=UTF-8"},body:JSON.stringify(e)})}},5800:function(e,i,s){"use strict";var t=s(0),n=s(4),a=s(1953),l=s.n(a);i.a=({children:e,isHorizontal:i=!1,isWidthLimited:s=!0})=>t.createElement("div",{className:Object(n.css)(l.a.form,i&&l.a.modifiers.horizontal,s&&l.a.modifiers.limitWidth)},e)},5801:function(e,i,s){"use strict";var t=s(0),n=s(80),a=s(7);i.a=({error:e})=>{var i,s,l;const{t:o}=Object(a.useTranslation)();return e?t.createElement(n.a,{variant:"warning",isInline:!0,title:o("console-shared~Could not load configuration.")},(null===(s=null===(i=e.message)||void 0===i?void 0:i.toString)||void 0===s?void 0:s.call(i))||(null===(l=e.toString)||void 0===l?void 0:l.call(e))):null}},5802:function(e,i,s){"use strict";s.d(i,"a",(function(){return l}));var t=s(0),n=s(80),a=s(7);const l=({status:e,error:i})=>{var s,l,o;const{t:r}=Object(a.useTranslation)();return"successful"===e?t.createElement(n.a,{variant:"success","data-test":"success-alert",isInline:!0,title:r("console-shared~Saved.")},r("console-shared~This config update requires a console rollout, this can take up to a minute and require a browser refresh.")):"error"===e?t.createElement(n.a,{variant:"danger",isInline:!0,title:r("console-shared~Could not save configuration.")},(null===(l=null===(s=null==i?void 0:i.message)||void 0===s?void 0:s.toString)||void 0===l?void 0:l.call(s))||(null===(o=null==i?void 0:i.toString)||void 0===o?void 0:o.call(i))):null}},5803:function(e,i,s){"use strict"},5918:function(e,i,s){"use strict";var t=s(766);s.d(i,"f",(function(){return t.a}));var n=s(5798);s.d(i,"e",(function(){return n.a}));var a=s(5799);s.d(i,"d",(function(){return a.a}));var l=s(5800);s.d(i,"a",(function(){return l.a}));var o=s(5801);s.d(i,"b",(function(){return o.a}));var r=s(5802);s.d(i,"c",(function(){return r.a}));s(5803)}}]);
//# sourceMappingURL=perspectiveConfiguration-chunk-c9d8ba4c1dd83693930b.min.js.map