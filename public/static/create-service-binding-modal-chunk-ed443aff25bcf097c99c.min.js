(window.webpackJsonp=window.webpackJsonp||[]).push([[127,235],{11738:function(e,t,n){"use strict";var a=n(0),r=n(242),i=n(281),c=n(22),o=n(7),s=n(5618),l=n(118),u=n(2271),d=n(15),m=n(11739);t.a=({source:e,target:t,handleSubmit:n,isSubmitting:b,cancel:v,status:p,errors:f})=>{var g;const{t:j}=Object(o.useTranslation)(),O=e.metadata.name,S=null===(g=null==t?void 0:t.metadata)||void 0===g?void 0:g.name,h=t?a.createElement(o.Trans,{t:j,ns:"console-app"},"Connect ",a.createElement("b",null,{sourceName:O})," to service ",a.createElement("b",null,{targetName:S}),"."):j("console-app~Select a service to connect to.");return a.createElement("form",{onSubmit:n,className:"modal-content"},a.createElement(l.d,null,j("console-app~Create Service Binding")),a.createElement(l.a,null,a.createElement(u.b,null),a.createElement("br",null),a.createElement(r.a,{headingLevel:"h2",size:"md",className:"co-m-form-row"},h),a.createElement(s.a,{fullWidth:!0},a.createElement(d.ab,{type:i.b.text,name:"name",label:j("console-app~Name"),required:!0}),!t&&a.createElement(m.a,{resource:e}))),a.createElement(l.c,{submitText:j("console-app~Create"),submitDisabled:b||!c.a(f),cancel:v,inProgress:b,errorMessage:null==p?void 0:p.submitError}))}},11739:function(e,t,n){"use strict";var a=n(0),r=n(219),i=n(80),c=n(55),o=n(230),s=n(22),l=n(7),u=n(83),d=n(108),m=n(8),b=n(519),v=n(15),p=n(11740);t.a=({resource:e})=>{const{t:t}=Object(l.useTranslation)(),{setFieldValue:n,setFieldTouched:f,setStatus:g}=Object(c.f)(),[j,O]=a.useState(!1),{group:S,version:h,kind:E}=Object(u.getGroupVersionKindForModel)(b.a),k={csvs:{isList:!0,kind:Object(m.Gb)(S)(h)(E),namespace:e.metadata.namespace,optional:!0}},y=Object(d.b)(k),w=a.useCallback((e,t,a)=>{s.a(a)||(f("service",!0),n("bindableService",a),g({submitError:null}))},[f,n,g]);a.useEffect(()=>{g({subscriberAvailable:!j})},[j,g]);const x=a.useMemo(()=>Object(p.a)(e.metadata.namespace,null==y?void 0:y.csvs),[y,e.metadata.namespace]);return a.createElement(r.a,{fieldId:Object(v.Kc)("bindable-service","dropdown"),label:t("console-app~Bindable service"),isRequired:!0},j&&a.createElement(a.Fragment,null,a.createElement(i.a,{variant:"custom",title:t("console-app~No bindable services available"),isInline:!0},t("console-app~To create a Service binding, first create a bindable service.")),"Â "),a.createElement(v.Ob,{name:"service",resources:x,dataSelector:["metadata","name"],fullWidth:!0,required:!0,placeholder:t("console-app~Select Service"),showBadge:!0,autocompleteFilter:(e,t)=>{var n;return o(e,null===(n=null==t?void 0:t.props)||void 0===n?void 0:n.name)},onChange:w,autoSelect:!0,disabled:j,onLoad:e=>{O(s.a(e))}}))}},11740:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(499),r=n(2948),i=n(8),c=n(15);const o=(e,t)=>{const n=a.a(Object.assign(Object.assign({},Object(r.a)(e)),((e,t)=>{const n=Object(c.od)(null==t?void 0:t.data);return Object.keys(n).map(t=>{const{group:a,version:r,kind:c}=((e,t)=>{var n,a,r;const i=null===(r=null===(a=null===(n=e.spec)||void 0===n?void 0:n.customresourcedefinitions)||void 0===a?void 0:a.owned)||void 0===r?void 0:r.find(e=>e.kind===t);return{group:i.name.substring(i.name.indexOf(".")+1,i.name.length),version:i.version,kind:i.kind}})(n[t],t);return"ServiceBinding"!==c&&{isList:!0,kind:Object(i.Gb)(a)(r)(c),namespace:e,optional:!0,prop:t}})})(e,t)),"serviceBindingRequests");return Object.keys(n).map(e=>n[e])}},11741:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t,n,a)=>e.find(e=>{var r,i,c;return((e,t,n)=>(null==e?void 0:e.name)===t.metadata.name&&(null==e?void 0:e.resource)===n.plural)(e.spec.application,t,a)&&0!==Object.keys(null!==(i=e.spec.services,c=n,r=i.find(e=>e.kind===c.kind&&e.name===c.metadata.name))&&void 0!==r?r:{}).length})},11742:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(689);const r=e=>a.object().shape({name:a.string().required(e("console-app~Required"))})},5422:function(e,t,n){"use strict";n.r(t),n.d(t,"createServiceBinding",(function(){return s})),n.d(t,"getCreateConnector",(function(){return u}));var a=n(4436),r=n(2240),i=n(8),c=n(769),o=n(5659);const s=(e,t,n)=>{if(!e||!t||e===t)return Promise.reject();const r=t.metadata.name,{namespace:o,name:s}=e.metadata,l=a.a(e.apiVersion,"/"),u=a.a(t.apiVersion,"/"),d={apiVersion:Object(i.n)(c.a),kind:c.a.kind,metadata:{name:n,namespace:o},spec:{application:{name:s,group:l[0],version:l[1],resource:Object(i.vb)(Object(i.Db)(e)).plural},services:[{group:u[0],version:u[1],kind:t.kind,name:r}],detectBindingResources:!0}};return Object(i.jb)(c.a,d)},l=(e,t)=>{var n,a;const c=e.getData().resource||(null===(n=e.getData().resources)||void 0===n?void 0:n.obj),o=t.getData().resource||(null===(a=t.getData().resources)||void 0===a?void 0:a.obj);return Object(r.a)({model:Object(i.vb)(Object(i.Db)(c)),source:c,target:o}).then(()=>null)},u=(e,t,n)=>e&&e.includes("createServiceBinding")&&n.getType()===o.d?l:null},5507:function(e,t,n){"use strict";n.r(t),n.d(t,"createServiceBindingModal",(function(){return j}));var a=n(0),r=n(55),i=n(7),c=n(118),o=n(5),s=n(8),l=n(769),u=n(15),d=n(172),m=n(5422),b=n(2968),v=n(11738),p=n(11741),f=n(11742),g=function(e,t,n,a){return new(n||(n=Promise))((function(r,i){function c(e){try{s(a.next(e))}catch(e){i(e)}}function o(e){try{s(a.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,o)}s((a=a.apply(e,t||[])).next())}))};const j=Object(c.f)(e=>{const{source:t,model:n}=e,{t:c}=Object(i.useTranslation)(),j=Object(d.a)(),[O]=Object(b.a)(),S=Object(u.Pe)(),h={name:e.target?`${t.metadata.name}-${n.abbr.toLowerCase()}-${e.target.metadata.name}-${Object(s.vb)(Object(s.Db)(e.target)).abbr.toLowerCase()}`:"",bindableService:e.target?e.target:{}};return a.createElement(r.b,{initialValues:h,initialStatus:{error:""},validationSchema:Object(f.a)(c),onSubmit:(a,r)=>g(void 0,void 0,void 0,(function*(){const i=yield Object(s.nb)(l.a,{ns:t.metadata.namespace});let u={};if(i.length>0&&(u=Object(p.a)(i,t,a.bindableService,n)),0===Object.keys(null!=u?u:{}).length)try{yield Object(m.createServiceBinding)(t,a.bindableService,a.name),e.close(),j("Service Binding Created"),null===Object(o.Tb)("view")&&((e,t,n)=>{g(void 0,void 0,void 0,(function*(){const a=n.find(e=>e.properties.id===t),r=(yield a.properties.importRedirectURL())(e);o.Vb.push(r)}))})(t.metadata.namespace,O,S)}catch(e){r.setStatus({submitError:e.message})}else r.setStatus({submitError:c("console-app~Service binding already exists. Select a different service to connect to.")})}))},t=>a.createElement(v.a,Object.assign({},t,e)))})},5618:function(e,t,n){"use strict";var a=n(0),r=n(297),i=n(18),c=n.n(i);n(5732);const o={display:"flex",flex:1,flexDirection:"column",margin:"var(--pf-v5-global--spacer--md) 0"};t.a=({title:e,subTitle:t,fullWidth:n,children:i,flexLayout:s,extraMargin:l,dataTest:u,style:d})=>a.createElement("div",{className:c()("pf-v5-c-form",{"co-m-pane__form":!n,"odc-form-section--extra-margin":l}),style:Object.assign(Object.assign({},s?o:{}),d||{}),"data-test":u},e&&a.createElement("h2",{className:"odc-form-section__heading"},e),t&&a.createElement(r.a,null,t),i)},5659:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return o}));var a=n(2221);const r="operator-backed-service",i=a.h,c=a.f,o=a.g},5732:function(e,t,n){}}]);
//# sourceMappingURL=create-service-binding-modal-chunk-ed443aff25bcf097c99c.min.js.map