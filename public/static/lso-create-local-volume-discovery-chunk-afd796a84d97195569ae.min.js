(window.webpackJsonp=window.webpackJsonp||[]).push([[204],{11774:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var o=n(0),l=n(1191),s=n(7),a=n(40),i=n(10),c=n(416),r=n(7554);n(11775);const d=({allNodes:e,selectNodes:t,showSelectNodes:n,setSelectNodes:d,setShowSelectNodes:u,taintsFilter:m})=>{const{t:v}=Object(s.useTranslation)();return o.createElement(o.Fragment,null,o.createElement("div",{id:"auto-detect-volume-radio-group-node-selector"},o.createElement(l.a,{label:o.createElement(o.Fragment,null,v("lso-plugin~Disks on all nodes")," ","(",v("lso-plugin~{{nodes, number}} node",{nodes:e.length,count:e.length}),")"),name:"nodes-selection",id:"auto-detect-volume-radio-all-nodes",className:"lso-lvd-body__all-nodes-radio--padding",value:"allNodes",onChange:u,description:v("lso-plugin~Discovers available disks on all nodes."),checked:!n}),o.createElement(l.a,{label:v("lso-plugin~Disks on selected nodes"),name:"nodes-selection",id:"auto-detect-volume-radio-select-nodes",value:"selectedNodes",onChange:u,description:v("lso-plugin~Allows you to limit the discovery for available disks to specific nodes."),checked:n})),n&&o.createElement("div",{className:"lso-lvd-body__select-nodes"},o.createElement(a.c,{showTitle:!1,kind:i.NodeModel.kind,ListComponent:r.a,customData:{onRowSelected:e=>d(e),preSelectedNodes:t.map(c.d),hasOnSelect:!0,taintsFilter:m}})))}},11775:function(e,t,n){},11776:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(0),l=n(563),s=n(72),a=n(7);const i=({className:e,variant:t})=>{const{t:n}=Object(a.useTranslation)();return o.createElement(o.Fragment,null,o.createElement(l.a,null,o.createElement(s.a,{component:t,className:e},n("lso-plugin~Local Volume Discovery"))),o.createElement("p",{className:"help-block"},n("lso-plugin~Allows you to discover the available disks on all available nodes")))}},11777:function(e,t,n){},5516:function(e,t,n){"use strict";n.r(t),n.d(t,"CreateLocalVolumeDiscovery",(function(){return N}));var o=n(0),l=n(72),s=n(1922),a=n(219),i=n(7),c=n(14),r=n(5),d=n(108),u=n(983),m=n(8),v=n(519),p=n(6095),f=n(788),b=n(7552),h=n(6257),g=n(7553),S=n(11774),y=n(11776),E=n(7556),j=(n(11777),function(e,t,n,o){return new(n||(n=Promise))((function(l,s){function a(e){try{c(o.next(e))}catch(e){s(e)}}function i(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((o=o.apply(e,t||[])).next())}))});const N=()=>{const{appName:e,ns:t}=Object(c.useParams)(),{t:n}=Object(i.useTranslation)(),[N,O,D]=Object(d.a)(b.a),[w,k]=o.useState([]),[T,x]=o.useState([]),[_,C]=o.useState(!1),[F,L]=o.useState(!1),[P,V]=o.useState("");o.useEffect(()=>{if(O&&!D&&0!==N.length){const e=N.filter(h.d);k(e)}},[N,D,O]);const z=_?T:w,M=Object(r.uc)(v.a,e,t);return o.createElement(o.Fragment,null,o.createElement("div",{className:"co-create-operand__header"},o.createElement(y.a,{variant:l.b.h1,className:"co-create-operand__header-text"})),o.createElement(s.a,{noValidate:!1,className:"co-m-pane__body lso-form-body__node-list",onSubmit:n=>{n.preventDefault();const o=Object(h.b)(z),l=`/k8s/ns/${t}/clusterserviceversions/${e}/${Object(m.Hb)(f.LocalVolumeDiscovery)}/${p.a}`;((e,t,n,o,l)=>{j(void 0,void 0,void 0,(function*(){var s;o(!0);try{yield Object(E.b)(e,t,n),u.b.push(l)}catch(o){if(404===(null===(s=null==o?void 0:o.response)||void 0===s?void 0:s.status))try{yield Object(E.a)(e,t,n),u.b.push(l)}catch(e){n(e.message)}else n(o.message)}finally{o(!1)}}))})(o,t,V,L,l)}},o.createElement(a.a,{label:n("lso-plugin~Node Selector"),fieldId:"auto-detect-volume--radio-group-node-selector"},o.createElement(S.a,{allNodes:w,selectNodes:T,showSelectNodes:_,setShowSelectNodes:()=>C(!_),setSelectNodes:x})),o.createElement(g.a,{inProgress:F,errorMessage:P,disableNext:z.length<1,cancelUrl:M})))}},6095:function(e,t,n){"use strict";var o;n.d(t,"c",(function(){return o})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return a})),n.d(t,"g",(function(){return i})),n.d(t,"k",(function(){return c})),n.d(t,"j",(function(){return r})),n.d(t,"i",(function(){return d})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return v})),function(e){e.All="All",e.SSD="SSD",e.HDD="HDD"}(o||(o={}));const l=Object.freeze({BLOCK:"Block",FILESYSTEM:"Filesystem"}),s=["topology.kubernetes.io/zone","failure-domain.beta.kubernetes.io/zone"],a={[o.SSD]:{property:"NonRotational"},[o.HDD]:{property:"Rotational"}},i=Object.freeze({DISK:"Disk",PART:"Part",MPATH:"Mpath"}),c=Object.freeze({EXT4:"ext4",EXT3:"ext3",XFS:"xfs"}),r=e=>Object.freeze({[o.All]:e("lso-plugin~All"),[o.SSD]:e("lso-plugin~SSD / NVMe"),[o.HDD]:e("lso-plugin~HDD")}),d={Ti:"TiB",Gi:"GiB"},u="auto-discover-devices",m="kubernetes.io/hostname",v="In"},6257:function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return c}));var o=n(22),l=n(6095);const s=e=>{var t;return o.a(null===(t=e.spec)||void 0===t?void 0:t.taints)},a=e=>{var t,n;return(null===(t=e.metadata.labels)||void 0===t?void 0:t[l.f[0]])||(null===(n=e.metadata.labels)||void 0===n?void 0:n[l.f[1]])},i=(e=[])=>{let[t,n]=[-1,-1];return e.forEach((e,o)=>{var s;n=null===(s=null==e?void 0:e.matchExpressions)||void 0===s?void 0:s.findIndex(e=>e.key===l.d&&e.operator===l.e),-1!==n&&(t=o)}),[t,n]},c=e=>e.map(e=>{var t,n;return null===(n=null===(t=e.metadata)||void 0===t?void 0:t.labels)||void 0===n?void 0:n["kubernetes.io/hostname"]})},7552:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const o={kind:n(10).NodeModel.kind,namespaced:!1,isList:!0}},7553:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(0),l=n(966),s=n(19),a=n(7),i=n(5),c=n(983);const r=({errorMessage:e,inProgress:t,disableNext:n,cancelUrl:r})=>{const{t:d}=Object(a.useTranslation)();return o.createElement(i.g,{errorMessage:e,inProgress:t},o.createElement(l.a,null,o.createElement(s.a,{type:"submit",variant:"primary",isDisabled:n},d("lso-plugin~Create")),o.createElement(s.a,{type:"button",variant:"secondary",onClick:()=>c.b.push(r)},d("lso-plugin~Cancel"))))}},7554:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var o=n(0),l=n(72),s=n(54),a=n(18),i=n(107),c=n(7),r=n(40),d=n(5),u=n(15),m=n(2303),v=n(6257);n(7555);const p=[a("pf-v5-u-w-40-on-sm"),a("pf-m-hidden","pf-m-visible-on-sm","pf-v5-u-w-10-on-sm"),a("pf-m-hidden","pf-m-visible-on-sm","pf-v5-u-w-10-on-sm"),a("pf-m-hidden","pf-m-visible-on-sm","pf-v5-u-w-10-on-sm"),a("pf-m-hidden","pf-m-visible-on-sm","pf-v5-u-w-10-on-sm")],f=e=>{const{t:t}=Object(c.useTranslation)(),[n,a]=o.useState(new Set),{hasOnSelect:f,onRowSelected:b}=e.customData,{onSelect:h,selectedRows:g,updateSelectedRows:S}=Object(m.a)(e.data,n,b);return o.createElement(o.Fragment,null,o.createElement("div",{className:"lso-node-selection-table__table--scroll"},o.createElement(r.j,Object.assign({},e,{"aria-label":t("lso-plugin~Select nodes for creating volume filter"),"data-test-id":"create-lvs-form-node-selection-table",Header:()=>[{title:t("lso-plugin~Name"),sortField:"metadata.name",transforms:[s.a],props:{className:p[0]}},{title:t("lso-plugin~Role"),props:{className:p[1]}},{title:t("lso-plugin~CPU"),props:{className:p[2]}},{title:t("lso-plugin~Memory"),props:{className:p[3]}},{title:t("lso-plugin~Zone"),props:{className:p[4]}}],Rows:e=>(({componentProps:e,customData:t},n,l,s,a)=>{const{data:c}=e,{filteredNodes:r,preSelectedNodes:m,taintsFilter:p}=t;let f=c;f=(null==r?void 0:r.length)?c.filter(e=>r.includes(Object(u.dd)(e))):f.filter(e=>Object(v.d)(e)||p&&p(e));const b=f.map(e=>{var t,n,l;const a=Object(u.hd)(e),i=Object(u.fd)(e),c=Object(u.md)(e).sort();return{cells:[{title:o.createElement(d.hb,{kind:"Node",name:Object(u.dd)(e),title:Object(u.dd)(e)})},{title:null!==(t=c.join(", "))&&void 0!==t?t:"-"},{title:""+(Object(d.Yb)(a).string||"-")},{title:null!==(n=Object(d.Wb)(Object(d.Ib)(i)).string)&&void 0!==n?n:"-"},{title:null!==(l=Object(v.c)(e))&&void 0!==l?l:"-"}],selected:s.has(e.metadata.uid),props:{id:e.metadata.uid}}}),h=new Set(f.map(e=>e.metadata.uid));if(!i.a(h,n)&&(l(h),(null==m?void 0:m.length)&&!(null==s?void 0:s.size)&&f.length)){a(f.filter(e=>m.includes(Object(u.dd)(e))))}return b})(e,n,a,g,S),customData:e.customData,onSelect:f&&h,virtualize:!1}))),f&&o.createElement(l.a,{"data-test-id":"create-lvs-form-selected-nodes",component:"h6"},t("lso-plugin~{{nodeCount, number}} node",{nodeCount:null==g?void 0:g.size,count:null==g?void 0:g.size})," ",t("lso-plugin~selected")))}},7555:function(e,t,n){},7556:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return d}));var o=n(22),l=n(8),s=n(6257),a=n(6095),i=n(788),c=function(e,t,n,o){return new(n||(n=Promise))((function(l,s){function a(e){try{c(o.next(e))}catch(e){s(e)}}function i(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,i)}c((o=o.apply(e,t||[])).next())}))};const r=(e,t,n)=>c(void 0,void 0,void 0,(function*(){var o,c,r,d,u,m,v,p;const f=yield Object(l.kb)(i.LocalVolumeDiscovery,a.a,t),b=null===(c=null===(o=null==f?void 0:f.spec)||void 0===o?void 0:o.nodeSelector)||void 0===c?void 0:c.nodeSelectorTerms,[h,g]=Object(s.a)(b);if(-1===h||-1===g)throw new Error('Could not find matchExpression of type key: "kubernetes.io/hostname" and operator: "In"');{const t=new Set(null===(p=null===(v=null===(m=null===(u=null===(d=null===(r=null==f?void 0:f.spec)||void 0===r?void 0:r.nodeSelector)||void 0===d?void 0:d.nodeSelectorTerms)||void 0===u?void 0:u[h])||void 0===m?void 0:m.matchExpressions)||void 0===v?void 0:v[g])||void 0===p?void 0:p.values);e.forEach(e=>t.add(e));const o=[{op:"replace",path:`/spec/nodeSelector/nodeSelectorTerms/${h}/matchExpressions/${g}/values`,value:[...t]}];yield Object(l.pb)(i.LocalVolumeDiscovery,f,o),n("")}})),d=(e,t,n)=>c(void 0,void 0,void 0,(function*(){const s=((e,t,n)=>{const s={apiVersion:Object(l.n)(i.LocalVolumeDiscovery),kind:i.LocalVolumeDiscovery.kind,metadata:{name:a.a,namespace:t},spec:{nodeSelector:{nodeSelectorTerms:[{matchExpressions:[{key:a.d,operator:a.e,values:e}]}]}}};return o.a(n)||(s.spec.tolerations=[n]),s})(e,t,n);yield Object(l.jb)(i.LocalVolumeDiscovery,s)}))}}]);
//# sourceMappingURL=lso-create-local-volume-discovery-chunk-afd796a84d97195569ae.min.js.map