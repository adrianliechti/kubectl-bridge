(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{5475:function(e,a,t){"use strict";t.r(a),t.d(a,"configureNamespacePullSecretModal",(function(){return v}));var l=t(1123),s=t(0),c=t(21),r=t(320),n=t(80),m=t(866),i=t(965),o=t(7),d=t(15),p=t(8),u=t(10),h=t(118),b=t(5);class f extends b.bb{constructor(e){super(e),this._submit=this._submit.bind(this),this._cancel=this.props.cancel.bind(this),this._onMethodChange=this._onMethodChange.bind(this),this._onFileChange=this._onFileChange.bind(this),this.state=Object.assign(this.state,{method:"form",fileData:null,invalidJson:!1})}_onMethodChange(e){this.setState({method:e.target.value})}_onFileChange(e){this.setState({invalidJson:!1,fileData:null});const a=e.target.files[0];if(!a||"application/json"!==a.type)return void this.setState({invalidJson:!0});const t=new FileReader;t.onload=e=>{const a=e.target.result;try{JSON.parse(a)}catch(e){return void this.setState({invalidJson:!0})}this.setState({fileData:a})},t.readAsText(a,"UTF-8")}_submit(e){e.preventDefault();const{namespace:a}=this.props;let t;if("upload"===this.state.method)t=r.Base64.encode(this.state.fileData);else{const a=e.target.elements;t=(e=>{const a={auths:{}},t=[];return l.a(e.username).length>=1&&t.push(e.username),t.push(e.password),a.auths[e.address]={auth:r.Base64.encode(t.join(":")),email:e.email},r.Base64.encode(JSON.stringify(a))})({username:a["namespace-pull-secret-username"].value,password:a["namespace-pull-secret-password"].value,email:a["namespace-pull-secret-email"].value||"",address:a["namespace-pull-secret-address"].value})}const s={},c=e.target.elements["namespace-pull-secret-name"].value;s[d.w.PULL_SECRET_DATA]=t;const n={metadata:{name:c,namespace:a.metadata.name},data:s,type:d.w.PULL_SECRET_TYPE},m=[{op:"add",path:"/imagePullSecrets/-",value:{name:c}}],i=Object(p.jb)(u.SecretModel,n).then(()=>Object(p.qb)(u.ServiceAccountModel,"default",a.metadata.name,m));this.handlePromise(i).then(this.props.close)}render(){const{namespace:e,t:a}=this.props;return s.createElement("form",{onSubmit:this._submit,name:"form",className:"modal-content"},s.createElement(h.d,null,a("public~Default pull Secret")),s.createElement(h.a,null,s.createElement("p",null,a("public~Specify default credentials to be used to authenticate and download containers within this namespace. These credentials will be the default unless a pod references a specific pull Secret.")),s.createElement("div",{className:"row co-m-form-row"},s.createElement("div",{className:"col-xs-3"},s.createElement("label",null,a("public~Namespace"))),s.createElement("div",{className:"col-xs-9"},s.createElement(b.fb,{kind:"Namespace"})," Â ",e.metadata.name)),s.createElement("div",{className:"row co-m-form-row"},s.createElement("div",{className:"col-xs-3"},s.createElement("label",{htmlFor:"namespace-pull-secret-name"},a("public~Secret name"))),s.createElement("div",{className:"col-xs-9"},s.createElement("input",{type:"text",className:"pf-v5-c-form-control",id:"namespace-pull-secret-name","aria-describedby":"namespace-pull-secret-name-help",required:!0}),s.createElement("p",{className:"help-block text-muted",id:"namespace-pull-secret-name-help"},a("public~Friendly name to help you manage this in the future")))),s.createElement("div",{className:"row co-m-form-row form-group"},s.createElement("div",{className:"col-xs-3"},s.createElement("label",null,a("public~Method"))),s.createElement("div",{className:"col-xs-9"},s.createElement("div",{className:"radio"},s.createElement("label",{className:"control-label"},s.createElement("input",{type:"radio",id:"namespace-pull-secret-method--form",checked:"form"===this.state.method,onChange:this._onMethodChange,value:"form"}),a("public~Enter username/password"))),s.createElement("div",{className:"radio"},s.createElement("label",{className:"control-label"},s.createElement("input",{type:"radio",checked:"upload"===this.state.method,onChange:this._onMethodChange,id:"namespace-pull-secret-method--upload",value:"upload"}),a("public~Upload Docker config.json"))))),"form"===this.state.method&&s.createElement("div",null,s.createElement("div",{className:"row co-m-form-row"},s.createElement("div",{className:"col-xs-3"},s.createElement("label",{htmlFor:"namespace-pull-secret-address"},a("public~Registry address"))),s.createElement("div",{className:"col-xs-9"},s.createElement("input",{type:"text",className:"pf-v5-c-form-control",id:"namespace-pull-secret-address",placeholder:a("public~quay.io"),required:!0}))),s.createElement("div",{className:"row co-m-form-row"},s.createElement("div",{className:"col-xs-3"},s.createElement("label",{htmlFor:"namespace-pull-secret-email"},a("public~Email address"))),s.createElement("div",{className:"col-xs-9"},s.createElement("input",{type:"email",className:"pf-v5-c-form-control",id:"namespace-pull-secret-email","aria-describedby":"namespace-pull-secret-email-help"}),s.createElement("p",{className:"help-block text-muted",id:"namespace-pull-secret-email-help"},a("public~Optional, depending on registry provider")))),s.createElement("div",{className:"row co-m-form-row"},s.createElement("div",{className:"col-xs-3"},s.createElement("label",{htmlFor:"namespace-pull-secret-username"},a("public~Username"))),s.createElement("div",{className:"col-xs-9"},s.createElement("input",{type:"text",className:"pf-v5-c-form-control",id:"namespace-pull-secret-username",required:!0}))),s.createElement("div",{className:"row co-m-form-row"},s.createElement("div",{className:"col-xs-3"},s.createElement("label",{htmlFor:"namespace-pull-secret-password"},a("public~Password"))),s.createElement("div",{className:"col-xs-9"},s.createElement("input",{type:"password",className:"pf-v5-c-form-control",id:"namespace-pull-secret-password",required:!0})))),"upload"===this.state.method&&s.createElement("div",null,s.createElement("div",{className:"row co-m-form-row"},s.createElement("div",{className:"col-xs-3"},s.createElement("label",{htmlFor:"namespace-pull-secret-file"},a("public~File upload"))),s.createElement("div",{className:"col-xs-9"},s.createElement("input",{type:"file",id:"namespace-pull-secret-file",onChange:this._onFileChange,"aria-describedby":"namespace-pull-secret-file-help"}),s.createElement("p",{className:"help-block etext-muted",id:"namespace-pull-secret-file-help"},a("public~Properly configured Docker config file in JSON format. Will be base64 encoded after upload.")))),this.state.invalidJson&&s.createElement("div",{className:"row co-m-form-row"},s.createElement("div",{className:"col-xs-9 col-sm-offset-3"},s.createElement(n.a,{isInline:!0,className:"co-alert",variant:"danger",title:a("public~Invalid JSON")},a("public~The uploaded file is not properly-formatted JSON.")))),this.state.fileData&&s.createElement("div",{className:"row co-m-form-row"},s.createElement("div",{className:"col-xs-9 col-sm-offset-3"},s.createElement(m.a,null,s.createElement(i.a,null,this.state.fileData)))))),s.createElement(h.c,{errorMessage:this.state.errorMessage,inProgress:this.state.inProgress,submitText:a("public~Save"),cancel:this._cancel,submitDisabled:"upload"===this.state.method&&(!this.state.fileData||this.state.invalidJson)}))}}const E=Object(o.withTranslation)()(f),v=Object(h.f)(E);E.propTypes={namespace:c.object.isRequired,pullSecret:c.object}}}]);
//# sourceMappingURL=configure-ns-pull-secret-modal-chunk-b9ae4abb7a67585d69a5.min.js.map