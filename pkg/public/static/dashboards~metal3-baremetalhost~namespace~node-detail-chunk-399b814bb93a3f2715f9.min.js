(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{5670:function(e,n,t){"use strict";t.d(n,"a",(function(){return u}));var o=t(0),a=t(31),r=t(499),s=t(327),l=t(517),_=t(5);const c=e=>({watchURL:(n,t)=>e(Object(l.g)(n,t)),stopWatchURL:n=>e(Object(l.e)(n)),watchPrometheusQuery:(n,t,o)=>e(Object(l.f)(n,t,o)),stopWatchPrometheusQuery:(n,t)=>e(Object(l.d)(n,t))}),i=e=>({[s.a.URL]:e.dashboards.get(s.a.URL),[s.a.PROMETHEUS]:e.dashboards.get(s.a.PROMETHEUS),notificationAlerts:e.observe.get("notificationAlerts")}),u=e=>Object(a.connect)(i,c)(class extends o.Component{constructor(e){super(e),this.urls=[],this.queries=[],this.watchingAlerts=!1,this.watchURL=(e,n)=>{this.urls.push(e),this.props.watchURL(e,n)},this.watchPrometheus=(e,n,t)=>{this.queries.push(Object(l.c)(e,t)),this.props.watchPrometheusQuery(e,n,t)},this.stopWatchPrometheusQuery=(e,n)=>{const t=Object(l.c)(e,n);this.queries=this.queries.filter(e=>e!==t),this.props.stopWatchPrometheusQuery(e,n)},this.watchAlerts=()=>{this.watchingAlerts=!0},this.stopWatchAlerts=()=>{this.watchingAlerts=!1},this.watchK8sResource=e=>{this.setState(n=>({k8sResources:[...n.k8sResources,Object.assign(Object.assign({},e),{optional:!0})]}))},this.stopWatchK8sResource=e=>{this.setState(n=>({k8sResources:n.k8sResources.filter(n=>n.prop!==e.prop)}))},this.getExternalProps=e=>r.a(e,"watchURL","stopWatchURL","watchPrometheusQuery","stopWatchPrometheusQuery","watchAlerts","stopWatchAlerts",s.a.URL,s.a.PROMETHEUS,"notificationAlerts"),this.state={k8sResources:[]}}shouldComponentUpdate(e,n){var t,o,a,r,l,_;const c=this.urls.some(n=>this.props[s.a.URL].getIn([n,"data"])!==e[s.a.URL].getIn([n,"data"])||this.props[s.a.URL].getIn([n,"loadError"])!==e[s.a.URL].getIn([n,"loadError"])),i=this.queries.some(n=>this.props[s.a.PROMETHEUS].getIn([n,"data"])!==e[s.a.PROMETHEUS].getIn([n,"data"])||this.props[s.a.PROMETHEUS].getIn([n,"loadError"])!==e[s.a.PROMETHEUS].getIn([n,"loadError"])),u=(null===(o=null===(t=this.props)||void 0===t?void 0:t.notificationAlerts)||void 0===o?void 0:o.data)!==(null===(a=null==e?void 0:e.notificationAlerts)||void 0===a?void 0:a.data)||(null===(l=null===(r=this.props)||void 0===r?void 0:r.notificationAlerts)||void 0===l?void 0:l.loadError)!==(null===(_=null==e?void 0:e.notificationAlerts)||void 0===_?void 0:_.loadError),d=this.state.k8sResources!==n.k8sResources,m=this.getExternalProps(e),p=this.getExternalProps(this.props);return c||i||d||this.watchingAlerts&&u||Object.keys(m).length!==Object.keys(p).length||Object.keys(m).some(e=>m[e]!==p[e])}render(){return o.createElement(_.C,{resources:this.state.k8sResources},o.createElement(e,Object.assign({watchURL:this.watchURL,stopWatchURL:this.props.stopWatchURL,watchPrometheus:this.watchPrometheus,stopWatchPrometheusQuery:this.stopWatchPrometheusQuery,watchAlerts:this.watchAlerts,stopWatchAlerts:this.stopWatchAlerts,urlResults:this.props[s.a.URL],prometheusResults:this.props[s.a.PROMETHEUS],notificationAlerts:this.props.notificationAlerts,watchK8sResource:this.watchK8sResource,stopWatchK8sResource:this.stopWatchK8sResource},this.getExternalProps(this.props))))}})},5735:function(e,n,t){"use strict";t.d(n,"a",(function(){return S}));var o=t(0),a=t(353),r=t(19),s=t(7),l=t(14),_=t(13),c=t(517),i=t(5670),u=t(1406),d=t(5),m=t(980),p=t(108),O=t(8),T=t(15),E=t(30),b=t(119),y=t(2229);t(5828);const R=o.memo(({current:e,title:n,humanize:t,consumers:l,namespace:_,position:c=a.b.top,description:i,children:u})=>{const{t:d}=Object(s.useTranslation)(),[m,p]=o.useState(!1),O=o.useCallback(()=>p(!0),[]),T=o.useCallback(()=>p(!1),[]);return e?o.createElement(a.a,{position:c,headerContent:d("console-shared~{{title}} breakdown",{title:n}),bodyContent:o.createElement(N,{humanize:t,consumers:l,namespace:_,isOpen:m,description:i},u),enableFlip:!0,onShow:O,onHide:T,maxWidth:"21rem"},o.createElement(r.a,{variant:"link",isInline:!0},e)):null});n.b=R;const h=e=>{switch(e){case _.m.ERROR:return o.createElement(b.h,null);case _.m.WARN:return o.createElement(b.m,null);default:return null}},S=({limitState:e,requestedState:n,total:t,limit:a,current:r,available:l,requested:c})=>{const{t:i}=Object(s.useTranslation)();return(!!e&&e!==_.m.OK||!!n&&n!==_.m.OK)&&o.createElement("ul",{className:"co-utilization-card-popover__consumer-list"},o.createElement(y.default,{value:t},i("console-shared~Total capacity")),o.createElement(y.default,{value:a,icon:h(e)},i("console-shared~Total limit")),o.createElement(y.default,{value:r},i("console-shared~Current utilization")),o.createElement(y.default,{value:l},i("console-shared~Current available capacity")),o.createElement(y.default,{value:c,icon:h(n)},i("console-shared~Total requested")))},N=Object(i.a)(o.memo(({humanize:e,consumers:n,namespace:t,watchPrometheus:a,stopWatchPrometheusQuery:r,prometheusResults:i,isOpen:b,description:y,children:R})=>{const{t:h}=Object(s.useTranslation)(),[S,N]=o.useState(n[0]),I=Object(_.jc)()[0],Y=Object(T.Fe)(E.A.CAN_GET_NS)&&!!window.SERVER_FLAGS.prometheusBaseURL,{query:U,model:f,metric:g,fieldSelector:k}=S,B=o.useMemo(()=>b?((e,n,t)=>({isList:!0,kind:e.crd?Object(O.Hb)(e):e.kind,fieldSelector:t,namespace:n}))(f,t,k):null,[k,b,f,t]),[v,C,A]=Object(p.a)(B);o.useEffect(()=>b?(a(U,t),()=>{r(U)}):()=>{},[U,r,a,t,b]);const D=[],[M,L]=Object(c.b)(i,U),W=Object(u.a)(M,g);if(B&&C&&!A)for(const n of W){if(v.some(e=>Object(T.dd)(e)===n.metric[g]&&(!f.namespaced||Object(T.ed)(e)===n.metric.namespace))&&D.push(Object.assign(Object.assign({},n),{y:e(n.y).string})),5===D.length)break}const j=o.useMemo(()=>{const e=new URLSearchParams;return e.set("query0",S.query),e},[S.query]),w=o.useMemo(()=>n.reduce((e,n)=>(e[Object(O.Hb)(n.model)]=h("console-shared~By {{label}}",{label:n.model.labelKey?h(n.model.labelKey):n.model.label}),e),{}),[n,h]),z=o.useCallback(e=>N(n.find(n=>Object(O.Hb)(n.model)===e)),[n]),K=Y&&"admin"===I?"/monitoring/query-browser?"+j.toString():`/dev-monitoring/ns/${t}/metrics?${j.toString()}`;let x;return x=L||A?o.createElement("div",{className:"text-secondary"},h("console-shared~Not available")):C&&M?o.createElement(o.Fragment,null,o.createElement("ul",{className:"co-utilization-card-popover__consumer-list","aria-label":h("console-shared~Top consumer by {{label}}",{label:f.label})},D&&D.map(e=>{const n=String(e.x);return o.createElement(P,{key:n,value:e.y},o.createElement(l.Link,{className:"co-utilization-card-popover__consumer-name",to:Object(d.uc)(f,n,e.metric.namespace)},n))})),o.createElement(l.Link,{to:K},h("console-shared~View more"))):o.createElement("ul",{className:"co-utilization-card-popover__consumer-list"},o.createElement("li",{className:"skeleton-consumer"}),o.createElement("li",{className:"skeleton-consumer"}),o.createElement("li",{className:"skeleton-consumer"}),o.createElement("li",{className:"skeleton-consumer"}),o.createElement("li",{className:"skeleton-consumer"})),o.createElement("div",{className:"co-utilization-card-popover__body"},y&&o.createElement("div",{className:"co-utilization-card-popover__description"},y),R,o.createElement("div",{className:"co-utilization-card-popover__title"},1===n.length?h("console-shared~Top {{label}} consumers",{label:S.model.label.toLowerCase()}):h("console-shared~Top consumers")),n.length>1&&o.createElement(m.b,{className:"co-utilization-card-popover__dropdown",id:"consumer-select",name:"selectConsumerType","aria-label":h("console-shared~Select consumer type"),items:w,onChange:z,selectedKey:Object(O.Hb)(f)}),x)})),P=({children:e,value:n})=>o.createElement("li",{className:"co-utilization-card-popover__consumer-item"},e,o.createElement("div",{className:"co-utilization-card-popover__consumer-value"},n))},5745:function(e,n,t){"use strict";t.d(n,"a",(function(){return o})),t.d(n,"b",(function(){return l})),t.d(n,"c",(function(){return _})),t.d(n,"d",(function(){return c}));var o,a=t(550);!function(e){e.MEMORY_TOTAL="MEMORY_TOTAL",e.MEMORY_UTILIZATION="MEMORY_UTILIZATION",e.MEMORY_REQUESTS="MEMORY_REQUESTS",e.NETWORK_UTILIZATION="NETWORK_UTILIZATION",e.NETWORK_IN_UTILIZATION="NETWORK_IN_UTILIZATION",e.NETWORK_OUT_UTILIZATION="NETWORK_OUT_UTILIZATION",e.CPU_UTILIZATION="CPU_UTILIZATION",e.CPU_TOTAL="CPU_TOTAL",e.CPU_REQUESTS="CPU_REQUESTS",e.STORAGE_UTILIZATION="STORAGE_UTILIZATION",e.STORAGE_TOTAL="STORAGE_TOTAL",e.PODS_BY_CPU="PODS_BY_CPU",e.PODS_BY_MEMORY="PODS_BY_MEMORY",e.PODS_BY_STORAGE="PODS_BY_STORAGE",e.PODS_BY_NETWORK_IN="PODS_BY_NETWORK_IN",e.PODS_BY_NETWORK_OUT="PODS_BY_NETWORK_OUT",e.NODES_BY_CPU="NODES_BY_CPU",e.NODES_BY_MEMORY="NODES_BY_MEMORY",e.NODES_BY_STORAGE="NODES_BY_STORAGE",e.NODES_BY_NETWORK_IN="NODES_BY_NETWORK_IN",e.NODES_BY_NETWORK_OUT="NODES_BY_NETWORK_OUT",e.NODES_BY_PODS="NODES_BY_PODS",e.PROJECTS_BY_CPU="PROJECTS_BY_CPU",e.PROJECTS_BY_MEMORY="PROJECTS_BY_MEMORY",e.PROJECTS_BY_STORAGE="PROJECTS_BY_STORAGE",e.PROJECTS_BY_NETWORK_IN="PROJECTS_BY_NETWORK_IN",e.PROJECTS_BY_NETWORK_OUT="PROJECTS_BY_NETWORK_OUT",e.PROJECTS_BY_PODS="PROJECTS_BY_PODS",e.POD_UTILIZATION="POD_UTILIZATION"}(o||(o={}));const r={[o.PODS_BY_CPU]:a.a('\n      topk(25, sort_desc(\n        (\n          sum(avg_over_time(pod:container_cpu_usage:sum{container="",pod!=""}[5m])) BY (pod, namespace)\n          *\n          on(pod,namespace) group_left(node) (node_namespace_pod:kube_pod_info:)\n        )\n        *\n        on(node) group_left(role) (max by (node) (kube_node_role{role=~"<%= nodeType %>"}))\n      ))\n    '),[o.PODS_BY_MEMORY]:a.a('\n      topk(25, sort_desc(\n        (\n          sum(avg_over_time(container_memory_working_set_bytes{container="",pod!=""}[5m])) BY (pod, namespace)\n          *\n          on(pod,namespace) group_left(node) (node_namespace_pod:kube_pod_info:)\n        )\n        *\n        on(node) group_left(role) (max by (node) (kube_node_role{role=~"<%= nodeType %>"}))\n      ))\n    '),[o.PODS_BY_STORAGE]:a.a('\n      topk(25, sort_desc(\n        (\n          sum(avg_over_time(pod:container_fs_usage_bytes:sum{container="", pod!=""}[5m])) BY (pod, namespace)\n          *\n          on(pod,namespace) group_left(node) (node_namespace_pod:kube_pod_info:)\n        )\n        *\n        on(node) group_left(role) (max by (node) (kube_node_role{role=~"<%= nodeType %>"}))\n      ))\n    '),[o.PODS_BY_NETWORK_IN]:a.a('\n      topk(25, sort_desc(\n        (\n          sum(rate(container_network_receive_bytes_total{ container="POD", pod!= ""}[5m])) BY (namespace, pod)\n          *\n          on(pod,namespace) group_left(node) (node_namespace_pod:kube_pod_info:)\n        )\n        *\n        on(node) group_left(role) (max by (node) (kube_node_role{role=~"<%= nodeType %>"}))\n      ))\n    '),[o.PODS_BY_NETWORK_OUT]:a.a('\n      topk(25, sort_desc(\n        (\n          sum(rate(container_network_transmit_bytes_total{ container="POD", pod!= ""}[5m])) BY (namespace, pod)\n          *\n          on(pod,namespace) group_left(node) (node_namespace_pod:kube_pod_info:)\n        )\n        *\n        on(node) group_left(role) (max by (node) (kube_node_role{role=~"<%= nodeType %>"}))\n      ))\n    '),[o.NODES_BY_CPU]:a.a('\n      topk(25, sort_desc(\n        avg_over_time(instance:node_cpu:rate:sum[5m])\n        *\n        on(instance) group_left(role) (\n          label_replace(max by (node) (kube_node_role{role=~"<%= nodeType %>"}), "instance", "$1", "node", "(.*)")\n        )\n      ))\n    '),[o.NODES_BY_MEMORY]:a.a('\n      topk(25, sort_desc(\n        (node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes)\n        *\n        on(instance) group_left(role) (\n          label_replace(max by (node) (kube_node_role{role=~"<%= nodeType %>"}), "instance", "$1", "node", "(.*)")\n        )\n      ))\n    '),[o.NODES_BY_STORAGE]:a.a('\n      topk(25, sort_desc(\n        (\n          sum by (instance) (max by (device, instance) (node_filesystem_size_bytes{device=~"/.*"}))\n          -\n          sum by (instance) (max by (device, instance) (node_filesystem_avail_bytes{device=~"/.*"}))\n        )\n        *\n        on(instance) group_left(role) (\n          label_replace(max by (node) (kube_node_role{role=~"<%= nodeType %>"}), "instance", "$1", "node", "(.*)")\n        )\n      ))\n    '),[o.NODES_BY_PODS]:a.a('\n      topk(25, sort_desc(\n        sum(avg_over_time(kubelet_running_pods[5m])) BY (node)\n        *\n        on(node) group_left(role) (max by (node) (kube_node_role{role=~"<%= nodeType %>"}))\n      ))\n    '),[o.NODES_BY_NETWORK_IN]:a.a('\n      topk(25, sort_desc(\n        sum(instance:node_network_receive_bytes_excluding_lo:rate1m) BY (instance)\n        *\n        on(instance) group_left(role) (\n          label_replace(max by (node) (kube_node_role{role=~"<%= nodeType %>"}), "instance", "$1", "node", "(.*)")\n        )\n      ))\n    '),[o.NODES_BY_NETWORK_OUT]:a.a('\n      topk(25, sort_desc(\n        sum(instance:node_network_transmit_bytes_excluding_lo:rate1m) BY (instance)\n        *\n        on(instance) group_left(role) (\n          label_replace(max by (node) (kube_node_role{role=~"<%= nodeType %>"}), "instance", "$1", "node", "(.*)")\n        )\n      ))\n    '),[o.PROJECTS_BY_CPU]:a.a('\n      topk(25, sort_desc(\n        sum by (namespace) (\n          (\n            sum(avg_over_time(pod:container_cpu_usage:sum{container="",pod!=""}[5m])) BY (namespace, pod)\n            *\n            on(pod,namespace) group_left(node) (node_namespace_pod:kube_pod_info:)\n          )\n          *\n          on(node) group_left(role) (max by (node) (kube_node_role{role=~"<%= nodeType %>"}))\n        )\n      ))\n    '),[o.PROJECTS_BY_MEMORY]:a.a('\n      topk(25, sort_desc(\n        sum by (namespace) (\n          (\n            sum(avg_over_time(container_memory_working_set_bytes{container="",pod!=""}[5m])) BY (namespace, pod)\n            *\n            on(pod,namespace) group_left(node) (node_namespace_pod:kube_pod_info:)\n          )\n          *\n          on(node) group_left(role) (max by (node) (kube_node_role{role=~"<%= nodeType %>"}))\n        )\n      ))\n    '),[o.PROJECTS_BY_STORAGE]:a.a('\n      topk(25, sort_desc(\n        sum by (namespace) (\n          (\n            sum(avg_over_time(pod:container_fs_usage_bytes:sum{container="", pod!=""}[5m])) BY (namespace, pod)\n            *\n            on(pod,namespace) group_left(node) (node_namespace_pod:kube_pod_info:)\n          )\n          *\n          on(node) group_left(role) (max by (node) (kube_node_role{role=~"<%= nodeType %>"}))\n        )\n      ))\n    '),[o.PROJECTS_BY_PODS]:a.a('\n      topk(25, sort_desc(\n        count by (namespace) (\n            topk without(uid) (1, kube_running_pod_ready)\n            *\n            ignoring(node,uid) group_right node_namespace_pod:kube_pod_info:\n          *\n          on(node) group_left() (max by (node) (kube_node_role{role=~"<%= nodeType %>"})))\n        ))\n    '),[o.PROJECTS_BY_NETWORK_IN]:a.a('\n      topk(25, sort_desc(\n        sum by (namespace) (\n          (\n            sum(rate(container_network_receive_bytes_total{ container="POD", pod!= ""}[5m])) BY (namespace, pod)\n            *\n            on(pod,namespace) group_left(node) (node_namespace_pod:kube_pod_info:)\n          )\n          *\n          on(node) group_left(role) (max by (node) (kube_node_role{role=~"<%= nodeType %>"}))\n        )\n      ))\n    '),[o.PROJECTS_BY_NETWORK_OUT]:a.a('\n      topk(25, sort_desc(\n        sum by (namespace) (\n          (\n            sum(rate(container_network_transmit_bytes_total{ container="POD", pod!= ""}[5m])) BY (namespace, pod)\n            *\n            on(pod,namespace) group_left(node) (node_namespace_pod:kube_pod_info:)\n          )\n          *\n          on(node) group_left(role) (max by (node) (kube_node_role{role=~"<%= nodeType %>"}))\n        )\n      ))\n    ')},s={[o.MEMORY_TOTAL]:a.a('\n      sum(\n        node_memory_MemTotal_bytes\n        *\n        on(instance) group_left(role) (\n          label_replace(max by (node) (kube_node_role{role=~"<%= nodeType %>"}), "instance", "$1", "node", "(.*)")\n        )\n      )\n    '),[o.MEMORY_UTILIZATION]:a.a('\n      sum(\n        (node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes)\n        *\n        on(instance) group_left(role) (\n          label_replace(max by (node) (kube_node_role{role=~"<%= nodeType %>"}), "instance", "$1", "node", "(.*)")\n        )\n      )\n    '),[o.MEMORY_REQUESTS]:a.a('\n      sum(\n        kube_pod_resource_request{resource="memory"}\n        *\n        on(node) group_left(role) (\n          max by (node) (kube_node_role{role=~"<%= nodeType %>"})\n        )\n      )\n    '),[o.NETWORK_UTILIZATION]:a.a('\n      sum(\n        (\n          instance:node_network_transmit_bytes_excluding_lo:rate1m\n          +\n          instance:node_network_receive_bytes_excluding_lo:rate1m\n        )\n        *\n        on(instance) group_left(role) (\n          label_replace(max by (node) (kube_node_role{role=~"<%= nodeType %>"}), "instance", "$1", "node", "(.*)")\n        )\n      )\n    '),[o.CPU_UTILIZATION]:a.a('\n      sum(\n        1 - sum without (mode) (rate(node_cpu_seconds_total{mode=~"idle|iowait|steal"}[2m]))\n        *\n        on(instance) group_left() (\n          label_replace(max by (node) (kube_node_role{role=~"<%= nodeType %>"}), "instance", "$1", "node","(.*)")\n        )\n      )\n    '),[o.CPU_TOTAL]:a.a('\n      sum(\n        kube_node_status_capacity{resource="cpu",unit="core"}\n        *\n        on(node) group_left(role) (\n          max by (node) (kube_node_role{role=~"<%= nodeType %>"})\n        )\n      )\n    '),[o.CPU_REQUESTS]:a.a('\n      sum(\n        kube_pod_resource_request{resource="cpu"}\n        *\n        on(node) group_left(role) (\n          max by (node) (kube_node_role{role=~"<%= nodeType %>"})\n        )\n      )\n    '),[o.STORAGE_UTILIZATION]:a.a('\n      sum(\n        (\n          max by (device, instance) (node_filesystem_size_bytes{device=~"/.*"})\n          -\n          max by (device, instance) (node_filesystem_free_bytes{device=~"/.*"})\n        )\n        *\n        on(instance) group_left(role) (\n          label_replace(max by (node) (kube_node_role{role=~"<%= nodeType %>"}), "instance", "$1", "node", "(.*)")\n        )\n      )\n    '),[o.STORAGE_TOTAL]:a.a('\n      sum(\n        max by (device, instance) (node_filesystem_size_bytes{device=~"/.*"})\n        *\n        on(instance) group_left(role) (\n          label_replace(max by (node) (kube_node_role{role=~"<%= nodeType %>"}), "instance", "$1", "node", "(.*)")\n        )\n      )\n    '),[o.POD_UTILIZATION]:a.a('\n      count(\n        (\n          topk without(uid) (1, kube_running_pod_ready)\n          *\n          ignoring(node,uid) group_right node_namespace_pod:kube_pod_info:\n        )\n        *\n        on(node) group_left() (max by (node) (kube_node_role{role=~"<%= nodeType %>"}))\n      )\n    '),[o.NETWORK_IN_UTILIZATION]:a.a('\n      sum(\n        instance:node_network_receive_bytes_excluding_lo:rate1m\n        *\n        on(instance) group_left(role) (\n          label_replace(max by (node) (kube_node_role{role=~"<%= nodeType %>"}), "instance", "$1", "node", "(.*)")\n        )\n      )\n    '),[o.NETWORK_OUT_UTILIZATION]:a.a('\n      sum(\n        instance:node_network_transmit_bytes_excluding_lo:rate1m\n        *\n        on(instance) group_left(role) (\n          label_replace(max by (node) (kube_node_role{role=~"<%= nodeType %>"}), "instance", "$1", "node", "(.*)")\n        )\n      )\n    ')},l=e=>({[o.NETWORK_UTILIZATION]:[{query:s[o.NETWORK_IN_UTILIZATION]({nodeType:e}),desc:"in"},{query:s[o.NETWORK_OUT_UTILIZATION]({nodeType:e}),desc:"out"}]}),_=e=>({[o.PODS_BY_CPU]:r[o.PODS_BY_CPU]({nodeType:e}),[o.PODS_BY_MEMORY]:r[o.PODS_BY_MEMORY]({nodeType:e}),[o.PODS_BY_STORAGE]:r[o.PODS_BY_STORAGE]({nodeType:e}),[o.PODS_BY_NETWORK_IN]:r[o.PODS_BY_NETWORK_IN]({nodeType:e}),[o.PODS_BY_NETWORK_OUT]:r[o.PODS_BY_NETWORK_OUT]({nodeType:e}),[o.NODES_BY_CPU]:r[o.NODES_BY_CPU]({nodeType:e}),[o.NODES_BY_MEMORY]:r[o.NODES_BY_MEMORY]({nodeType:e}),[o.NODES_BY_STORAGE]:r[o.NODES_BY_STORAGE]({nodeType:e}),[o.NODES_BY_PODS]:r[o.NODES_BY_PODS]({nodeType:e}),[o.NODES_BY_NETWORK_IN]:r[o.NODES_BY_NETWORK_IN]({nodeType:e}),[o.NODES_BY_NETWORK_OUT]:r[o.NODES_BY_NETWORK_OUT]({nodeType:e}),[o.PROJECTS_BY_CPU]:r[o.PROJECTS_BY_CPU]({nodeType:e}),[o.PROJECTS_BY_MEMORY]:r[o.PROJECTS_BY_MEMORY]({nodeType:e}),[o.PROJECTS_BY_STORAGE]:r[o.PROJECTS_BY_STORAGE]({nodeType:e}),[o.PROJECTS_BY_PODS]:r[o.PROJECTS_BY_PODS]({nodeType:e}),[o.PROJECTS_BY_NETWORK_IN]:r[o.PROJECTS_BY_NETWORK_IN]({nodeType:e}),[o.PROJECTS_BY_NETWORK_OUT]:r[o.PROJECTS_BY_NETWORK_OUT]({nodeType:e})}),c=e=>({[o.CPU_UTILIZATION]:{utilization:s[o.CPU_UTILIZATION]({nodeType:e}),total:s[o.CPU_TOTAL]({nodeType:e}),requests:s[o.CPU_REQUESTS]({nodeType:e})},[o.MEMORY_UTILIZATION]:{utilization:s[o.MEMORY_UTILIZATION]({nodeType:e}),total:s[o.MEMORY_TOTAL]({nodeType:e}),requests:s[o.MEMORY_REQUESTS]({nodeType:e})},[o.STORAGE_UTILIZATION]:{utilization:s[o.STORAGE_UTILIZATION]({nodeType:e}),total:s[o.STORAGE_TOTAL]({nodeType:e})},[o.POD_UTILIZATION]:{utilization:s[o.POD_UTILIZATION]({nodeType:e})}})},5806:function(e,n,t){"use strict";t.d(n,"b",(function(){return v})),t.d(n,"a",(function(){return C})),t.d(n,"c",(function(){return D}));var o=t(0),a=t(22),r=t(7),s=t(205),l=t(165),_=t(682),c=t(354),i=t(294),u=t(192),d=t(434),m=t(516),p=t(164),O=t(295),T=t(13),E=t(4382),b=t(4365),y=t(762),R=t(5670),h=t(982),S=t(1406),N=t(5745),P=t(10),I=t(517),Y=t(108),U=t(8),f=t(4366),g=t(1200),k=t(5856);const B=[k.d,k.e],v=Object(R.a)(({watchPrometheus:e,stopWatchPrometheusQuery:n,prometheusResults:t,utilizationQuery:a,totalQuery:r,title:s,TopConsumerPopover:l,humanizeValue:_,byteDataType:c,namespace:i,isDisabled:u=!1,limitQuery:d,requestQuery:m,setLimitReqState:p})=>{let O,T,b,y,R,h,N,P,Y,U=!1;const{duration:f}=Object(g.useUtilizationDuration)();return o.useEffect(()=>{if(!u)return e(a,i,f),r&&e(r,i),d&&e(d,i,f),m&&e(m,i,f),()=>{n(a,f),r&&n(r),d&&n(d,f),m&&n(m,f)}},[e,n,f,a,r,i,u,d,m]),u||([O,T]=Object(I.b)(t,a,f),[b,y]=Object(I.b)(t,r),[h,N]=Object(I.b)(t,d,f),[P,Y]=Object(I.b)(t,m,f),R=Object(S.a)(b),U=!O||r&&!b||d&&!h),o.createElement(E.default,{title:s,utilization:O,limit:h,requested:P,error:T||y||N||Y,isLoading:U,humanizeValue:_,byteDataType:c,query:[a,d,m],max:R&&R.length?R[0].y:null,TopConsumerPopover:l,setLimitReqState:p})}),C=Object(R.a)(({watchPrometheus:e,stopWatchPrometheusQuery:n,prometheusResults:t,queries:a,title:r,TopConsumerPopovers:s,humanizeValue:l,byteDataType:_,namespace:c,isDisabled:i=!1})=>{const{duration:u}=Object(g.useUtilizationDuration)();o.useEffect(()=>{if(!i)return a.forEach(n=>e(n.query,c,u)),()=>{a.forEach(e=>n(e.query,u))}},[e,n,u,a,c,i]);const d=[];let m=!1,p=!1;return i||a.forEach(e=>{var n;const[o,a]=Object(I.b)(t,e.query,u);return a?(m=!0,!1):o?void d.push((null===(n=Object(S.b)(o,e.desc,null,E.trimSecondsXMutator))||void 0===n?void 0:n[0])||[]):(p=!0,!1)}),o.createElement(E.MultilineUtilizationItem,{title:r,data:d,error:m,isLoading:p,humanizeValue:l,byteDataType:_,queries:a,TopConsumerPopovers:s})}),A=({machineConfigPools:e,onNodeSelect:n,selectedNodes:t})=>{const{t:a}=Object(r.useTranslation)(),[u,d]=o.useState(!1),m=e.sort((e,n)=>{const t=["worker","master"],o=t.indexOf(e.metadata.name),a=t.indexOf(n.metadata.name);return-1===o&&-1===a?e.metadata.name.localeCompare(n.metadata.name):-1===o?1:-1===a?-1:o-a}).map(e=>{const n="master"===e.metadata.name?"control plane":e.metadata.name;return o.createElement(s.a,{hasCheckbox:!0,key:e.metadata.name,value:n,isSelected:t.includes(e.metadata.name)},n)});return o.createElement(c.a,{role:"menu","aria-label":a("public~Filter by Node type"),onSelect:n,isOpen:u,selected:t,onOpenChange:e=>d(e),toggle:e=>o.createElement(l.a,{ref:e,onClick:e=>d(e),variant:"plainText"},a("public~Filter by Node type"),t.length>0&&o.createElement(_.a,{className:"pf-v5-u-ml-sm",isRead:!0},t.length))},o.createElement(i.a,null,m))},D=()=>{const{t:e}=Object(r.useTranslation)(),[n,t]=Object(Y.a)({isList:!0,kind:Object(U.Hb)(P.MachineConfigPoolModel)}),[s,l]=o.useState([]),[_]=Object(T.kc)(T.Y),[c]=Object(T.kc)(T.X),i=a.a(s)?".+":s.join("|"),[E,R]=o.useMemo(()=>[Object(N.d)(i),Object(N.b)(i)],[i]);return t&&o.createElement(u.a,{"data-test-id":"utilization-card",isClickable:!0,isSelectable:!0},o.createElement(d.a,{actions:{actions:o.createElement(o.Fragment,null,o.createElement(m.a,null,o.createElement(p.a,null,o.createElement(A,{machineConfigPools:n,onNodeSelect:(e,n)=>{const t="control plane"===n?"master":n;s.includes(t)?l(s.filter(e=>e!==t)):l([...s,t])},selectedNodes:s})),o.createElement(p.a,null,o.createElement(f.UtilizationDurationDropdown,null)))),hasNoOffset:!1,className:void 0}},o.createElement(O.a,{"data-test":"utilization-card__title"},e("public~Cluster utilization"))),o.createElement(b.default,null,o.createElement(k.b.Provider,{value:i},o.createElement(v,{title:e("public~CPU"),utilizationQuery:E[N.a.CPU_UTILIZATION].utilization,totalQuery:E[N.a.CPU_UTILIZATION].total,requestQuery:E[N.a.CPU_UTILIZATION].requests,TopConsumerPopover:k.a,humanizeValue:h.h}),o.createElement(v,{title:e("public~Memory"),utilizationQuery:E[N.a.MEMORY_UTILIZATION].utilization,totalQuery:E[N.a.MEMORY_UTILIZATION].total,requestQuery:E[N.a.MEMORY_UTILIZATION].requests,TopConsumerPopover:k.c,humanizeValue:h.f,byteDataType:y.a.BinaryBytes}),o.createElement(v,{title:e("public~Filesystem"),utilizationQuery:E[N.a.STORAGE_UTILIZATION].utilization,totalQuery:E[N.a.STORAGE_UTILIZATION].total,TopConsumerPopover:k.g,humanizeValue:h.f,byteDataType:y.a.BinaryBytes}),o.createElement(C,{title:e("public~Network transfer"),queries:R[N.a.NETWORK_UTILIZATION],humanizeValue:h.j,TopConsumerPopovers:B}),o.createElement(v,{title:e("public~Pod count"),utilizationQuery:E[N.a.POD_UTILIZATION].utilization,TopConsumerPopover:k.f,humanizeValue:h.k}),_.map(({uid:e,properties:n})=>{var t,a,r;return o.createElement(v,{key:e,title:n.title,utilizationQuery:n.getUtilizationQuery(s),totalQuery:null===(t=n.getTotalQuery)||void 0===t?void 0:t.call(n,s),humanizeValue:n.humanize,TopConsumerPopover:n.TopConsumerPopover,requestQuery:null===(a=n.getRequestQuery)||void 0===a?void 0:a.call(n,s),limitQuery:null===(r=n.getLimitQuery)||void 0===r?void 0:r.call(n,s)})}),c.map(({uid:e,properties:n})=>o.createElement(C,{key:e,title:n.title,queries:n.getUtilizationQueries(s),humanizeValue:n.humanize,TopConsumerPopovers:n.TopConsumerPopovers})))))}},5828:function(e,n,t){},5856:function(e,n,t){"use strict";t.d(n,"b",(function(){return c})),t.d(n,"a",(function(){return u})),t.d(n,"c",(function(){return d})),t.d(n,"g",(function(){return m})),t.d(n,"f",(function(){return p})),t.d(n,"d",(function(){return O})),t.d(n,"e",(function(){return T}));var o=t(0),a=t(7),r=t(5745),s=t(5735),l=t(10),_=t(5);const c=o.createContext(".+"),i=(e,n,t)=>{const a=o.useContext(c);return o.useMemo(()=>{const o=Object(r.c)(a);return[{query:o[e],model:l.ProjectModel,metric:"namespace"},{query:o[n],model:l.PodModel,metric:"pod"},{query:o[t],model:l.NodeModel,metric:"instance"}]},[t,a,e,n])},u=({current:e})=>{const{t:n}=Object(a.useTranslation)(),t=i(r.a.PROJECTS_BY_CPU,r.a.PODS_BY_CPU,r.a.NODES_BY_CPU);return o.createElement(s.b,{title:n("public~CPU"),current:e,consumers:t,humanize:_.Yb})},d=({current:e})=>{const{t:n}=Object(a.useTranslation)(),t=i(r.a.PROJECTS_BY_MEMORY,r.a.PODS_BY_MEMORY,r.a.NODES_BY_MEMORY);return o.createElement(s.b,{title:n("public~Memory"),current:e,consumers:t,humanize:_.Wb})},m=({current:e})=>{const{t:n}=Object(a.useTranslation)(),t=i(r.a.PROJECTS_BY_STORAGE,r.a.PODS_BY_STORAGE,r.a.NODES_BY_STORAGE);return o.createElement(s.b,{title:n("public~Filesystem"),current:e,consumers:t,humanize:_.Wb})},p=({current:e})=>{const{t:n}=Object(a.useTranslation)(),t=o.useContext(c),i=o.useMemo(()=>{const e=Object(r.c)(t);return[{query:e[r.a.PROJECTS_BY_PODS],model:l.ProjectModel,metric:"namespace"},{query:e[r.a.NODES_BY_PODS],model:l.NodeModel,metric:"node"}]},[t]);return o.createElement(s.b,{title:n("public~Pod count"),current:e,consumers:i,humanize:_.bc})},O=({current:e})=>{const{t:n}=Object(a.useTranslation)(),t=i(r.a.PROJECTS_BY_NETWORK_IN,r.a.PODS_BY_NETWORK_IN,r.a.NODES_BY_NETWORK_IN);return o.createElement(s.b,{title:n("public~Network in"),current:e,consumers:t,humanize:_.ac})},T=({current:e})=>{const{t:n}=Object(a.useTranslation)(),t=i(r.a.PROJECTS_BY_NETWORK_OUT,r.a.PODS_BY_NETWORK_OUT,r.a.NODES_BY_NETWORK_OUT);return o.createElement(s.b,{title:n("public~Network out"),current:e,consumers:t,humanize:_.ac})}}}]);
//# sourceMappingURL=dashboards~metal3-baremetalhost~namespace~node-detail-chunk-399b814bb93a3f2715f9.min.js.map