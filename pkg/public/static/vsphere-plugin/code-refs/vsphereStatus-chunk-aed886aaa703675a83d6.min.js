(window.webpackJsonp=window.webpackJsonp||[]).push([[357],{11516:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(141),a=n(13);const o=(e,t)=>{var n;return null===(n=e.find(e=>e.metric.reason===t))||void 0===n?void 0:n.value},s=(e,t,n)=>{var s,c,i;if(!n)return{state:a.k.LOADING};if(n.loadError)return{state:a.k.WARNING,message:e("vsphere-plugin~Missing the vSphere config map.")};if(!n.loaded)return{state:a.k.LOADING};if(!n.data)return{state:a.k.WARNING,message:e("vsphere-plugin~Not configured yet")};if(t.length<1)return{state:a.k.LOADING};if(t.find(e=>e.error))return{state:a.k.ERROR,message:e("vsphere-plugin~Prometheus query failed.")};if(!(null===(s=t[0].response)||void 0===s?void 0:s.status))return{state:a.k.LOADING};const l=null===(i=null===(c=t[0].response)||void 0===c?void 0:c.data)||void 0===i?void 0:i.result;if("success"!==t[0].response.status||!l)return{state:a.k.ERROR,message:e("vsphere-plugin~Prometheus query failed.")};const u=o(l,"InvalidCredentials");if((null==u?void 0:u[0])&&Object(r.a)(null==u?void 0:u[1])>0)return{state:a.k.WARNING,message:e("vsphere-plugin~Invalid credentials")};const d=o(l,"SyncError");if(Object(r.a)(null==d?void 0:d[1]))return{state:a.k.WARNING,message:"vsphere-plugin~Synchronization failed"};const v=l.find(e=>{var t;return Object(r.a)(null===(t=e.value)||void 0===t?void 0:t[1])>0});return v?{state:a.k.WARNING,message:e("vsphere-plugin~Failing {{reason}}",{reason:v.metric.reason})}:{state:a.k.OK}}},11517:function(e,t,n){"use strict";n.d(t,"a",(function(){return R}));var r=n(0),a=n(516),o=n(164),s=n(19),c=n(80),i=n(967),l=n(406),u=n(4341),d=n(1394),v=n(264),m=n(7523),f=n(7),p=n(689),h=n(13),g=n(11518),b=n(8344),E=n(11520),O=n(11521),y=n(7522),k=n(11522),w=n(8345),j=(n(11528),function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function s(e){try{i(r.next(e))}catch(e){o(e)}}function c(e){try{i(r.throw(e))}catch(e){o(e)}}function i(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}i((r=r.apply(e,t||[])).next())}))});const C=({onClose:e,mustPatch:t})=>{const{t:n}=Object(f.useTranslation)("vsphere-plugin"),{isSubmitting:c,isValid:i,dirty:l,submitForm:u}=Object(m.c)();return r.createElement(a.a,{hasGutter:!0},r.createElement(o.a,null,r.createElement(s.a,{variant:"primary",isDisabled:c||!i||!t&&!l,onClick:u,isLoading:c},n(c?"Saving":"Save configuration"))),r.createElement(o.a,null,r.createElement(s.a,{variant:"link",onClick:e,isDisabled:c},n("Cancel"))))},S=({health:e,error:t})=>{const{t:n}=Object(f.useTranslation)("vsphere-plugin"),{isSubmitting:a}=Object(m.c)();return t?r.createElement(c.a,{isInline:!0,title:t.title,variant:c.b.danger},t.message):a||e.state!==h.k.WARNING?r.createElement(c.a,{variant:c.b.info,isInline:!0,title:n("Delayed propagation of configuration")},n("The configuration process updates operator statuses and reboots nodes. This process typically takes about an hour. Existing resources such as previously bound Persistent Volume Claims might become disconnected."),r.createElement("br",null),n("Note, that existing resources (like already bound PVCs) might get broken by these changes.")):r.createElement(c.a,{isInline:!0,title:n("vSphere Problem Detector (can be outdated)"),variant:c.b.warning},e.message)},I=/^\/.*?\/datastore\/.+/,P=/^\/.*?\/vm\/.+/,N=p.lazy(e=>p.object({vcenter:p.string().required("vCenter is required."),username:p.string().required("Username is required."),password:p.string().required("Password is required."),datacenter:p.string().required("Datacenter is required."),defaultDatastore:p.string().required("Default data store is required.").test("Correct prefix",`Must start with /${e.datacenter}/datastore/`,t=>!t||!e.datacenter||t.startsWith(`/${e.datacenter}/datastore/`)).matches(I,"Must match regex "+I),folder:p.string().required("Virtual Machine Folder is required.").test("Correct prefix",`Must start with /${e.datacenter}/vm/`,t=>!t||!e.datacenter||t.startsWith(`/${e.datacenter}/vm/`)).matches(P,"Must match regex "+P),vCenterCluster:p.string().required("vCenter cluster is required.")})),R=({health:e,hide:t,cloudProviderConfig:n})=>{Object(E.a)();const{t:a}=Object(f.useTranslation)("vsphere-plugin"),[o,s]=r.useState(!0),[p,h]=r.useState(),I=Object(b.a)(),{initValues:P,isLoaded:R,mustPatch:x,error:M}=Object(g.a)(n),D=()=>{s(!1),t()},$=e=>j(void 0,void 0,void 0,(function*(){h(void 0);try{yield Object(O.b)(a,I,e,n),D()}catch(e){e instanceof O.a?h({title:e.message,message:e.detail}):h({title:a("An error occured."),message:Object(y.c)(a,e)})}}));let G;return G=M?r.createElement(c.a,{isInline:!0,title:M.title,variant:"danger"},M.message):R?r.createElement(m.a,{initialValues:P,onSubmit:$,validationSchema:N},r.createElement(i.a,{hasGutter:!0},r.createElement(l.a,null,r.createElement(k.a,null)),r.createElement(l.a,null,r.createElement(w.a,null)),r.createElement(l.a,null,r.createElement(S,{error:p,health:e})),r.createElement(l.a,null,r.createElement(C,{onClose:D,mustPatch:x||!!p})))):r.createElement(u.a,null,r.createElement(d.a,null)),o&&r.createElement(v.a,{className:"plugin-vsphere-modal",variant:v.b.medium,position:"top",title:a("vSphere connection configuration"),isOpen:!0,showClose:!R,onClose:R?void 0:D},G)}},11518:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),a=n(7),o=n(976),s=n(7522),c=n(8344),i=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function s(e){try{i(r.next(e))}catch(e){o(e)}}function c(e){try{i(r.throw(e))}catch(e){o(e)}}function i(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}i((r=r.apply(e,t||[])).next())}))};class l extends Error{constructor(e,t){super(e),this.name="LoadError",this.detail=t}}const u=e=>{const{t:t}=Object(a.useTranslation)("vsphere-plugin"),[n,u]=r.useState(!1),[d,v]=r.useState(),{secretModel:m,infrastructureModel:f}=Object(c.a)(),[p,h]=r.useState();return r.useEffect(()=>{i(void 0,void 0,void 0,(function*(){if(!n&&e){try{const n=yield((e,t,n,r)=>i(void 0,void 0,void 0,(function*(){var a,c,i,u,d,v,m;const f=null===(a=r.data)||void 0===a?void 0:a.config;if(!f)return{values:{vcenter:"",datacenter:"",defaultDatastore:"",folder:"",username:"",password:"",vCenterCluster:""},mustPatch:!1};const p=Object(s.e)(f),h=p.server||"",g=p.datacenter||"",b=p["default-datastore"]||"",E=p.folder||"";let O="";const y=p["resourcepool-path"];if(null==y?void 0:y.length){const e=y.split("/");e.length>3&&([,,,O]=e)}let k="",w="";if(p["secret-name"]&&p["secret-namespace"])try{const e=yield Object(o.ib)({model:t,name:p["secret-name"],ns:p["secret-namespace"]});e.data||console.error(`Unexpected structure of the "${p["secret-name"]}" secret`);const n=e.data||{};k=Object(s.a)(n[h+".username"]),w=Object(s.a)(n[h+".password"])}catch(e){console.error(`Failed to load "${p["secret-name"]}" from "${p["secret-namespace"]}" secret: `,e)}let j=!1;try{const e=yield Object(o.ib)({model:n,name:"cluster"}),t=null===(d=null===(u=null===(i=null===(c=null==e?void 0:e.spec)||void 0===c?void 0:c.platformSpec)||void 0===i?void 0:i.vsphere)||void 0===u?void 0:u.failureDomains)||void 0===d?void 0:d.find(e=>e.server===h);if(t){const e=null===(m=null===(v=null==t?void 0:t.topology)||void 0===v?void 0:v.computeCluster)||void 0===m?void 0:m.split("/");let n="";e.length>3&&([,,,n]=e),O||(O=n);const r=t.topology.datacenter!==g,a=t.topology.datastore!==b,o=n!==O;j=r||a||o}}catch(t){throw new l(e("Failed to fetch infrastructure resource"),Object(s.c)(e,t))}return{values:{vcenter:h,datacenter:g,defaultDatastore:b,folder:E,username:k,password:w,vCenterCluster:O},mustPatch:j}})))(t,m,f,e);h(n)}catch(e){v(e instanceof l?{title:e.message,message:e.detail}:{title:t("An error occured"),message:Object(s.c)(t,e)})}u(!0)}}))},[e,f,n,m,t]),{initValues:null==p?void 0:p.values,isLoaded:n,error:d,mustPatch:null==p?void 0:p.mustPatch}}},11520:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(0);const a=e=>{var t;const n=document.getElementsByClassName("plugin-vsphere-status-popup"),r=null===(t=null==n?void 0:n[0])||void 0===t?void 0:t.style;r&&(r.visibility=e)},o=()=>{r.useEffect(()=>(a("hidden"),()=>{a("visible")}),[])}},11521:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u}));var r=n(976),a=n(77),o=n(6862),s=n(7522),c=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function s(e){try{i(r.next(e))}catch(e){o(e)}}function c(e){try{i(r.throw(e))}catch(e){o(e)}}function i(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}i((r=r.apply(e,t||[])).next())}))};class i extends Error{constructor(e,t){super(e),this.name="PersistError",this.detail=t}}const l={key:"node.cloudprovider.kubernetes.io/uninitialized",value:"true",effect:"NoSchedule"},u=(e,{secretModel:t,configMapModel:n,kubeControllerManagerModel:u,nodeModel:d,infrastructureModel:v},m,f)=>c(void 0,void 0,void 0,(function*(){yield((e,t,n)=>c(void 0,void 0,void 0,(function*(){const{vcenter:a,username:c,password:l}=n,u={[a+".username"]:Object(s.b)(c),[a+".password"]:Object(s.b)(l)};try{const n=yield Object(r.ib)({model:t,name:o.e,ns:o.f});try{yield Object(r.lb)({model:t,resource:n,data:[{op:"replace",path:"/data",value:u}]})}catch(t){throw new i(e("Failed to patch {{secret}}",{secret:o.e}),Object(s.c)(e,t))}}catch(n){const a={apiVersion:t.apiVersion,kind:t.kind,metadata:{name:o.e,namespace:o.f},data:u};try{yield Object(r.gb)({model:t,data:a})}catch(t){throw new i(e("Failed to create {{secret}} secret",{secret:o.e}),Object(s.c)(e,t))}}})))(e,t,m),yield((e,t)=>c(void 0,void 0,void 0,(function*(){try{const n=yield Object(r.ib)({model:t,name:o.b});if(!n)throw new i(e("Failed to load kubecontrollermanager"),e("Not found."));n.spec=n.spec||{};const a=(new Date).toISOString();n.spec.forceRedeploymentReason="recovery-"+a,yield Object(r.lb)({model:t,resource:{metadata:{name:o.b}},data:[{op:"replace",path:"/spec",value:n.spec}]})}catch(t){throw new i(e("Failed to patch kubecontrollermanager"),Object(s.c)(e,t))}})))(e,u),yield((e,t,n,a)=>c(void 0,void 0,void 0,(function*(){var c;const{vcenter:l,datacenter:u,defaultDatastore:d,folder:v,vCenterCluster:m}=n;if(a){const l=Object(s.d)((null===(c=a.data)||void 0===c?void 0:c.config)||"",n);try{yield Object(r.lb)({model:t,resource:{metadata:{name:o.c,namespace:o.d}},data:[{op:a.data?"replace":"add",path:"/data",value:{config:l}}]})}catch(t){throw new i(e("Failed to patch {{cm}}",{cm:o.c}),Object(s.c)(e,t))}}else{const n=`[Global]\nsecret-name = "${o.e}"\nsecret-namespace = "${o.f}"\ninsecure-flag = "1"\n\n[Workspace]\nserver = "${l}"\ndatacenter = "${u}"\ndefault-datastore = "${d}"\nfolder = "${v}"\nresourcepool-path = "/${u}/host/${m}/Resources"\n\n[VirtualCenter "${l}"]\ndatacenters = "${u}"\n`,a={apiVersion:t.apiVersion,kind:t.kind,metadata:{name:o.c,namespace:o.d},data:{config:n}};try{yield Object(r.gb)({model:t,data:a})}catch(t){throw new i(e("Failed to create {{cm}} ConfigMap",{cm:o.c}),Object(s.c)(e,t))}}})))(e,n,m,f),yield((e,t)=>c(void 0,void 0,void 0,(function*(){var n;const o=yield Object(a.n)({model:t,queryParams:{}}),c=[];for(const e of o)if(e.spec.taints){const n=e.spec.taints.findIndex(e=>"node.cloudprovider.kubernetes.io/uninitialized"===e.key);if(-1===n)c.push(Object(r.lb)({model:t,resource:e,data:[{op:"add",path:"/spec/taints/-",value:l}]}));else{const a=e.spec.taints[n];a.effect===l.value&&a.key===l.key||c.push(Object(r.lb)({model:t,resource:e,data:[{op:"replace",path:"/spec/taints/"+n,value:l}]}))}}else c.push(Object(r.lb)({model:t,resource:e,data:[{op:"add",path:"/spec/taints",value:[l]}]}));const u=yield Promise.allSettled(c),d=u.findIndex(e=>"rejected"===e.status);if(-1!==d)throw new i(e("Failed to add taint to node {{node}}",{node:null===(n=o[d].metadata)||void 0===n?void 0:n.name}),Object(s.c)(e,u[d].reason))})))(e,d),yield((e,t,n)=>c(void 0,void 0,void 0,(function*(){const a={cloudConfig:{key:"config",name:o.c},platformSpec:{type:"VSphere",vsphere:{failureDomains:[{name:o.a,region:"generated-region",server:n.vcenter,topology:{computeCluster:`/${n.datacenter}/host/${n.vCenterCluster}`,datacenter:n.datacenter,datastore:n.defaultDatastore,networks:[n.vCenterCluster],resourcePool:`/${n.datacenter}/host/${n.vCenterCluster}/Resources`},zone:"generated-zone"}],nodeNetworking:{external:{},internal:{}},vcenters:[{datacenters:[n.datacenter],port:443,server:n.vcenter}]}}};try{yield Object(r.lb)({model:t,resource:{metadata:{name:"cluster"}},data:[{op:"replace",path:"/spec",value:a}]})}catch(t){throw new i(e("Failed to patch infrastructure spec"),Object(s.c)(e,t))}})))(e,v,m)}))},11522:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),a=n(1922),o=n(219),s=n(7523),c=n(7),i=n(11523),l=n(11524);n(11526);const u=()=>{const{t:e}=Object(c.useTranslation)("vsphere-plugin"),t=r.useRef(null),{setFieldTouched:n}=Object(s.c)();return r.useEffect(()=>{var e;null===(e=null==t?void 0:t.current)||void 0===e||e.focus()},[]),r.createElement(a.a,{id:"vsphere-connection-modal-form"},r.createElement(o.a,{label:e("vCenter"),labelIcon:r.createElement(i.a,{content:e("Enter the network address of the vCenter server. It can either be a domain name or IP address")}),isRequired:!0,fieldId:"connection-vcenter"},r.createElement(l.a,{name:"vcenter",ref:t})),r.createElement(o.a,{label:e("vCenter cluster"),isRequired:!0,fieldId:"connection-vcenter-cluster",labelIcon:r.createElement(i.a,{content:e("Enter the name of the vSphere vCenter cluster where OpenShift Container Platform is installed.")})},r.createElement(l.a,{name:"vCenterCluster"})),r.createElement(o.a,{label:e("Username"),isRequired:!0,fieldId:"connection-username",labelIcon:r.createElement(i.a,{content:e("Enter the vSphere vCenter username. An incorrect username will render the cluster nodes unschedulable (known issue: OCPBUGS-2353).")})},r.createElement(l.a,{name:"username"})),r.createElement(o.a,{label:e("Password"),labelIcon:r.createElement(i.a,{content:e("Enter the vSphere vCenter password. The password will be stored in a Secret in the kube-system namespace for this cluster. An incorrect password will render the cluster nodes unschedulable (known issue: OCPBUGS-2353).")}),isRequired:!0,fieldId:"connection-password"},r.createElement(l.a,{name:"password",type:"password"})),r.createElement(o.a,{label:e("Datacenter"),labelIcon:r.createElement(i.a,{content:r.createElement(r.Fragment,null,r.createElement(c.Trans,{t:e},"Enter the name of the vSphere data center that contains the virtual machines currently backing-up the cluster."),r.createElement("br",null),r.createElement("strong",null,r.createElement(c.Trans,{t:e},"Warning: Updating this value once the configuration has been saved will detach any existing PersistentVolumes.")))}),isRequired:!0,fieldId:"connection-datacenter",onChange:()=>{n("defaultDatastore"),n("folder")}},r.createElement(l.a,{name:"datacenter"})),r.createElement(o.a,{label:e("Default data store"),labelIcon:r.createElement(i.a,{content:r.createElement(r.Fragment,null,r.createElement(c.Trans,{t:e},"Select the data store in the vSphere data center that is to store the persistent data volumes."),r.createElement("br",null),r.createElement("strong",null,r.createElement(c.Trans,{t:e},"Warning: Updating this value will break any existing PersistentVolumes.")))}),isRequired:!0,fieldId:"connection-defaultdatastore"},r.createElement(l.a,{name:"defaultDatastore"})),r.createElement(o.a,{label:e("Virtual Machine Folder"),labelIcon:r.createElement(i.a,{content:r.createElement(c.Trans,{t:e},"Provide ",r.createElement("b",null,"datacenter")," folder which contains VMs of the cluster.")}),isRequired:!0,fieldId:"connection-folder"},r.createElement(l.a,{name:"folder"})))}},11523:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),a=n(353),o=n(19),s=n(1269),c=n(7);const i=({content:e})=>{const{t:t}=Object(c.useTranslation)("vsphere-plugin");return r.createElement(a.a,{"aria-label":t("Help"),bodyContent:e},r.createElement(o.a,{"aria-label":t("Help"),variant:"link",isInline:!0,className:"co-field-level-help"},r.createElement(s.a,{className:"co-field-level-help__icon"})))}},11524:function(e,t,n){"use strict";var r=n(0),a=n(219),o=n(281),s=n(297),c=n(319),i=n(157),l=n(244),u=n(7523),d=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};const v=r.forwardRef((e,t)=>{var{helperText:n,onChange:v}=e,m=d(e,["helperText","onChange"]);const[f,p,{setValue:h}]=Object(u.b)({name:m.name}),g="textfield-"+m.name,b=p.touched&&!!p.error;return r.createElement(a.a,{id:"form-control__"+g,fieldId:g},r.createElement(o.a,Object.assign({},f,m,{ref:t,id:g,onChange:(e,t)=>{h(t),null==v||v(e,t)},validated:b?"error":"default"})),n&&r.createElement(s.a,null,r.createElement(c.a,null,r.createElement(i.a,{variant:"default"},n))),b&&r.createElement(s.a,null,r.createElement(c.a,null,r.createElement(i.a,{icon:r.createElement(l.a,null),variant:"error"},p.error))))});v.displayName="TextField",t.a=v},11526:function(e,t,n){},11527:function(e,t,n){"use strict";n(8346),n(8347),n(8348),n(8349),n(8350),n(8351),n(8352);var r=n(8353);n.d(t,"a",(function(){return r.a}));var a=n(8354);n.d(t,"b",(function(){return a.a}))},11528:function(e,t,n){},11529:function(e,t,n){},4482:function(e,t,n){"use strict";n.r(t),n.d(t,"healthHandler",(function(){return d}));var r=n(0),a=n(967),o=n(406),s=n(7),c=n(13),i=n(11516),l=n(11517),u=n(8345);n(11529);const d=(e,t,n)=>{const r=Object(i.a)(t,e,n),{state:a}=r;let o;switch(a){case c.k.WARNING:o=r.message;break;case c.k.OK:o=t("vsphere-plugin~No errors are reported. Click the link for details.")}return{state:a,message:o}};t.default=({hide:e,responses:t,k8sResult:n})=>{const{t:d}=Object(s.useTranslation)(),v=Object(i.a)(d,t,n);if([c.k.OK,c.k.WARNING,c.k.PROGRESS].includes(v.state)&&(null==n?void 0:n.data)){const t=n.data;return r.createElement(l.a,{hide:e,cloudProviderConfig:t,health:v})}return v.state===c.k.LOADING?r.createElement(a.a,{hasGutter:!0},r.createElement(o.a,null,d("vsphere-plugin~Loading vSphere connection status"))):r.createElement("div",null,r.createElement(a.a,{hasGutter:!0},r.createElement(o.a,null,d("vsphere-plugin~The vSphere Connection check is failing.")),r.createElement(o.a,null,r.createElement(u.a,null))))}},6862:function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"h",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u}));const r="VSPHERECONNECTION",a="VSphere",o="vsphere-creds",s="kube-system",c="cloud-provider-config",i="openshift-config",l="cluster",u="generated-failure-domain"},7522:function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return u}));var r=n(265),a=n(11519),o=n(6862);const s=(e,t="=")=>{const n=e.split("\n"),r={};return n.forEach(e=>{const n=e.indexOf(t);if(n>0){const t=e.substring(0,n).trim();let a=e.substring(n+1).trim();'"'===a.charAt(0)&&(a=a.substring(1)),'"'===a.charAt(a.length-1)&&(a=a.substring(0,a.length-1)),r[t]=a}}),r},c=e=>r.Buffer.from(e).toString("base64"),i=e=>r.Buffer.from(e,"base64").toString("ascii"),l=(e,{vcenter:t,datacenter:n,defaultDatastore:r,folder:s,vCenterCluster:c})=>{const i=Object(a.decode)(e);i.Global=i.Global||{},i.Global["secret-name"]=o.e,i.Global["secret-namespace"]=o.f,i.Global["insecure-flag"]="1",i.Workspace=i.Workspace||{},i.Workspace.server=t,i.Workspace.datacenter=n,i.Workspace["default-datastore"]=r,i.Workspace.folder=s,i.Workspace["resourcepool-path"]=`/${n}/host/${c}/Resources`,Object.keys(i).forEach(e=>{e.startsWith("VirtualCenter")&&delete i[e]}),i[`VirtualCenter "${t}"`]={datacenters:n};return Object(a.encode)(i).split("\n").map(e=>{if(e.startsWith('[VirtualCenter "'))return`[VirtualCenter "${t}"]`;if(e.startsWith("folder=")){const t=e.split("folder=",2);if(t[1])return`folder="${t[1]}"`}return e}).join("\n")},u=(e,t)=>t instanceof Error?t.message||"":"string"==typeof t?t:t instanceof String?t.toString():e("Unexpected error")},8344:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(976);const a=()=>{const[e]=Object(r.vb)({group:"app",version:"v1",kind:"Secret"}),[t]=Object(r.vb)({group:"app",version:"v1",kind:"ConfigMap"}),[n]=Object(r.vb)({group:"operator.openshift.io",version:"v1",kind:"KubeControllerManager"}),[a]=Object(r.vb)({group:"core",version:"v1",kind:"Node"}),[o]=Object(r.vb)({group:"config.openshift.io",version:"v1",kind:"Infrastructure"});return{secretModel:e,configMapModel:t,kubeControllerManagerModel:n,nodeModel:a,infrastructureModel:o}}},8345:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(0),a=n(1921),o=n(476),s=n(244),c=n(874),i=n(1199),l=n(12102),u=n(3889),d=n(7),v=n(14),m=n(976),f=n(11527);let p=0;const h={Unknown:p++,Healthy:p++,Progressing:p++,Degraded:p++,Error:p++},g=(e,t)=>{var n,a,d;const[v,p,g]=Object(m.xb)({groupVersionKind:{group:"config.openshift.io",version:"v1",kind:"ClusterOperator"},name:t,isList:!1,namespaced:!1});if(!p)return{message:e("vsphere-plugin~Pending"),icon:r.createElement(c.a,null),level:h.Unknown};if(g)return console.error(`Failed to load operator "${t}": `,g),{message:e("vsphere-plugin~Error"),icon:r.createElement(s.a,{color:l.a.value}),level:h.Error};const b=null===(n=Object(f.b)(v,"Progressing"))||void 0===n?void 0:n.status,E=null===(a=Object(f.b)(v,"Available"))||void 0===a?void 0:a.status,O=null===(d=Object(f.b)(v,"Degraded"))||void 0===d?void 0:d.status;return"True"===b?{message:e("vsphere-plugin~Progressing"),icon:r.createElement(c.a,null),level:h.Progressing}:"True"===O?{message:e("vsphere-plugin~Degraded"),icon:r.createElement(s.a,{color:l.a.value}),level:h.Degraded}:"True"===E?{message:e("vsphere-plugin~Healthy"),icon:r.createElement(o.a,{color:u.b.value}),level:h.Healthy}:{message:e("vsphere-plugin~Unknown"),icon:r.createElement(i.a,null),level:h.Unknown}},b=()=>{const{t:e}=Object(d.useTranslation)(),[t,n]=r.useState(!1),o=g(e,"kube-controller-manager"),s=g(e,"kube-apiserver"),c=g(e,"storage"),i=(e=>{let t=e[0];return e.forEach(e=>{t.level<e.level&&(t=e)}),t.icon})([s,o,c]);return r.createElement(a.a,{toggleContent:r.createElement("span",null,e("vsphere-plugin~Monitored operators")," ",t?null:i),onToggle:(e,t)=>{n(t)},isExpanded:t},r.createElement(m.S,{firstColumn:e("vsphere-plugin~Operator"),secondColumn:e("vsphere-plugin~Status")},r.createElement(m.R,{value:s.message,icon:s.icon},r.createElement(v.Link,{to:f.a+"/kube-apiserver"},e("vsphere-plugin~Kube API Server"))),r.createElement(m.R,{value:o.message,icon:o.icon},r.createElement(v.Link,{to:f.a+"/kube-controller-manager"},e("vsphere-plugin~Kube Controller Manager"))),r.createElement(m.R,{value:c.message,icon:c.icon},r.createElement(v.Link,{to:f.a+"/storage"},e("vsphere-plugin~Storage")))))}},8346:function(e,t,n){},8347:function(e,t,n){},8348:function(e,t,n){},8349:function(e,t,n){},8350:function(e,t,n){},8351:function(e,t,n){},8352:function(e,t,n){},8353:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r="/k8s/cluster/config.openshift.io~v1~ClusterOperator"},8354:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>{var n,r;return null===(r=null===(n=null==e?void 0:e.status)||void 0===n?void 0:n.conditions)||void 0===r?void 0:r.find(e=>e.type===t)}}}]);
//# sourceMappingURL=vsphereStatus-chunk-aed886aaa703675a83d6.min.js.map