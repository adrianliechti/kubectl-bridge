(window.webpackJsonp=window.webpackJsonp||[]).push([[241],{4408:function(e,t,a){"use strict";a.r(t),a.d(t,"PVCStatus",(function(){return R})),a.d(t,"PersistentVolumeClaimsList",(function(){return L})),a.d(t,"PersistentVolumeClaimsPage",(function(){return W})),a.d(t,"PersistentVolumeClaimsDetailsPage",(function(){return U}));var l=a(0),s=a(16),n=a(22),c=a(667),i=a(50),r=a(18),o=a(31),m=a(54),u=a(7),d=a(2232),p=a(69),v=a(2263),b=a(13),E=a(15),g=a(243),j=a(972),O=a(40),N=a(5),f=a(409),y=a(10),C=a(53),P=a(436),h=a(1197),k=a(7564),V=a(29);const{ModifyLabels:T,ModifyAnnotations:F,Edit:S,ExpandPVC:x,PVCSnapshot:w,ClonePVC:_}=N.F.factory,A=[...N.F.getExtensionsActionsForKind(y.PersistentVolumeClaimModel),x,w,_,T,F,S,(e,t)=>({label:V.a.t("public~Delete PersistentVolumeClaim"),callback:()=>Object(k.a)({pvc:t}),accessReview:Object(N.Eb)(e,t,"delete")})],R=({pvc:e})=>{var t;const{t:a}=Object(u.useTranslation)(),[s,n]=Object(b.kc)(v.d);if(n&&s.length>0){const n=s.sort((e,t)=>t.properties.priority-e.properties.priority).find(t=>t.properties.predicate(e)),c=null===(t=null==n?void 0:n.properties)||void 0===t?void 0:t.status;return c?l.createElement(c,{pvc:e}):l.createElement(E.cc,{status:e.metadata.deletionTimestamp?a("public~Terminating"):e.status.phase})}return l.createElement(E.cc,{status:e.metadata.deletionTimestamp?a("public~Terminating"):e.status.phase})},D=["","",r("pf-m-hidden","pf-m-visible-on-lg"),r("pf-m-hidden","pf-m-visible-on-xl"),r("pf-m-hidden","pf-m-visible-on-xl"),r("pf-m-hidden","pf-m-visible-on-2xl"),r("pf-m-hidden","pf-m-visible-on-2xl"),N.F.columnClass],$="PersistentVolumeClaim",I=Object(o.connect)(({UI:e},{obj:t})=>{var a,l,s;return{metrics:null===(s=null===(l=null===(a=e.getIn(["metrics","pvc"]))||void 0===a?void 0:a.usedCapacity)||void 0===l?void 0:l[Object(E.ed)(t)])||void 0===s?void 0:s[Object(E.dd)(t)]}})(({obj:e,metrics:t})=>{var a,n,c;const[i,o]=[Object(E.dd)(e),Object(E.ed)(e)],m=Object(N.Ib)(null===(n=null===(a=null==e?void 0:e.status)||void 0===a?void 0:a.capacity)||void 0===n?void 0:n.storage),d=Object(N.Wb)(m),p=Object(N.Wb)(t),{t:v}=Object(u.useTranslation)();return l.createElement(l.Fragment,null,l.createElement(O.k,{className:D[0]},l.createElement(N.hb,{kind:$,name:i,namespace:o,title:i})),l.createElement(O.k,{className:r(D[1],"co-break-word"),columnID:"namespace"},l.createElement(N.hb,{kind:"Namespace",name:o,title:o})),l.createElement(O.k,{className:D[2]},l.createElement(R,{pvc:e})),l.createElement(O.k,{className:D[3]},s.a(e,"spec.volumeName")?l.createElement(N.hb,{kind:"PersistentVolume",name:e.spec.volumeName,title:e.spec.volumeName}):l.createElement("div",{className:"text-muted"},v("public~No PersistentVolume"))),l.createElement(O.k,{className:D[4]},m?d.string:"-"),l.createElement(O.k,{className:D[5]},t?p.string:"-"),l.createElement(O.k,{className:r(D[6])},(null===(c=null==e?void 0:e.spec)||void 0===c?void 0:c.storageClassName)?l.createElement(N.hb,{kind:"StorageClass",name:e.spec.storageClassName,title:e.spec.storageClassName}):"-"),l.createElement(O.k,{className:D[7]},l.createElement(N.gb,{actions:A,kind:$,resource:e})))}),M=Object(g.a)(E.O.CAN_LIST_PV)(({flags:e,obj:t})=>{var a,s,c,i,r,o,m,p,g,O,f,y,C,k;const T=e[E.O.CAN_LIST_PV],F=null===(a=null==t?void 0:t.metadata)||void 0===a?void 0:a.name,S=null===(s=null==t?void 0:t.metadata)||void 0===s?void 0:s.namespace,x=null===(c=null==t?void 0:t.spec)||void 0===c?void 0:c.selector,w=null===(i=null==t?void 0:t.spec)||void 0===i?void 0:i.storageClassName,_=null===(r=null==t?void 0:t.spec)||void 0===r?void 0:r.volumeName,A=null===(m=null===(o=null==t?void 0:t.status)||void 0===o?void 0:o.capacity)||void 0===m?void 0:m.storage,D=Object(E.Ad)(t),$=null===(p=null==t?void 0:t.status)||void 0===p?void 0:p.accessModes,I=null===(g=null==t?void 0:t.spec)||void 0===g?void 0:g.volumeMode,M=null===(O=null==t?void 0:t.status)||void 0===O?void 0:O.conditions,L=F&&S?`kubelet_volume_stats_used_bytes{persistentvolumeclaim='${F}',namespace='${S}'}`:"",[W,U,q]=Object(h.usePrometheusPoll)({endpoint:P.a.QUERY,namespace:S,query:L}),z=Object(N.Ib)(A),Y=Object(N.Ib)(D),G=null===(k=null===(C=null===(y=null===(f=null==W?void 0:W.data)||void 0===f?void 0:f.result)||void 0===y?void 0:y[0])||void 0===C?void 0:C.value)||void 0===k?void 0:k[1],J=G?z-G:null,K=Object(N.Wb)(z),Q=Object(N.Wb)(J,void 0,K.unit),B=Object(N.Wb)(G,void 0,K.unit),{podStatusInnerRadius:H,podStatusOuterRadius:X}=Object(E.vc)(130),Z=`${Number(Q.value.toFixed(1))} ${Q.unit}`,ee=`${Number(K.value.toFixed(1))} ${K.unit}`,te=G?[{x:V.a.t("public~Used"),y:B.value},{x:V.a.t("public~Available"),y:Q.value}]:[{x:V.a.t("public~Total"),y:K.value}],[ae]=Object(b.kc)(v.a),le=null==ae?void 0:ae.map(({properties:{alert:e},uid:a})=>l.createElement(e,{key:a,pvc:t})),{t:se}=Object(u.useTranslation)();return l.createElement(l.Fragment,null,l.createElement("div",{className:"co-m-pane__body"},le,l.createElement(N.ob,{text:se("public~PersistentVolumeClaim details")}),z&&!q&&l.createElement("div",{className:"co-pvc-donut"},l.createElement(d.a,{ariaDesc:se(J?"public~Available versus used capacity":"public~Total capacity"),ariaTitle:se(J?"public~Available versus used capacity":"public~Total capacity"),height:130,width:130,size:130,innerRadius:H,radius:X,data:te,labels:({datum:e})=>`${e.y} ${K.unit} ${e.x}`,subTitle:se(J?"public~Available":"public~Total"),title:J?Z:ee,constrainToVisibleArea:!0})),l.createElement("div",{className:"row"},l.createElement("div",{className:"col-sm-6"},l.createElement(N.lb,{resource:t},l.createElement("dt",null,se("public~Label selector")),l.createElement("dd",{"data-test-id":"pvc-name"},l.createElement(N.pb,{selector:x,kind:"PersistentVolume"})))),l.createElement("div",{className:"col-sm-6"},l.createElement("dl",null,l.createElement("dt",null,se("public~Status")),l.createElement("dd",{"data-test-id":"pvc-status"},l.createElement(R,{pvc:t})),l.createElement("dt",null,se("public~Requested capacity")),l.createElement("dd",{"data-test":"pvc-requested-capacity"},Object(N.Wb)(Y).string),A&&l.createElement(l.Fragment,null,l.createElement("dt",null,se("public~Capacity")),l.createElement("dd",{"data-test-id":"pvc-capacity"},K.string)),G&&n.a(U)&&!q&&l.createElement(l.Fragment,null,l.createElement("dt",null,se("public~Used")),l.createElement("dd",null,Object(N.Wb)(G).string)),!n.a($)&&l.createElement(l.Fragment,null,l.createElement("dt",null,se("public~Access modes")),l.createElement("dd",{"data-test-id":"pvc-access-mode"},$.join(", "))),l.createElement("dt",null,se("public~Volume mode")),l.createElement("dd",{"data-test-id":"pvc-volume-mode"},I||"Filesystem"),l.createElement("dt",null,se("public~StorageClasses")),l.createElement("dd",{"data-test-id":"pvc-storageclass"},w?l.createElement(N.hb,{kind:"StorageClass",name:w}):"-"),_&&T&&l.createElement(l.Fragment,null,l.createElement("dt",null,se("public~PersistentVolumes")),l.createElement("dd",{"data-test-id":"persistent-volume"},l.createElement(N.hb,{kind:"PersistentVolume",name:_}))))))),l.createElement("div",{className:"co-m-pane__body"},l.createElement(N.ob,{text:se("public~Conditions")}),l.createElement(j.b,{conditions:M})))}),L=e=>{const{t:t}=Object(u.useTranslation)();return l.createElement(O.j,Object.assign({},e,{"aria-label":t("public~PersistentVolumeClaims"),Header:()=>[{title:t("public~Name"),sortField:"metadata.name",transforms:[m.a],props:{className:D[0]}},{title:t("public~Namespace"),sortField:"metadata.namespace",transforms:[m.a],props:{className:D[1]},id:"namespace"},{title:t("public~Status"),sortField:"status.phase",transforms:[m.a],props:{className:D[2]}},{title:t("public~PersistentVolumes"),sortField:"spec.volumeName",transforms:[m.a],props:{className:D[3]}},{title:t("public~Capacity"),sortFunc:"pvcStorage",transforms:[m.a],props:{className:D[4]}},{title:t("public~Used"),sortFunc:"pvcUsed",transforms:[m.a],props:{className:D[5]}},{sortField:"spec.storageClassName",title:t("public~StorageClass"),transforms:[m.a],props:{className:D[6]}},{title:"",props:{className:D[7]}}],Row:I,virtualize:!0}))},W=e=>{var t,a;const{t:s}=Object(u.useTranslation)(),r=Object(p.z)(v.b),{namespace:m}=e,d=Object(o.useDispatch)(),[b,E,g]=Object(h.usePrometheusPoll)({endpoint:P.a.QUERY,namespace:m,query:"kubelet_volume_stats_used_bytes"}),j=n.a(E)&&!g?null===(a=null===(t=null==b?void 0:b.data)||void 0===t?void 0:t.result)||void 0===a?void 0:a.reduce((e,t)=>{var a,l,s;return c.a(e,["usedCapacity",null===(a=null==t?void 0:t.metric)||void 0===a?void 0:a.namespace,null===(l=null==t?void 0:t.metric)||void 0===l?void 0:l.persistentvolumeclaim],Number(null===(s=null==t?void 0:t.value)||void 0===s?void 0:s[1])),e},{}):{};d(Object(C.s)(j));const N=`/k8s/ns/${e.namespace||"default"}/persistentvolumeclaims/`,f=r.map(({properties:{label:e,path:t}},a)=>({key:a+1,label:e,path:t})),y=0===r.length?{to:N.concat("~new/form")}:{items:Object.assign({0:"With Form"},...f.map(({key:e,label:t})=>({[e]:t}))),createLink:e=>{if("0"===e)return N.concat("~new/form");const t=f.find(({key:t})=>t.toString()===e);return N.concat(t.path)}},k=[{filterGroupName:s("public~Status"),type:"pvc-status",reducer:e=>e.status.phase,items:i.a(["Pending","Bound","Lost"],e=>({id:e,title:e}))}];return l.createElement(O.c,Object.assign({},e,{ListComponent:L,kind:$,canCreate:!0,rowFilters:k,createProps:y,customData:j}))},U=e=>{const{t:t}=Object(u.useTranslation)();return l.createElement(O.a,Object.assign({},e,{getResourceStatus:e=>e.metadata.deletionTimestamp?t("public~Terminating"):e.status.phase,menuActions:A,pages:[N.mc.details(M),N.mc.editYaml(),N.mc.events(f.ResourceEventStream)]}))}},7564:function(e,t,a){"use strict";var l=a(0),s=a(14),n=a(406),c=a(967),i=a(7),r=a(5),o=a(15),m=a(876),u=a(2263),d=a(40),p=a(8),v=a(10);const b=Object(r.Oc)(e=>{const{pvc:t,inProgress:a,errorMessage:b,handlePromise:E,close:g,cancel:j}=e,[O]=Object(m.useResolvedExtensions)(u.c),N=Object(o.dd)(t),{t:f}=Object(i.useTranslation)(),y={metadata:Object.assign({},null==t?void 0:t.metadata)},C=Object(s.useNavigate)(),P=O.map(({properties:{predicate:e,alert:t},uid:a})=>e(y)&&l.createElement(n.a,{key:a},l.createElement(t,{pvc:y})));return l.createElement("form",{onSubmit:e=>{e.preventDefault();const a=Object(p.lb)(v.PersistentVolumeClaimModel,t),l=O.map(({properties:{predicate:e,onPVCKill:t}})=>e(y)&&t(y));E(Promise.all([a,...l]),()=>{g(),C(Object(r.rc)(v.PersistentVolumeClaimModel,t.metadata.namespace))})},className:"modal-content"},l.createElement(d.h,null,l.createElement(o.tc,{className:"co-icon-space-r"})," ",f("public~Delete PersistentVolumeClaim")),l.createElement(d.e,null,l.createElement(c.a,{hasGutter:!0},P,l.createElement(n.a,null,l.createElement(i.Trans,{t:f,ns:"public"},"Are you sure you want to delete"," ",l.createElement("strong",{className:"co-break-word"},{pvcName:N})," PersistentVolumeClaim?")))),l.createElement(d.g,{errorMessage:b,inProgress:a,submitText:f("public~Delete"),submitDanger:!0,cancel:j}))});t.a=Object(d.m)(b)}}]);
//# sourceMappingURL=persistent-volume-claim-chunk-a2013586e97cfadfb450.min.js.map