(window.webpackJsonp=window.webpackJsonp||[]).push([[253],{11723:function(e,a,t){"use strict";var r=t(0),n=t(55),i=t(7),l=t(8),s=t(197),c=t(76),o=t(5845),u=t(7456),d=t(11724);a.a=({source:e,cancel:a,close:t,target:b={metadata:{name:""}}})=>{const{t:m}=Object(i.useTranslation)(),{apiVersion:v,kind:f,metadata:{namespace:p,name:g}}=e,{apiVersion:k="",kind:O="",metadata:{name:j}}=b,h=()=>f===c.f.kind?c.i:c.h,{kind:E,apiVersion:S,apiGroup:D,labelKey:y}=h(),V={formData:{apiVersion:`${D}/${S}`,kind:E,metadata:{name:`${g}-${Object(s.D)()}`,namespace:p},spec:Object.assign(Object.assign({},(e=>{let a={};return a=e===c.i.kind?{broker:g,filter:{}}:{channel:{apiVersion:v,kind:f,name:g}},a})(E)),{subscriber:{ref:{apiVersion:k,kind:O,name:Object(o.a)(j,b)}}})}},w=m("knative-plugin~Add {{kind}}",{kind:m(y)||E});return r.createElement(n.b,{initialValues:V,onSubmit:(e,a)=>Object(l.jb)(h(),Object(o.c)(e.formData)).then(()=>{a.setStatus({subscriberAvailable:!0,error:""}),t()}).catch(e=>{const t=e.message||m("knative-plugin~An error occurred. Please try again");a.setStatus({subscriberAvailable:!0,error:t})}),onReset:a,initialStatus:{error:""},validationSchema:u.a},e=>r.createElement(d.a,Object.assign({},e,{filterEnabled:f===c.f.kind,labelTitle:w,cancel:a})))}},11724:function(e,a,t){"use strict";var r=t(0),n=t(281),i=t(22),l=t(7),s=t(5618),c=t(118),o=t(15),u=t(7457),d=t(7458);a.a=({filterEnabled:e,labelTitle:a,handleSubmit:t,cancel:b,isSubmitting:m,status:v,errors:f,values:p})=>{var g,k,O,j,h,E;const{t:S}=Object(l.useTranslation)(),D=(null===(k=null===(g=null==p?void 0:p.formData)||void 0===g?void 0:g.metadata)||void 0===k?void 0:k.name)&&(null===(E=null===(h=null===(j=null===(O=null==p?void 0:p.formData)||void 0===O?void 0:O.spec)||void 0===j?void 0:j.subscriber)||void 0===h?void 0:h.ref)||void 0===E?void 0:E.name);return r.createElement("form",{className:"modal-content",onSubmit:t},r.createElement(c.d,null,a),r.createElement(c.a,null,r.createElement(s.a,{fullWidth:!0},r.createElement(o.ab,{type:n.b.text,name:"formData.metadata.name",label:S("knative-plugin~Name"),required:!0}),r.createElement(d.a,{cancel:b}),e&&r.createElement(u.a,null))),r.createElement(c.c,{inProgress:m,submitText:S("knative-plugin~Add"),cancelText:S("knative-plugin~Cancel"),submitDisabled:!D||!i.a(f)||m,cancel:b,errorMessage:v.error}))}},5495:function(e,a,t){"use strict";t.r(a),t.d(a,"PubSubModalLauncher",(function(){return c}));var r=t(0),n=t(40),i=t(11723),l=function(e,a){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&a.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)a.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(t[r[n]]=e[r[n]])}return t};const s=e=>{var{source:a}=e,t=l(e,["source"]);return r.createElement(i.a,Object.assign({},t,{source:a}))},c=Object(n.m)(s);a.default=s},5618:function(e,a,t){"use strict";var r=t(0),n=t(297),i=t(18),l=t.n(i);t(5732);const s={display:"flex",flex:1,flexDirection:"column",margin:"var(--pf-v5-global--spacer--md) 0"};a.a=({title:e,subTitle:a,fullWidth:t,children:i,flexLayout:c,extraMargin:o,dataTest:u,style:d})=>r.createElement("div",{className:l()("pf-v5-c-form",{"co-m-pane__form":!t,"odc-form-section--extra-margin":o}),style:Object.assign(Object.assign({},c?s:{}),d||{}),"data-test":u},e&&r.createElement("h2",{className:"odc-form-section__heading"},e),a&&r.createElement(n.a,null,a),i)},5732:function(e,a,t){},5845:function(e,a,t){"use strict";t.d(a,"a",(function(){return i})),t.d(a,"b",(function(){return l})),t.d(a,"c",(function(){return s}));var r=t(8);const n=e=>{var a;return null!==(a={"serving.knative.dev":1,"messaging.knative.dev":2,"eventing.knative.dev":3}[(e=>e.split("/")[0])(e)])&&void 0!==a?a:4},i=(e,a)=>{if(!(null==a?void 0:a.apiVersion))return;const{apiVersion:t}=a;return e?[n(t),Object(r.Db)(a),e].join("#"):void 0},l=e=>{var a;return null!==(a=null==e?void 0:e.split("#").pop())&&void 0!==a?a:""},s=e=>{const a=Object.assign({},e);return a.spec.subscriber.ref.name=l(e.spec.subscriber.ref.name),a}},7456:function(e,a,t){"use strict";t.d(a,"a",(function(){return n}));var r=t(689);const n=r.object().shape({formData:r.object().shape({metadata:r.object().shape({name:r.string().required("Required")})})})},7457:function(e,a,t){"use strict";var r=t(0),n=t(219),i=t(55),l=t(57),s=t(7),c=t(1949),o=t(15);a.a=()=>{var e,a,t;const{setFieldValue:u,status:d,values:b}=Object(i.f)(),m=(e=>{let a=[];for(const t in e)e.hasOwnProperty(t)&&(a=[...a,[t,e[t]]]);return a})(null===(t=null===(a=null===(e=b.formData)||void 0===e?void 0:e.spec)||void 0===a?void 0:a.filter)||void 0===t?void 0:t.attributes),[v,f]=r.useState(m.length>0?m:[["",""]]),{t:p}=Object(s.useTranslation)(),g=r.useCallback(({nameValuePairs:e})=>{let a={};l.a(e,([e,t])=>t.length?(a=Object.assign(Object.assign({},a),{[e]:t}),a):a),f(e),u("formData.spec.filter.attributes",a)},[u]);return r.createElement(n.a,{fieldId:Object(o.Kc)("pubsub","filter"),label:p("knative-plugin~Filter"),required:!0},r.createElement(c.NameValueEditor,{nameValuePairs:d.subscriberAvailable?v:[],valueString:p("knative-plugin~Value"),nameString:p("knative-plugin~Attribute"),readOnly:!d.subscriberAvailable,allowSorting:!1,updateParentData:g,addString:p("knative-plugin~Add more")}))}},7458:function(e,a,t){"use strict";var r=t(0),n=t(219),i=t(80),l=t(55),s=t(230),c=t(22),o=t(7),u=t(764),d=t(15),b=t(1412),m=t(5845);a.a=({autoSelect:e=!0,cancel:a})=>{const{t:t}=Object(o.useTranslation)(),{values:v,setFieldValue:f,setFieldTouched:p,validateForm:g,setStatus:k}=Object(l.f)(),{namespace:O}=v.formData.metadata,[j,h]=r.useState(!1),E=r.useCallback((e,a)=>{var t;const r=null===(t=null==a?void 0:a.props)||void 0===t?void 0:t.model;if(e){if(p("formData.spec.subscriber.ref.name",!0),f("formData.spec.subscriber.ref.name",e),r){const{apiGroup:e="core",apiVersion:a,kind:t}=r;f("formData.spec.subscriber.ref.apiVersion",`${e}/${a}`),p("formData.spec.subscriber.ref.apiVersion",!0),f("formData.spec.subscriber.ref.kind",t),p("formData.spec.subscriber.ref.kind",!0)}g()}},[f,p,g]);r.useEffect(()=>{k({subscriberAvailable:!j})},[j,k]);return r.createElement(n.a,{fieldId:Object(d.Kc)("pubsub","subscriber"),label:t("knative-plugin~Subscriber"),isRequired:!0},j&&r.createElement(r.Fragment,null,r.createElement(i.a,{variant:"custom",title:t("knative-plugin~No Subscriber available"),isInline:!0},r.createElement(o.Trans,{t:t,ns:"knative-plugin"},"To create a Subscriber, first create a Knative Service from the ",r.createElement(u.Link,{to:"/add/ns/"+O,onClick:()=>{a&&a()}},"Add page"),".")),"Â "),r.createElement(d.Ob,{name:"formData.spec.subscriber.ref.name",resources:Object(b.i)(O),dataSelector:["metadata","name"],fullWidth:!0,required:!0,placeholder:t("knative-plugin~Select Subscriber"),showBadge:!0,autocompleteFilter:(e,a)=>{var t;return s(e,null===(t=null==a?void 0:a.props)||void 0===t?void 0:t.name)},onChange:E,customResourceKey:m.a,disabled:j,resourceFilter:({metadata:e})=>{var a;return!(null===(a=null==e?void 0:e.ownerReferences)||void 0===a?void 0:a.length)},onLoad:e=>{h(c.a(e))},autoSelect:e}))}}}]);
//# sourceMappingURL=pub-sub-connectors-chunk-0de85d1bf5aa3da3530b.min.js.map