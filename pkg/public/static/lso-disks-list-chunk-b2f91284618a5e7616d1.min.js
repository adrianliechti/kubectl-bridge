(window.webpackJsonp=window.webpackJsonp||[]).push([[206],{11772:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));const o="discovery-result-node"},11773:function(e,t,n){"use strict";var o;n.d(t,"a",(function(){return o})),function(e){e.Available="Available",e.NotAvailable="NotAvailable",e.Unknown="Unknown"}(o||(o={}))},5515:function(e,t,n){"use strict";n.r(t),n.d(t,"tableColumnClasses",(function(){return E})),n.d(t,"NodesDisksListPage",(function(){return w}));var o=n(0),l=n(156),i=n(19),a=n(54),s=n(18),r=n(22),c=n(240),u=n(7),d=n(40),v=n(5),m=n(108),p=n(8),f=n(519),b=n(15),k=n(11772),y=n(788),D=n(7556),g=n(11773),h=function(e,t,n,o){return new(n||(n=Promise))((function(l,i){function a(e){try{r(o.next(e))}catch(e){i(e)}}function s(e){try{r(o.throw(e))}catch(e){i(e)}}function r(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}r((o=o.apply(e,t||[])).next())}))};const E=["","",s("pf-m-hidden","pf-m-visible-on-xl"),s("pf-m-hidden","pf-m-visible-on-2xl"),s("pf-m-hidden","pf-m-visible-on-lg"),s("pf-m-hidden","pf-m-visible-on-xl"),v.F.columnClass],S=e=>({id:e.deviceID}),j=({obj:e})=>o.createElement(o.Fragment,null,o.createElement(d.k,{className:E[0]},e.path),o.createElement(d.k,{className:E[1]},e.status.state),o.createElement(d.k,{className:E[2]},e.type||"-"),o.createElement(d.k,{className:s(E[3],"co-break-word")},e.model||"-"),o.createElement(d.k,{className:E[4]},Object(v.Wb)(e.size).string||"-"),o.createElement(d.k,{className:E[5]},e.fstype||"-")),N=e=>{const{t:t}=Object(u.useTranslation)();return o.createElement(d.j,Object.assign({},e,{loadError:e.customData.error||e.loadError,loaded:e.customData.loaded&&e.loaded,label:t("lso-plugin~Disks"),"aria-label":t("lso-plugin~Disks List"),Header:()=>[{title:t("lso-plugin~Name"),sortField:"path",transforms:[a.a],props:{className:E[0]}},{title:t("lso-plugin~Disk State"),sortField:"status.state",transforms:[a.a],props:{className:E[1]}},{title:t("lso-plugin~Type"),sortField:"type",transforms:[a.a],props:{className:E[2]}},{title:t("lso-plugin~Model"),sortField:"model",transforms:[a.a],props:{className:E[3]}},{title:t("lso-plugin~Capacity"),sortField:"size",transforms:[a.a],props:{className:E[4]}},{title:t("lso-plugin~Filesystem"),sortField:"fstype",transforms:[a.a],props:{className:E[5]}}],Row:j,NoDataEmptyMsg:e.customData.EmptyMsg,virtualize:!0,getRowProps:S}))},w=({obj:e,ListComponent:t})=>{var n,a;const{t:s}=Object(u.useTranslation)(),[v,E]=o.useState(""),[S,j]=o.useState(!1),[w,O,x]=Object(m.a)({kind:Object(p.Hb)(f.c),fieldSelector:"metadata.name=local-storage-operator",isList:!0}),F=Object(b.ed)(w[0]),L=null===(a=null===(n=null==w?void 0:w[0])||void 0===n?void 0:n.status)||void 0===a?void 0:a.installedCSV,A=e.metadata.name,T=Object(b.kd)(e),C="lvdr-"+A,z=[{type:"disk-state",filterGroupName:s("lso-plugin~Disk State"),reducer:e=>{var t;return null===(t=null==e?void 0:e.status)||void 0===t?void 0:t.state},items:[{id:g.a.Available,title:s("lso-plugin~Available")},{id:g.a.NotAvailable,title:s("lso-plugin~NotAvailable")},{id:g.a.Unknown,title:s("lso-plugin~Unknown")}],filter:(e,t)=>{if(!e||!e.selected||r.a(e.selected))return!0;const n=null==t?void 0:t.status.state;return e.selected.includes(n)||!c.a(e.all,n)}}];return o.createElement(d.i,{canCreate:!1,title:s("lso-plugin~Disks"),hideLabelFilter:!0,textFilter:"node-disk-name",rowFilters:z,flatten:e=>{var t,n,o,l;return null!==(l=null===(o=null===(n=null===(t=e[C])||void 0===t?void 0:t.data[0])||void 0===n?void 0:n.status)||void 0===o?void 0:o.discoveredDevices)&&void 0!==l?l:[]},ListComponent:null!=t?t:N,resources:[{kind:Object(p.Hb)(y.LocalVolumeDiscoveryResult),prop:C,selector:{matchLabels:{[k.a]:A}}}],customData:{node:A,EmptyMsg:()=>o.createElement(l.a,{variant:l.b.lg},o.createElement("p",null,s("lso-plugin~Disks Not Found")),L&&F&&"control-plane"!==T&&o.createElement(i.a,{isDisabled:S,isLoading:S,className:"pf-v5-u-mt-0",onClick:()=>{return t=F,h(void 0,void 0,void 0,(function*(){var n,o,l;const i=null===(o=null===(n=e.metadata)||void 0===n?void 0:n.labels)||void 0===o?void 0:o["kubernetes.io/hostname"];j(!0);try{yield Object(D.b)([i],t,E)}catch(e){if(404===(null===(l=null==e?void 0:e.response)||void 0===l?void 0:l.status))try{yield Object(D.a)([i],t,E)}catch(e){E(e.message),j(!1)}else E(e.message),j(!1)}}));var t},variant:"primary",id:"yaml-create","data-test":"yaml-create"},s("lso-plugin~Discover Disks"))),error:v||x,loaded:O}})}},6095:function(e,t,n){"use strict";var o;n.d(t,"c",(function(){return o})),n.d(t,"h",(function(){return l})),n.d(t,"f",(function(){return i})),n.d(t,"b",(function(){return a})),n.d(t,"g",(function(){return s})),n.d(t,"k",(function(){return r})),n.d(t,"j",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"a",(function(){return d})),n.d(t,"d",(function(){return v})),n.d(t,"e",(function(){return m})),function(e){e.All="All",e.SSD="SSD",e.HDD="HDD"}(o||(o={}));const l=Object.freeze({BLOCK:"Block",FILESYSTEM:"Filesystem"}),i=["topology.kubernetes.io/zone","failure-domain.beta.kubernetes.io/zone"],a={[o.SSD]:{property:"NonRotational"},[o.HDD]:{property:"Rotational"}},s=Object.freeze({DISK:"Disk",PART:"Part",MPATH:"Mpath"}),r=Object.freeze({EXT4:"ext4",EXT3:"ext3",XFS:"xfs"}),c=e=>Object.freeze({[o.All]:e("lso-plugin~All"),[o.SSD]:e("lso-plugin~SSD / NVMe"),[o.HDD]:e("lso-plugin~HDD")}),u={Ti:"TiB",Gi:"GiB"},d="auto-discover-devices",v="kubernetes.io/hostname",m="In"},6257:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return r}));var o=n(22),l=n(6095);const i=e=>{var t;return o.a(null===(t=e.spec)||void 0===t?void 0:t.taints)},a=e=>{var t,n;return(null===(t=e.metadata.labels)||void 0===t?void 0:t[l.f[0]])||(null===(n=e.metadata.labels)||void 0===n?void 0:n[l.f[1]])},s=(e=[])=>{let[t,n]=[-1,-1];return e.forEach((e,o)=>{var i;n=null===(i=null==e?void 0:e.matchExpressions)||void 0===i?void 0:i.findIndex(e=>e.key===l.d&&e.operator===l.e),-1!==n&&(t=o)}),[t,n]},r=e=>e.map(e=>{var t,n;return null===(n=null===(t=e.metadata)||void 0===t?void 0:t.labels)||void 0===n?void 0:n["kubernetes.io/hostname"]})},7556:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return u}));var o=n(22),l=n(8),i=n(6257),a=n(6095),s=n(788),r=function(e,t,n,o){return new(n||(n=Promise))((function(l,i){function a(e){try{r(o.next(e))}catch(e){i(e)}}function s(e){try{r(o.throw(e))}catch(e){i(e)}}function r(e){var t;e.done?l(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}r((o=o.apply(e,t||[])).next())}))};const c=(e,t,n)=>r(void 0,void 0,void 0,(function*(){var o,r,c,u,d,v,m,p;const f=yield Object(l.kb)(s.LocalVolumeDiscovery,a.a,t),b=null===(r=null===(o=null==f?void 0:f.spec)||void 0===o?void 0:o.nodeSelector)||void 0===r?void 0:r.nodeSelectorTerms,[k,y]=Object(i.a)(b);if(-1===k||-1===y)throw new Error('Could not find matchExpression of type key: "kubernetes.io/hostname" and operator: "In"');{const t=new Set(null===(p=null===(m=null===(v=null===(d=null===(u=null===(c=null==f?void 0:f.spec)||void 0===c?void 0:c.nodeSelector)||void 0===u?void 0:u.nodeSelectorTerms)||void 0===d?void 0:d[k])||void 0===v?void 0:v.matchExpressions)||void 0===m?void 0:m[y])||void 0===p?void 0:p.values);e.forEach(e=>t.add(e));const o=[{op:"replace",path:`/spec/nodeSelector/nodeSelectorTerms/${k}/matchExpressions/${y}/values`,value:[...t]}];yield Object(l.pb)(s.LocalVolumeDiscovery,f,o),n("")}})),u=(e,t,n)=>r(void 0,void 0,void 0,(function*(){const i=((e,t,n)=>{const i={apiVersion:Object(l.n)(s.LocalVolumeDiscovery),kind:s.LocalVolumeDiscovery.kind,metadata:{name:a.a,namespace:t},spec:{nodeSelector:{nodeSelectorTerms:[{matchExpressions:[{key:a.d,operator:a.e,values:e}]}]}}};return o.a(n)||(i.spec.tolerations=[n]),i})(e,t,n);yield Object(l.jb)(s.LocalVolumeDiscovery,i)}))}}]);
//# sourceMappingURL=lso-disks-list-chunk-b2f91284618a5e7616d1.min.js.map