(window.webpackJsonp=window.webpackJsonp||[]).push([[285,40,314,317],{4386:function(e,t,a){"use strict";a.r(t),a.d(t,"catalogSourceForSubscription",(function(){return D})),a.d(t,"installedCSVForSubscription",(function(){return F})),a.d(t,"packageForSubscription",(function(){return I})),a.d(t,"installPlanForSubscription",(function(){return A})),a.d(t,"SourceMissingStatus",(function(){return H})),a.d(t,"SourceUnhealthyStatus",(function(){return U})),a.d(t,"UpgradeApprovalLink",(function(){return x})),a.d(t,"SubscriptionStatus",(function(){return L})),a.d(t,"SubscriptionTableRow",(function(){return K})),a.d(t,"SubscriptionsList",(function(){return G})),a.d(t,"SubscriptionsPage",(function(){return q})),a.d(t,"SubscriptionDetails",(function(){return z})),a.d(t,"SubscriptionUpdates",(function(){return W})),a.d(t,"SubscriptionDetailsPage",(function(){return Q}));var n=a(0),l=a(80),r=a(19),s=a(353),c=a(874),o=a(615),i=a(54),d=a(18),m=a(22),u=a(16),p=a(489),v=a(7),b=a(14),E=a(13),g=a(83),h=a(972),f=a(40),O=a(5),N=a(983),k=a(8),S=a(15),j=a(125),C=a(146),w=a(2241),_=a(5737),y=a(6177),P=a(6178),M=a(6037),T=a(2235),V=a(1405);const D=(e=[],t)=>e.find(e=>{var a,n,l,r;return(null===(a=null==e?void 0:e.metadata)||void 0===a?void 0:a.name)===(null===(n=null==t?void 0:t.spec)||void 0===n?void 0:n.source)&&(null===(l=null==e?void 0:e.metadata)||void 0===l?void 0:l.namespace)===(null===(r=null==t?void 0:t.spec)||void 0===r?void 0:r.sourceNamespace)}),F=(e=[],t)=>e.find(e=>{var a,n;return(null===(a=null==e?void 0:e.metadata)||void 0===a?void 0:a.name)===(null===(n=null==t?void 0:t.status)||void 0===n?void 0:n.installedCSV)}),I=(e=[],t)=>e.find(e=>{var a,n,l,r,s,c,o,i;return(null===(a=null==e?void 0:e.metadata)||void 0===a?void 0:a.name)===(null===(n=null==t?void 0:t.spec)||void 0===n?void 0:n.name)&&(null===(l=null==e?void 0:e.status)||void 0===l?void 0:l.packageName)===(null===(r=null==t?void 0:t.spec)||void 0===r?void 0:r.name)&&(null===(s=null==e?void 0:e.status)||void 0===s?void 0:s.catalogSource)===(null===(c=null==t?void 0:t.spec)||void 0===c?void 0:c.source)&&(null===(o=null==e?void 0:e.status)||void 0===o?void 0:o.catalogSourceNamespace)===(null===(i=null==t?void 0:t.spec)||void 0===i?void 0:i.sourceNamespace)}),A=(e=[],t)=>e.find(e=>{var a,n,l;return(null===(a=null==e?void 0:e.metadata)||void 0===a?void 0:a.name)===(null===(l=null===(n=null==t?void 0:t.status)||void 0===n?void 0:n.installPlanRef)||void 0===l?void 0:l.name)}),H=()=>{const{t:e}=Object(v.useTranslation)();return n.createElement(n.Fragment,null,n.createElement(S.rc,{title:e("olm~Cannot update")}),n.createElement("span",{className:"text-muted"},e("olm~CatalogSource not found")))},U=()=>{const{t:e}=Object(v.useTranslation)();return n.createElement(n.Fragment,null,n.createElement(S.rc,{title:e("olm~Cannot update")}),n.createElement("span",{className:"text-muted"},e("olm~CatalogSource unhealthy")))},$=["","","pf-m-hidden pf-m-visible-on-md","pf-m-hidden pf-m-visible-on-lg","pf-m-hidden pf-m-visible-on-xl",O.F.columnClass],x=({subscription:e})=>{const{t:t}=Object(v.useTranslation)(),a=Object(O.uc)(j.InstallPlanModel,e.status.installPlanRef.name,e.metadata.namespace);return n.createElement("span",{className:"co-icon-and-text"},n.createElement(b.Link,{to:a},n.createElement(S.n,null)," ",t("olm~Upgrade available")))},L=({subscription:e})=>{var t;const{t:a}=Object(v.useTranslation)();switch(null===(t=e.status)||void 0===t?void 0:t.state){case C.g.SubscriptionStateUpgradeAvailable:return n.createElement("span",null,n.createElement(S.tc,null)," ",a("olm~Upgrade available"));case C.g.SubscriptionStateUpgradePending:return Object(w.b)(e)&&e.status.installPlanRef?n.createElement(x,{subscription:e}):n.createElement("span",null,n.createElement(c.a,{className:"text-primary"})," ",a("olm~Upgrading"));case C.g.SubscriptionStateAtLatest:return n.createElement("span",null,n.createElement(S.X,null)," ",a("olm~Up to date"));default:return n.createElement("span",{className:m.a(e.status.state)?"text-muted":""},e.status.state||a("olm~Unknown failure"))}},R=[O.F.factory.Edit,(e,t)=>({labelKey:"olm~Remove Subscription",callback:()=>Object(M.a)({k8sKill:k.lb,k8sGet:k.kb,k8sPatch:k.pb,subscription:t}),accessReview:{group:e.apiGroup,resource:e.plural,name:t.metadata.name,namespace:t.metadata.namespace,verb:"delete"}}),(e,t)=>{const a=u.a(t,"status.installedCSV");return{labelKey:"olm~View ClusterServiceVersion...",href:`/k8s/ns/${t.metadata.namespace}/${j.ClusterServiceVersionModel.plural}/${a}`,hidden:!a}}],K=({obj:e})=>{const{t:t}=Object(v.useTranslation)();return n.createElement(n.Fragment,null,n.createElement(f.k,{className:$[0]},n.createElement(O.hb,{kind:Object(k.Hb)(j.SubscriptionModel),name:e.metadata.name,namespace:e.metadata.namespace})),n.createElement(f.k,{className:$[1]},n.createElement(O.hb,{kind:"Namespace",name:e.metadata.namespace})),n.createElement(f.k,{className:$[2]},n.createElement(L,{subscription:e})),n.createElement(f.k,{className:d($[3],"co-truncate","co-select-to-copy")},e.spec.channel||"default"),n.createElement(f.k,{className:$[4]},e.spec.installPlanApproval||t("olm~Automatic")),n.createElement(f.k,{className:$[5]},n.createElement(O.gb,{actions:R,kind:Object(k.Hb)(j.SubscriptionModel),resource:e})))},G=Object(T.f)(e=>{const{t:t}=Object(v.useTranslation)();return n.createElement(f.j,Object.assign({},e,{"aria-label":t("olm~Operator Subscriptions"),Header:()=>[{title:t("olm~Name"),sortField:"metadata.name",transforms:[i.a],props:{className:$[0]}},{title:t("olm~Namespace"),sortField:"metadata.namespace",transforms:[i.a],props:{className:$[1]}},{title:t("olm~Status"),props:{className:$[2]}},{title:t("olm~Update channel"),props:{className:$[3]}},{title:t("olm~Update approval"),props:{className:$[4]}},{title:"",props:{className:$[5]}}],Row:K,EmptyMsg:()=>n.createElement(O.h,{title:t("olm~No Subscriptions found")},t("olm~Each Namespace can subscribe to a single channel of a package for automatic updates.")),virtualize:!0}))}),q=e=>{const{t:t}=Object(v.useTranslation)();return n.createElement(f.i,Object.assign({},e,{resources:[{kind:Object(k.Hb)(j.SubscriptionModel),namespace:e.namespace,namespaced:!0,prop:"subscription"},{kind:Object(k.Hb)(j.OperatorGroupModel),namespace:e.namespace,namespaced:!0,prop:"operatorGroup"}],flatten:e=>u.a(e.subscription,"data",[]),title:t("olm~Subscriptions"),canCreate:!0,createProps:{to:"/operatorhub"},createButtonText:t("olm~Create Subscription"),ListComponent:G,filterLabel:t("olm~Subscriptions by package")}))},B=({health:e,source:t,sourceNamespace:a})=>{const{t:r}=Object(v.useTranslation)();return e?e.healthy?null:n.createElement(l.a,{isInline:!0,className:"co-alert",variant:"warning",title:r("olm~CatalogSource unhealthy")},r('olm~This operator cannot be updated. CatalogSource "{{source}}" is unhealthy.',{source:t}),n.createElement(O.hb,{displayName:r("olm~View CatalogSource"),groupVersionKind:Object(g.getGroupVersionKindForModel)(j.CatalogSourceModel),name:t,namespace:a,title:t})):n.createElement(l.a,{isInline:!0,className:"co-alert",variant:"warning",title:r("olm~CatalogSource health unknown")},r('olm~This operator cannot be updated. The health of CatalogSource "{{source}}" is unknown. It may have been disabled or removed from the cluster.',{source:t}),t&&a&&n.createElement(O.hb,{displayName:r("olm~View CatalogSource"),groupVersionKind:Object(g.getGroupVersionKindForModel)(j.CatalogSourceModel),name:t,namespace:a,title:t}))},X=({installPlan:e})=>{var t,a,r;const{t:s}=Object(v.useTranslation)(),c=null===(t=null==e?void 0:e.status)||void 0===t?void 0:t.phase,o=null===(r=null===(a=null==e?void 0:e.status)||void 0===a?void 0:a.conditions)||void 0===r?void 0:r.find(({type:e,status:t})=>"Installed"===e&&"False"===t),i=(null==o?void 0:o.message)||(null==o?void 0:o.reason)||s("olm~InstallPlan failed");return c===C.f.InstallPlanPhaseFailed?n.createElement(l.a,{isInline:!0,className:"co-alert co-alert--scrollable",variant:"danger",title:c},i):null},Y=({healthy:e})=>{const{t:t}=Object(v.useTranslation)();switch(e){case!0:return n.createElement(E.A,{icon:n.createElement(S.X,null),title:t("olm~Healthy")});case!1:return n.createElement(E.A,{icon:n.createElement(S.Mb,null),title:t("olm~Unhealthy")});default:return n.createElement(E.A,{icon:n.createElement(S.tc,null),title:t("olm~Health unknown")})}},z=({clusterServiceVersions:e=[],installPlans:t=[],obj:a,packageManifests:l=[],subscriptions:r=[]})=>{var s,c,o,i;const{t:d}=Object(v.useTranslation)(),{source:m,sourceNamespace:u}=null!==(s=null==a?void 0:a.spec)&&void 0!==s?s:{},b=null===(o=null===(c=null==a?void 0:a.status)||void 0===c?void 0:c.catalogHealth)||void 0===o?void 0:o.find(e=>e.catalogSourceRef.name===m),g=F(e,a),f=A(t,a),C=I(l,a);new URLSearchParams(window.location.search).has("showDelete")&&Object(M.a)({k8sKill:k.lb,k8sGet:k.kb,k8sPatch:k.pb,subscription:a}).result.then(()=>Object(N.c)("showDelete")).catch(p.a);const{deprecatedPackage:w,deprecatedChannel:y,deprecatedVersion:P}=Object(_.d)(a);return n.createElement(n.Fragment,null,n.createElement("div",{className:"co-m-pane__body"},n.createElement(B,{health:b,source:m,sourceNamespace:u}),n.createElement(X,{installPlan:f}),(w.deprecation||y.deprecation||P.deprecation)&&n.createElement(_.a,{deprecatedPackage:w,deprecatedChannel:y,deprecatedVersion:P,dismissible:!0}),n.createElement(O.ob,{text:d("olm~Subscription details")}),n.createElement("div",{className:"co-m-pane__body-group"},n.createElement(W,{catalogHealth:b,pkg:C,obj:a,installedCSV:g,installPlan:f,subscriptions:r})),n.createElement("div",{className:"co-m-pane__body-group"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col-sm-6"},n.createElement(O.lb,{resource:a,showAnnotations:!1})),n.createElement("div",{className:"col-sm-6"},n.createElement("dl",{className:"co-m-pane__details"},n.createElement("dt",null,d("olm~Installed version")),n.createElement("dd",null,g?n.createElement(O.hb,{kind:Object(k.Hb)(j.ClusterServiceVersionModel),name:Object(S.dd)(g),namespace:Object(S.ed)(g),title:Object(S.dd)(g)}):d("olm~None")),n.createElement("dt",null,d("olm~Starting version")),n.createElement("dd",null,a.spec.startingCSV||d("olm~None")),n.createElement("dt",null,d("olm~CatalogSource")),n.createElement("dd",null,m&&u?n.createElement(O.hb,{kind:Object(k.Hb)(j.CatalogSourceModel),name:m,namespace:u,title:m},n.createElement(E.v,{badgeAlt:!0},n.createElement(Y,{healthy:null==b?void 0:b.healthy}))):d("olm~None")),n.createElement("dt",null,d("olm~InstallPlan")),n.createElement("dd",null,f?n.createElement(O.hb,{kind:Object(k.Hb)(j.InstallPlanModel),name:Object(S.dd)(f),namespace:Object(S.ed)(f),title:Object(S.dd)(f)}):d("olm~None"))))))),n.createElement("div",{className:"co-m-pane__body"},n.createElement(O.ob,{text:d("olm~Conditions")}),n.createElement(h.b,{conditions:null===(i=null==a?void 0:a.status)||void 0===i?void 0:i.conditions})))},J=({catalogHealth:e,subscription:t})=>e?e.healthy?n.createElement(L,{subscription:t}):n.createElement(U,null):n.createElement(H,null),W=({catalogHealth:e,installedCSV:t,installPlan:a,obj:l,pkg:c,subscriptions:i})=>{var d,m,u,p,E;const{t:g}=Object(v.useTranslation)(),h=n.useRef(null===(d=null==l?void 0:l.spec)||void 0===d?void 0:d.installPlanApproval),f=n.useRef(null===(m=null==l?void 0:l.spec)||void 0===m?void 0:m.channel),[N,w]=n.useState(!1);n.useEffect(()=>{var e,t,a,n;N&&(null===(e=null==l?void 0:l.spec)||void 0===e?void 0:e.channel)===f.current&&(null===(t=null==l?void 0:l.spec)||void 0===t?void 0:t.installPlanApproval)===h.current||(w(!1),f.current=null===(a=null==l?void 0:l.spec)||void 0===a?void 0:a.channel,h.current=null===(n=null==l?void 0:l.spec)||void 0===n?void 0:n.installPlanApproval)},[l,N]);const M=(e,t)=>Object(k.rb)(e,t).then(()=>w(!0)),T=n.useMemo(()=>{var e;if(a)switch(null===(e=a.status)||void 0===e?void 0:e.phase){case C.f.InstallPlanPhaseRequiresApproval:return n.createElement("span",{"data-test":"operator-subscription-requires-approval"},g("olm~1 requires approval"));case C.f.InstallPlanPhaseFailed:return g("olm~1 failed");default:return g("olm~1 installing")}return null},[a,g]),D=Object(V.f)(i,l.metadata.namespace),{deprecatedChannel:F}=Object(_.d)(l);return n.createElement("div",{className:"co-detail-table"},n.createElement("div",{className:"co-detail-table__row row"},n.createElement("div",{className:"co-detail-table__section col-sm-3"},n.createElement("dl",{className:"co-m-pane__details"},n.createElement("dt",{className:"co-detail-table__section-header"},g("olm~Update channel"),n.createElement(O.B,null,g("olm~The channel to track and receive the updates from."))),n.createElement("dd",null,N?n.createElement(O.T,null):n.createElement(n.Fragment,null,n.createElement(r.a,{type:"button",isInline:!0,onClick:()=>Object(P.a)({subscription:l,pkg:c,k8sUpdate:M}),variant:"link",isDisabled:!c,"data-test":"subscription-channel-update-button"},l.spec.channel||"default",c&&n.createElement(o.a,{className:"co-icon-space-l pf-v5-c-button-icon--plain"})),F.deprecation&&n.createElement(_.c,{dataTest:"deprecated-operator-warning-subscription-update-icon",deprecation:F.deprecation}))))),n.createElement("div",{className:"co-detail-table__section col-sm-3"},n.createElement("dl",{className:"co-m-pane__details"},n.createElement("dt",{className:"co-detail-table__section-header"},g("olm~Update approval"),n.createElement(O.B,null,g("olm~The strategy to determine either manual or automatic updates."))),n.createElement("dd",null,N?n.createElement(O.T,null):n.createElement(n.Fragment,null,n.createElement("div",null,n.createElement(r.a,{type:"button",isInline:!0,onClick:()=>Object(y.a)({obj:l,k8sUpdate:M}),variant:"link"},l.spec.installPlanApproval||"Automatic",n.createElement(o.a,{className:"co-icon-space-l pf-v5-c-button-icon--plain"}))),l.spec.installPlanApproval===C.e.Automatic&&(null==D?void 0:D.length)>0&&n.createElement("div",null,n.createElement(s.a,{headerContent:n.createElement(n.Fragment,null,g("olm~Functioning as manual approval strategy")),bodyContent:n.createElement(V.b,{subscriptions:D,namespace:l.metadata.namespace})},n.createElement(r.a,{type:"button",isInline:!0,variant:"link"},n.createElement(S.o,{className:"co-icon-space-r"}),g("olm~Functioning as manual")))))))),n.createElement("div",{className:"co-detail-table__section co-detail-table__section--last col-sm-6"},n.createElement("dl",{className:"co-m-pane__details"},n.createElement("dt",{className:"co-detail-table__section-header"},g("olm~Upgrade status")),n.createElement("dd",null,n.createElement(J,{catalogHealth:e,subscription:l}))),e&&e.healthy&&n.createElement(n.Fragment,null,n.createElement("div",{className:"co-detail-table__bracket"}),n.createElement("div",{className:"co-detail-table__breakdown"},(null===(u=null==l?void 0:l.status)||void 0===u?void 0:u.installedCSV)&&t?n.createElement(b.Link,{to:`/k8s/ns/${l.metadata.namespace}/${Object(k.Hb)(j.ClusterServiceVersionModel)}/${l.status.installedCSV}`},g("olm~1 installed")):n.createElement("span",null,g("olm~0 installed")),(null===(p=null==l?void 0:l.status)||void 0===p?void 0:p.state)===C.g.SubscriptionStateUpgradePending&&(null===(E=null==l?void 0:l.status)||void 0===E?void 0:E.installPlanRef)&&a?n.createElement(b.Link,{to:`/k8s/ns/${l.metadata.namespace}/${Object(k.Hb)(j.InstallPlanModel)}/${l.status.installPlanRef.name}`},n.createElement("span",null,T)):n.createElement("span",null,g("olm~0 installing")))))))},Q=e=>{const t=Object(b.useParams)();return n.createElement(f.a,Object.assign({},e,{namespace:t.ns,kind:Object(k.Hb)(j.SubscriptionModel),name:t.name,pages:[O.mc.details(z),O.mc.editYaml()],resources:[{kind:Object(k.Hb)(j.PackageManifestModel),isList:!0,namespace:e.namespace,prop:"packageManifests"},{kind:Object(k.Hb)(j.InstallPlanModel),isList:!0,namespace:e.namespace,prop:"installPlans"},{kind:Object(k.Hb)(j.ClusterServiceVersionModel),namespace:e.namespace,isList:!0,prop:"clusterServiceVersions"},{kind:Object(k.Hb)(j.SubscriptionModel),namespace:e.namespace,isList:!0,prop:"subscriptions"}],menuActions:R}))};q.displayName="SubscriptionsPage",z.displayName="SubscriptionDetails",Q.displayName="SubscriptionDetailsPage"},5737:function(e,t,a){"use strict";a.d(t,"d",(function(){return p})),a.d(t,"b",(function(){return v})),a.d(t,"c",(function(){return b})),a.d(t,"a",(function(){return E}));var n,l=a(0),r=a(88),s=a(351),c=a(6351),o=a(80),i=a(1939),d=a(7),m=a(976);!function(e){e.PackageDeprecated="PackageDeprecated",e.ChannelDeprecated="ChannelDeprecated",e.VersionDeprecated="BundleDeprecated"}(n||(n={}));const u=(e,t)=>{var a,n;return{deprecation:null===(n=null===(a=null==e?void 0:e.status)||void 0===a?void 0:a.conditions)||void 0===n?void 0:n.find(e=>e.type===t)}},p=e=>({deprecatedPackage:u(e,n.PackageDeprecated),deprecatedChannel:u(e,n.ChannelDeprecated),deprecatedVersion:u(e,n.VersionDeprecated)}),v=({deprecation:e,className:t})=>{const{t:a}=Object(d.useTranslation)();return l.createElement(r.a,{content:a("olm~Deprecated: {{message}}",{message:null==e?void 0:e.message})},l.createElement(s.a,{"data-test":"deprecated-operator-warning-badge",color:"orange",className:t,icon:l.createElement(m.Y,null)},a("olm~Deprecated")))},b=({deprecation:e,dataTest:t})=>{const{t:a}=Object(d.useTranslation)();return l.createElement(r.a,{content:a("olm~Deprecated: {{message}}",{message:null==e?void 0:e.message})},l.createElement(m.Y,{dataTest:t,className:"pf-v5-u-ml-xs"}))},E=({deprecatedPackage:e,deprecatedChannel:t,deprecatedVersion:a,dismissible:n})=>{var r,s,m;const{t:u}=Object(d.useTranslation)(),[p,v]=l.useState(!0);return p&&l.createElement(c.a,{className:"pf-v5-u-my-md"},l.createElement(o.a,{variant:"warning",title:u("olm~Deprecated warnings"),"aria-live":"polite",isInline:!0,actionClose:n&&l.createElement(i.a,{onClose:()=>v(!1)})},l.createElement("div",{"data-test":"deprecated-operator-warning-package"},null===(r=null==e?void 0:e.deprecation)||void 0===r?void 0:r.message),l.createElement("div",{"data-test":"deprecated-operator-warning-channel"},null===(s=null==t?void 0:t.deprecation)||void 0===s?void 0:s.message),l.createElement("div",{"data-test":"deprecated-operator-warning-version"},null===(m=null==a?void 0:a.deprecation)||void 0===m?void 0:m.message)))}},5942:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return d}));var n=a(0),l=a(18),r=a(14),s=a(5),c=a(8),o=a(125);const i=()=>window.location.pathname.split("/").find((e,t,a)=>a[t-1]===Object(c.Hb)(o.ClusterServiceVersionModel)||a[t-1]===o.ClusterServiceVersionModel.plural),d=e=>{const{namespace:t,name:a}=e.obj.metadata,d=e.csvName||i(),m=Object(c.Db)(e.obj),u=t?`/k8s/ns/${t}/${o.ClusterServiceVersionModel.plural}/${d}/${m}/${a}`:`/k8s/cluster/${m}/${a}`,p=l("co-resource-item",{"co-resource-item--inline":e.inline});return n.createElement("span",{className:p},n.createElement(s.fb,{kind:Object(c.Db)(e.obj)}),n.createElement(r.Link,{to:u,className:"co-resource-item__resource-name",onClick:e.onClick,"data-test-operand-link":a,"data-test":a},a))};d.displayName="OperandLink"},6017:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(0);const l=({name:e,label:t,checked:a,onChange:l})=>n.createElement("div",{className:"form-group"},n.createElement("div",{className:"checkbox"},n.createElement("label",{className:"control-label"},n.createElement("input",{"data-test":t+"__checkbox",className:"form-checkbox",name:e,onChange:l,checked:a,"data-checked-state":a,type:"checkbox"}),t)))},6037:function(e,t,a){"use strict";a.d(t,"a",(function(){return L}));var n=a(0),l=a(4357),r=a(80),s=a(50),c=a(7),o=a(77),i=a(697),d=a(53),m=a(109),u=a(6017),p=a(118),v=a(5),b=a(108),E=a(175),g=a(10),h=a(8),f=a(15),O=a(30),N=a(2234),k=a(6176),S=a(197),j=a(474),C=a(125),w=a(5942),_=a(59),y=a(1947),P=function(e,t,a,n){return new(a||(a=Promise))((function(l,r){function s(e){try{o(n.next(e))}catch(e){r(e)}}function c(e){try{o(n.throw(e))}catch(e){r(e)}}function o(e){var t;e.done?l(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(s,c)}o((n=n.apply(e,t||[])).next())}))};const M={kind:"DeleteOptions",apiVersion:"v1",propagationPolicy:"Foreground"},T=({cancel:e,close:t,csv:a,k8sKill:l,subscription:r})=>{var s,w,T,F,I,x,L,R,K,G;const{t:q}=Object(c.useTranslation)(),[B,X,Y]=Object(N.a)(),[z,J]=n.useState(!0),[W,Q]=n.useState(!1),[Z,ee]=n.useState(!1),[te,ae]=n.useState(!1),[ne,le]=n.useState(0),[re,se]=n.useState(!1),[ce,oe]=n.useState([]),[ie,de]=n.useState(!1),[me,ue]=n.useState(""),pe=Object(E.d)({group:g.ConsoleOperatorConfigModel.apiGroup,resource:g.ConsoleOperatorConfigModel.plural,verb:"patch",name:O.p}),ve=Object(y.b)(null===(s=null==a?void 0:a.metadata)||void 0===s?void 0:s.annotations),[be]=Object(b.a)(pe&&ve.length>0?{kind:Object(h.Hb)(g.ConsoleOperatorConfigModel),isList:!1,name:O.p}:null),Ee=ve.filter(e=>Object(S.X)(be,e)),ge=!!be&&pe&&Ee.length>0,he=null===(w=null==r?void 0:r.spec)||void 0===w?void 0:w.name,fe=null===(T=null==r?void 0:r.metadata)||void 0===T?void 0:T.namespace,Oe=X||te,Ne=!Oe&&(!Z||re)&&W,ke=ce.length>0||""!==Y,Se="true"===(null===(I=null===(F=null==a?void 0:a.metadata)||void 0===F?void 0:F.annotations)||void 0===I?void 0:I["console.openshift.io/disable-operand-delete"]),[je,Ce,we]=Object(k.a)(he,fe),_e=n.useCallback(()=>P(void 0,void 0,void 0,(function*(){var e;const t=ge?Object(S.x)(be,Ee):null,a=[l(C.SubscriptionModel,r,{},M),...(null===(e=null==r?void 0:r.status)||void 0===e?void 0:e.installedCSV)&&(yield P(void 0,void 0,void 0,(function*(){try{return yield Object(o.j)({model:C.ClusterServiceVersionModel,name:r.status.installedCSV,ns:r.metadata.namespace}),!0}catch(e){return 404!==e.response.status&&ue(e.message),!1}})))?[l(C.ClusterServiceVersionModel,{metadata:{name:r.status.installedCSV,namespace:r.metadata.namespace}},{},M)]:[],...ge?[Object(h.pb)(g.ConsoleOperatorConfigModel,be,[t])]:[]];B(Promise.all(a)).then(()=>{Q(!0)}).catch(()=>{Q(!0)})})),[be,Ee,B,l,ge,r]),ye=n.useCallback(e=>{ae(!1),se(!0),e?_e():(de(!0),Q(!0))},[_e]),Pe=n.useCallback(()=>{const e=`${window.SERVER_FLAGS.basePath}api/list-operands/?name=${he}&namespace=${fe}`,t=setInterval(()=>{Object(m.c)(e).then(e=>{le(e.items.length),0===e.items.length&&(clearInterval(t),setTimeout(()=>ye(!0),1e3))}).catch(()=>{ye(!1)})},2e3);return t},[ye,he,fe]),Me=n.useCallback(()=>{var e;t(),(window.location.pathname.split("/").includes(r.metadata.name)||window.location.pathname.split("/").includes(null===(e=null==r?void 0:r.status)||void 0===e?void 0:e.installedCSV))&&v.Vb.push(Object(v.rc)(C.ClusterServiceVersionModel,Object(d.c)()))},[t,r]);n.useEffect(()=>{Ne&&!ke&&Me()},[Me,ke,Ne]),n.useEffect(()=>{let e;return te&&(e=Pe()),()=>{e&&clearInterval(e)}},[te,Pe]);const Te=(null===(x=null==a?void 0:a.spec)||void 0===x?void 0:x.displayName)||(null===(L=null==r?void 0:r.spec)||void 0===L?void 0:L.name),Ve=null===(R=null==a?void 0:a.metadata)||void 0===R?void 0:R.name,De=r.metadata.namespace===j.a?"all-namespaces":r.metadata.namespace,Fe=null===(G=null===(K=null==a?void 0:a.metadata)||void 0===K?void 0:K.annotations)||void 0===G?void 0:G[_.d.UninstallMessage],Ie=!Ce||je.length>0,Ae=n.createElement(n.Fragment,null,n.createElement("p",null,Ie&&n.createElement(n.Fragment,null," ",q("olm~Select the checkbox below to also remove all Operands associated with this Operator."))," ",q("olm~If your Operator configured off-cluster resources, these will continue to run and require manual cleanup.")),ge&&n.createElement("p",null,q("olm~The console plugin provided by this operator will be disabled and removed.",{count:Ee.length}))),He=we?n.createElement(D,{operandsLoadedErrorMessage:we}):Ie&&n.createElement(n.Fragment,null,n.createElement("span",{className:"co-operator-uninstall__operands-section"},n.createElement("h2",null,q("olm~Operand instances")),n.createElement($,{operands:je,loaded:Ce,csvName:Ve,cancel:e})),n.createElement(u.a,{onChange:({currentTarget:e})=>ee(e.checked),name:"delete-all-operands",label:q("olm~Delete all operand instances for this operator"),checked:Z})),Ue=ce.length?n.createElement(A,{operandDeletionErrors:ce,csvName:Ve,cancel:e}):ie?n.createElement(D,{operandsLoadedErrorMessage:q("olm~Error listing operand to verify deletion")}):n.createElement(H,{name:Te,namespace:De}),$e=n.createElement(n.Fragment,null,n.createElement(U,{errorMessage:me||Y||(ce.length?q("olm~Operator could not be uninstalled due to error deleting its Operands"):""),name:Te,namespace:De}),Z&&Ue);return n.createElement("form",{onSubmit:e=>{if(e.preventDefault(),Ne)Me();else if(J(!1),Z){ae(!0),le(je.length);const e=je.map(e=>{const t=Object(h.vb)(Object(h.Db)(e));return l(t,e,{},M)});Object(i.a)(e).then(([,,e])=>{const t=e.reduce((e,t,a)=>"rejected"===t.status?e.concat({operand:je[a],errorMessage:t.reason}):e,[]);t.length&&(oe(t),ae(!1),se(!0),Q(!0))})}else se(!0),_e()},name:"form",className:"modal-content co-catalog-install-modal"},n.createElement(p.d,{className:"modal-header"},n.createElement(f.tc,{className:"co-icon-space-r"})," ",q("olm~Uninstall Operator?")),n.createElement(p.a,null,z&&n.createElement(n.Fragment,null,n.createElement("p",null,n.createElement(c.Trans,{t:q,ns:"olm"},"Operator ",n.createElement("strong",null,{name:Te})," will be removed from"," ",n.createElement("strong",null,{namespace:De}),".")),!Se&&n.createElement(n.Fragment,null,Ae),Fe&&n.createElement(n.Fragment,null,n.createElement("h2",null,q("olm~Message from Operator developer")),n.createElement("p",null,Fe)),!Se&&n.createElement(n.Fragment,null,He)),te&&n.createElement(V,{total:je.length,remaining:ne}),X&&n.createElement("div",null,n.createElement("p",null,q("olm~Uninstalling the Operator..."))),Ne&&$e),n.createElement(p.c,{inProgress:Oe,cancel:e,submitDanger:!Ne,submitText:q(Ne?"olm~OK":"olm~Uninstall"),submitDisabled:Oe}))},V=({total:e,remaining:t})=>{const{t:a}=Object(c.useTranslation)(),r=a("olm~Remaining Operands: {{remaining}} of {{total}} ",{remaining:t,total:e});return n.createElement("div",null,n.createElement(l.a,{value:e-t,max:e,valueText:r,label:r,title:a("olm~Cleaning up operand instances..."),size:l.b.lg}),n.createElement("div",{className:"co-alert--margin-top"},n.createElement("p",null,a("olm~The operands have been marked for deletion and are being removed. Canceling this operation will leave the Operator installed though its operand instances will continue to be deleted."))))},D=({operandsLoadedErrorMessage:e})=>{const{t:t}=Object(c.useTranslation)();return n.createElement(r.a,{variant:"warning",className:"co-alert",title:t("olm~Cannot load Operands"),isInline:!0},n.createElement("p",null,t("olm~There was an error loading operands for this operator. Operands will need to be deleted manually.")),n.createElement("p",null,e))},F=({name:e,namespace:t})=>{const{t:a}=Object(c.useTranslation)();return n.createElement(r.a,{variant:"success",className:"co-alert",title:a("olm~Successfully uninstalled Operator"),isInline:!0},n.createElement("p",null,n.createElement(c.Trans,{t:a,ns:"olm"},"Operator ",n.createElement("strong",null,{name:e})," successfully uninstalled from"," ",n.createElement("strong",null,{namespace:t}),".")))},I=({errorMessage:e})=>{const{t:t}=Object(c.useTranslation)();return n.createElement(r.a,{variant:"danger",className:"co-alert",title:t("olm~Error uninstalling Operator"),isInline:!0},n.createElement("p",null,t("olm~There was an error uninstalling the operator."),n.createElement("br",null),e))},A=({operandDeletionErrors:e,csvName:t,cancel:a})=>{const{t:l}=Object(c.useTranslation)();return n.createElement(r.a,{variant:"danger",className:"co-alert",title:l("olm~Error deleting Operands"),isInline:!0},n.createElement("p",null,l("olm~There were errors deleting the following Operands, they will need to be deleted manually:")),n.createElement(x,{operandErrors:e,csvName:t,cancel:a}))},H=({name:e,namespace:t})=>{const{t:a}=Object(c.useTranslation)();return n.createElement(r.a,{variant:"success",className:"co-alert",title:a("olm~Successfully deleted all Operand Instances"),isInline:!0},n.createElement("p",null,n.createElement(c.Trans,{t:a,ns:"olm"},"All Operand instances for Operator ",n.createElement("strong",null,{name:e})," in"," ",n.createElement("strong",null,{namespace:t})," have been deleted.")))},U=({errorMessage:e,name:t,namespace:a})=>e?n.createElement(I,{errorMessage:e}):n.createElement(F,{name:t,namespace:a}),$=({operands:e,loaded:t,csvName:a,cancel:l})=>{const{t:r}=Object(c.useTranslation)();return n.createElement(v.wb,{skeleton:n.createElement("div",{className:"loading-skeleton--table"}),data:e,loaded:t},n.createElement("table",{className:"pf-v5-c-table pf-m-compact pf-m-border-rows"},n.createElement("thead",{className:"pf-v5-c-table__thead"},n.createElement("tr",{className:"pf-v5-c-table__tr",key:"operand-table-header-row"},n.createElement("th",{className:"pf-m-width-35 pf-v5-c-table__th"},r("olm~Name")),n.createElement("th",{className:"pf-v5-c-table__th"},r("olm~Kind")),n.createElement("th",{className:"pf-v5-c-table__th"},r("olm~Namespace")))),n.createElement("tbody",null,e.sort((e,t)=>e.metadata.name.localeCompare(t.metadata.name)).map(e=>n.createElement("tr",{className:"pf-v5-c-table__tr",key:e.metadata.uid},n.createElement("td",{className:"pf-v5-c-table__td"},n.createElement(w.a,{obj:e,csvName:a,onClick:l})),n.createElement("td",{className:"pf-v5-c-table__td pf-m-break-word","data-test-operand-kind":e.kind},e.kind),n.createElement("td",{className:"pf-v5-c-table__td"},e.metadata.namespace?n.createElement(v.hb,{kind:"Namespace",name:e.metadata.namespace,onClick:l}):"-"))))))},x=({operandErrors:e,csvName:t,cancel:a})=>{const{t:l}=Object(c.useTranslation)();return n.createElement("ul",{className:"co-operator-uninstall-alert__list"},s.a(e,e=>n.createElement("li",{key:e.operand.metadata.uid,className:"pf-v5-c-list pf-m-plain co-operator-uninstall-alert__list-item"},n.createElement(w.a,{obj:e.operand,csvName:t,onClick:a})," ",e.operand.kind,"  ",l("olm~Error: {{error}}",{error:e.errorMessage}))))},L=Object(p.f)(T);T.displayName="UninstallOperatorModal"},6176:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(0),l=a(182);const r=(e,t)=>{const[a,r]=n.useState([]),[s,c]=n.useState(!1),[o,i]=n.useState("");return n.useEffect(()=>{const a=`${window.SERVER_FLAGS.basePath}api/list-operands/?name=${e}&namespace=${t}`;Object(l.b)(a).then(e=>{var t;r(null!==(t=null==e?void 0:e.items)&&void 0!==t?t:[]),c(!0),i("")}).catch(a=>{r([]),c(!0),i(`Error loading Operands for ${e} in ${t}: ${a}`)})},[e,t]),[a,s,o]}},6177:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(0),l=a(640),r=a(489),s=a(7),c=a(118),o=a(692),i=a(8),d=a(2234),m=a(125),u=a(146);const p=e=>{var t,a,n,l,r,s;return null!==(s=null!==(n=null===(a=null===(t=e)||void 0===t?void 0:t.spec)||void 0===a?void 0:a.installPlanApproval)&&void 0!==n?n:null===(r=null===(l=e)||void 0===l?void 0:l.spec)||void 0===r?void 0:r.approval)&&void 0!==s?s:u.e.Automatic},v=Object(c.f)(({cancel:e,close:t,k8sUpdate:a,obj:v})=>{const{t:b}=Object(s.useTranslation)(),[E,g,h]=Object(d.a)(),[f,O]=n.useState(p(v)),N=n.useCallback(e=>{e.preventDefault();const n=l.a(v);Object(i.Db)(n)===Object(i.Hb)(m.SubscriptionModel)?n.spec.installPlanApproval=f:Object(i.Db)(n)===Object(i.Hb)(m.InstallPlanModel)&&(n.spec.approval=f),E(a(Object(i.vb)(Object(i.Db)(v)),n)).then(()=>null==t?void 0:t()).catch(r.a)},[t,E,a,v,f]);return n.createElement("form",{onSubmit:N,name:"form",className:"modal-content"},n.createElement(c.d,{className:"modal-header"},b("olm~Change update approval strategy")),n.createElement(c.a,null,n.createElement("div",{className:"co-m-form-row"},n.createElement("p",null,b("olm~What strategy is used for approving updates?"))),n.createElement("div",{className:"co-m-form-row row"},n.createElement("div",{className:"col-sm-12"},n.createElement(o.b,{onChange:e=>O(e.target.value),value:u.e.Automatic,checked:f===u.e.Automatic,title:b("olm~Automatic"),subTitle:`(${b("public~default")})`},n.createElement("div",{className:"co-m-radio-desc"},n.createElement("p",{className:"text-muted"},b("olm~New updates will be installed as soon as they become available."))))),n.createElement("div",{className:"col-sm-12"},n.createElement(o.b,{onChange:e=>O(e.target.value),value:u.e.Manual,checked:f===u.e.Manual,title:b("olm~Manual")},n.createElement("div",{className:"co-m-radio-desc"},n.createElement("p",{className:"text-muted"},b("olm~New updates need to be manually approved before installation begins."))))))),n.createElement(c.c,{inProgress:g,errorMessage:h,cancel:e,submitText:b("public~Save"),submitDisabled:p(v)===f}))})},6178:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(0),l=a(7),r=a(118),s=a(692),c=a(5),o=a(8),i=a(2234),d=a(125),m=a(5737);const u=Object(r.f)(({cancel:e,close:t,k8sUpdate:a,pkg:u,subscription:p})=>{var v,b,E,g,h,f,O,N;const{t:k}=Object(l.useTranslation)(),S=null!==(b=null===(v=null==p?void 0:p.spec)||void 0===v?void 0:v.channel)&&void 0!==b?b:null===(h=null===(g=null===(E=null==u?void 0:u.status)||void 0===E?void 0:E.channels)||void 0===g?void 0:g[0])||void 0===h?void 0:h.name,[j,C,w]=Object(i.a)(),[_,y]=n.useState(S),P=n.useCallback(e=>{e.preventDefault(),j(a(d.SubscriptionModel,Object.assign(Object.assign({},p),{spec:Object.assign(Object.assign({},p.spec),{channel:_})}))).then(()=>null==t?void 0:t()).catch(()=>{})},[t,j,a,_,p]);return n.createElement("form",{onSubmit:P,name:"form",className:"modal-content"},n.createElement(r.d,{className:"modal-header"},k("olm~Change Subscription update channel")),n.createElement(r.a,null,n.createElement("div",{className:"co-m-form-row"},n.createElement("p",null,k("olm~Which channel is used to receive updates?"))),n.createElement("div",{className:"co-m-form-row row"},null===(N=null===(O=null===(f=null==u?void 0:u.status)||void 0===f?void 0:f.channels)||void 0===O?void 0:O.map)||void 0===N?void 0:N.call(O,e=>n.createElement("div",{key:e.name,className:"col-sm-12"},n.createElement(s.b,{onChange:e=>y(e.target.value),value:e.name,checked:_===e.name,title:e.name,subTitle:n.createElement(c.hb,{linkTo:!1,name:e.currentCSV,title:e.currentCSV,kind:Object(o.Hb)(d.ClusterServiceVersionModel)},(null==e?void 0:e.deprecation)?n.createElement(m.c,{deprecation:null==e?void 0:e.deprecation}):null)}))))),n.createElement(r.c,{inProgress:C,errorMessage:w,cancel:e,submitText:k("public~Save"),submitDisabled:_===S}))})},6351:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(12),l=a(0),r=a(4),s=a(189);const c=e=>{var{children:t=null,className:a=""}=e,c=Object(n.__rest)(e,["children","className"]);return l.createElement("div",Object.assign({},c,{className:Object(r.css)(s.a.form+"__alert",a)}),t)};c.displayName="FormAlert"}}]);
//# sourceMappingURL=subscriptions-chunk-74035077917cf1a91049.min.js.map