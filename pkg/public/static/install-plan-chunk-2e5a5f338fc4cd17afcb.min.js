(window.webpackJsonp=window.webpackJsonp||[]).push([[181],{4384:function(e,a,t){"use strict";t.r(a),t.d(a,"InstallPlanTableRow",(function(){return w})),t.d(a,"InstallPlansList",(function(){return C})),t.d(a,"InstallPlansPage",(function(){return F})),t.d(a,"NeedInstallPlanPermissions",(function(){return T})),t.d(a,"InstallPlanDetails",(function(){return D})),t.d(a,"InstallPlanPreview",(function(){return A})),t.d(a,"InstallPlanDetailsPage",(function(){return $}));var n=t(0),l=t(80),s=t(19),c=t(54),r=t(18),m=t(61),o=t(255),i=t(16),p=t(7),d=t(31),u=t(14),b=t(13),v=t(972),E=t(40),f=t(131),N=t(5),P=t(773),O=t(8),j=t(15),h=t(125),_=t(146),I=t(6086),k=t(2235),g=t(1405);const y=["pf-v5-c-table__td","pf-v5-c-table__td",r("pf-m-hidden","pf-m-visible-on-sm","pf-v5-u-w-16-on-lg","pf-v5-c-table__td"),r("pf-m-hidden","pf-m-visible-on-lg","pf-v5-c-table__td"),r("pf-m-hidden","pf-m-visible-on-xl","pf-v5-c-table__td"),N.F.columnClass],M=["pf-v5-c-table__td","pf-v5-c-table__td",r("pf-m-hidden","pf-m-visible-on-sm","pf-v5-u-w-16-on-lg","pf-v5-c-table__td"),r("pf-m-hidden","pf-m-visible-on-lg","pf-v5-c-table__td")],w=({obj:e})=>{var a,t;const{t:l}=Object(p.useTranslation)();return n.createElement(n.Fragment,null,n.createElement(E.k,{className:y[0]},n.createElement(N.hb,{kind:Object(O.Hb)(h.InstallPlanModel),namespace:e.metadata.namespace,name:e.metadata.name})),n.createElement(E.k,{className:y[1]},n.createElement(N.hb,{kind:"Namespace",name:e.metadata.namespace})),n.createElement(E.k,{className:y[2]},(s=null!==(t=null===(a=e.status)||void 0===a?void 0:a.phase)&&void 0!==t?t:"Unknown",n.createElement(j.cc,{status:s}))),n.createElement(E.k,{className:y[3]},n.createElement("ul",{className:"pf-v5-c-list pf-m-plain"},e.spec.clusterServiceVersionNames.map(a=>{var t;return n.createElement("li",{key:a},"Complete"===(null===(t=e.status)||void 0===t?void 0:t.phase)?n.createElement(N.hb,{kind:Object(O.Hb)(h.ClusterServiceVersionModel),name:a,namespace:e.metadata.namespace,title:a}):n.createElement(n.Fragment,null,n.createElement(N.fb,{kind:Object(O.Hb)(h.ClusterServiceVersionModel)}),a))}))),n.createElement(E.k,{className:y[4]},(e.metadata.ownerReferences||[]).filter(e=>Object(O.Ib)(e)===Object(O.Hb)(h.SubscriptionModel)).map(a=>n.createElement("ul",{key:a.uid,className:"pf-v5-c-list pf-m-plain"},n.createElement("li",null,n.createElement(N.hb,{kind:Object(O.Hb)(h.SubscriptionModel),name:a.name,namespace:e.metadata.namespace,title:a.uid}))))||n.createElement("span",{className:"text-muted"},l("olm~None"))),n.createElement(E.k,{className:y[5]},n.createElement(N.gb,{actions:N.F.factory.common,kind:Object(O.Hb)(h.InstallPlanModel),resource:e})));var s},S=()=>{const{t:e}=Object(p.useTranslation)();return n.createElement(N.h,{title:e("olm~No InstallPlans found")},e("olm~InstallPlans are created automatically by subscriptions or manually using the CLI."))},C=Object(k.f)(e=>{const{t:a}=Object(p.useTranslation)();return n.createElement(E.j,Object.assign({},e,{"aria-label":a("olm~InstallPlans"),Header:()=>[{title:a("olm~Name"),sortField:"metadata.name",transforms:[c.a],props:{className:y[0]}},{title:a("olm~Namespace"),sortField:"metadata.namespace",transforms:[c.a],props:{className:y[1]}},{title:a("olm~Status"),sortField:"status.phase",transforms:[c.a],props:{className:y[2]}},{title:a("olm~Components"),props:{className:y[3]}},{title:a("olm~Subscriptions"),props:{className:y[4]}},{title:"",props:{className:y[5]}}],Row:w,EmptyMsg:S}))}),F=e=>{const{t:a}=Object(p.useTranslation)(),t=Object(u.useParams)(),l=e.namespace||(null==t?void 0:t.ns);return n.createElement(E.i,Object.assign({},e,{namespace:l,resources:[{kind:Object(O.Hb)(h.InstallPlanModel),namespace:l,namespaced:!0,prop:"installPlan"},{kind:Object(O.Hb)(h.OperatorGroupModel),namespace:l,namespaced:!0,prop:"operatorGroup"}],flatten:e=>i.a(e.installPlan,"data",[]),title:a("olm~InstallPlans"),showTitle:!1,ListComponent:C}))},H=(e,a)=>e?null==a?void 0:a.username:P.b.name(),T=({installPlan:e})=>{const a=Object(j.Fe)(j.O.OPENSHIFT),t=Object(d.useSelector)(b.J),[s,c]=n.useState(H(a,t));n.useEffect(()=>{c(H(a,t))},[a,t]);const{t:r}=Object(p.useTranslation)(),m=Object(O.l)(Object(O.Db)(e));return n.createElement(l.a,{variant:"info",isInline:!0,title:r("olm~Missing sufficient privileges for manual InstallPlan approval")},s?r('olm~User "{{user}}" does not have permissions to patch resource InstallPlans in API group "{{apiGroup}}" in the namespace "{{namespace}}."',{user:s,apiGroup:m,namespace:e.metadata.namespace}):r('olm~User does not have permissions to patch resource InstallPlans in API group "{{apiGroup}}" in the namespace "{{namespace}}."',{apiGroup:m,namespace:e.metadata.namespace}))},D=({obj:e})=>{var a,t,l;const{t:c}=Object(p.useTranslation)(),r=e.spec.approval===_.e.Manual&&!1===e.spec.approved,i=Object(N.Dc)({group:h.InstallPlanModel.apiGroup,resource:h.InstallPlanModel.plural,namespace:e.metadata.namespace,verb:"patch"});return n.createElement(n.Fragment,null,r&&i&&n.createElement("div",{className:"co-m-pane__body"},n.createElement(N.D,{title:c("olm~Review manual InstallPlan")},n.createElement("p",null,c("olm~Inspect the requirements for the components specified in this InstallPlan before approving.")),n.createElement(u.Link,{to:`/k8s/ns/${e.metadata.namespace}/${Object(O.Hb)(h.InstallPlanModel)}/${e.metadata.name}/components`},n.createElement(s.a,{variant:"primary"},c("olm~Preview InstallPlan"))))),r&&!i&&n.createElement("div",{className:"co-m-pane__body"},n.createElement(T,{installPlan:e})),n.createElement("div",{className:"co-m-pane__body"},n.createElement(N.ob,{text:c("olm~InstallPlan details")}),n.createElement("div",{className:"co-m-pane__body-group"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col-sm-6"},n.createElement(N.lb,{resource:e,showAnnotations:!1})),n.createElement("div",{className:"col-sm-6"},n.createElement("dl",{className:"co-m-pane__details"},n.createElement("dt",null,c("olm~Status")),n.createElement("dd",null,n.createElement(j.cc,{status:null!==(t=null===(a=e.status)||void 0===a?void 0:a.phase)&&void 0!==t?t:c("olm~Unknown")})),n.createElement("dt",null,c("olm~Components")),(e.spec.clusterServiceVersionNames||[]).map(a=>n.createElement("dd",{key:a},"Complete"===e.status.phase?n.createElement(N.hb,{kind:Object(O.Hb)(h.ClusterServiceVersionModel),name:a,namespace:e.metadata.namespace,title:a}):n.createElement(n.Fragment,null,n.createElement(N.fb,{kind:Object(O.Hb)(h.ClusterServiceVersionModel)}),a))),n.createElement("dt",null,c("olm~CatalogSources")),(e=>{var a;return o.a((null===(a=null==e?void 0:e.status)||void 0===a?void 0:a.plan)||[],(e,{resource:{sourceName:a,sourceNamespace:t}})=>e.add(Object(m.fromJS)({sourceName:a,sourceNamespace:t})),Object(m.Set)()).toJS()})(e).map(({sourceName:e,sourceNamespace:a})=>n.createElement("dd",{key:`${a}-${e}`},n.createElement(N.hb,{kind:Object(O.Hb)(h.CatalogSourceModel),name:e,namespace:a,title:e})))))))),n.createElement("div",{className:"co-m-pane__body"},n.createElement(N.ob,{text:c("olm~Conditions")}),n.createElement(v.b,{conditions:null===(l=e.status)||void 0===l?void 0:l.conditions})))},A=({obj:e,hideApprovalBlock:a})=>{var t,l;const{t:c}=Object(p.useTranslation)(),[r,o]=n.useState(e.spec.approval===_.e.Manual&&!1===e.spec.approved),i=null===(t=null==e?void 0:e.metadata)||void 0===t?void 0:t.ownerReferences.find(e=>Object(O.Ib)(e)===Object(O.Hb)(h.SubscriptionModel)),d=(null===(l=null==e?void 0:e.status)||void 0===l?void 0:l.plan)||[],u=d.reduce((e,a)=>e.update(a.resolving,[],e=>e.concat([a])),Object(m.Map)()).toArray(),b=Object(N.Dc)({group:h.InstallPlanModel.apiGroup,resource:h.InstallPlanModel.plural,namespace:e.metadata.namespace,verb:"patch"});return d.length>0?n.createElement(n.Fragment,null,r&&!a&&!b&&n.createElement("div",{className:"co-m-pane__body"},n.createElement(T,{installPlan:e})),r&&!a&&b&&n.createElement("div",{className:"co-m-pane__body"},n.createElement(N.D,{title:c("olm~Review manual InstallPlan")},n.createElement(g.a,{installPlan:e}),n.createElement("div",{className:"pf-v5-c-form"},n.createElement("div",{className:"pf-v5-c-form__actions"},n.createElement(s.a,{variant:"primary",isDisabled:!r,onClick:()=>Object(O.pb)(h.InstallPlanModel,e,[{op:"replace",path:"/spec/approved",value:!0}]).then(()=>o(!1)).catch(e=>Object(f.s)({error:e.toString()}))},c(r?"olm~Approve":"olm~Approved")),n.createElement(s.a,{variant:"secondary",isDisabled:!1,onClick:()=>N.Vb.push(`/k8s/ns/${e.metadata.namespace}/${Object(O.Hb)(h.SubscriptionModel)}/${i.name}?showDelete=true`)},c("olm~Deny")))))),u.map(a=>n.createElement("div",{key:a[0].resolving,className:"co-m-pane__body"},n.createElement(N.ob,{text:a[0].resolving}),n.createElement("div",{className:"co-table-container"},n.createElement("table",{className:"pf-v5-c-table pf-m-compact pf-m-border-rows"},n.createElement("thead",{className:"pf-v5-c-table__thead"},n.createElement("tr",{className:"pf-v5-c-table__tr"},n.createElement("th",{className:M[0]},c("olm~Name")),n.createElement("th",{className:M[1]},c("olm~Kind")),n.createElement("th",{className:M[2]},c("olm~Status")),n.createElement("th",{className:M[3]},c("olm~API version")))),n.createElement("tbody",{className:"pf-v5-c-table__tbody"},a.map(a=>{return n.createElement("tr",{key:`${Object(g.m)(a.resource)}-${a.resource.name}`,className:"pf-v5-c-table__tr"},n.createElement("td",{className:M[0]},["Present","Created"].includes(a.status)?n.createElement(N.hb,{kind:Object(g.m)(a.resource),namespace:e.metadata.namespace,name:a.resource.name,title:a.resource.name}):n.createElement(n.Fragment,null,n.createElement(N.fb,{kind:Object(g.m)(a.resource)}),n.createElement(s.a,{type:"button",onClick:()=>Object(I.a)({stepResource:a.resource}),variant:"link"},a.resource.name))),n.createElement("td",{className:M[1]},a.resource.kind),n.createElement("td",{className:M[2]},(t=a.status,n.createElement(n.Fragment,null,"Present"===t&&n.createElement(j.X,{className:"co-icon-space-r"}),"Created"===t&&n.createElement(j.X,{className:"co-icon-space-r"}),t))),n.createElement("td",{className:M[3]},Object(O.o)(Object(g.m)(a.resource))));var t}))))))):n.createElement("div",{className:"co-m-pane__body"},n.createElement(N.h,{title:c("olm~No components resolved")},c("olm~This InstallPlan has not been fully resolved yet.")))},$=e=>{const a=Object(u.useParams)();return n.createElement(E.a,Object.assign({},e,{namespace:a.ns,kind:Object(O.Hb)(h.InstallPlanModel),name:a.name,pages:[N.mc.details(D),N.mc.editYaml(),{href:"components",nameKey:"olm~Components",component:A}],menuActions:[...N.F.getExtensionsActionsForKind(h.InstallPlanModel),...N.F.factory.common]}))};F.displayName="InstallPlansPage"},6086:function(e,a,t){"use strict";t.d(a,"a",(function(){return d}));var n=t(0),l=t(966),s=t(19),c=t(380),r=t(7),m=t(118),o=t(5),i=t(1405);const p=({cancel:e,stepResource:a})=>{const{t:t}=Object(r.useTranslation)();return n.createElement("div",{className:"modal-content"},n.createElement(m.d,null,t("olm~InstallPlan Preview")," ",n.createElement(o.hb,{linkTo:!1,name:a.name,kind:Object(i.m)(a)})),n.createElement(m.a,null,n.createElement(o.l,{value:Object(c.safeDump)(JSON.parse(a.manifest))})),n.createElement(m.b,{inProgress:!1},n.createElement(l.a,{className:"pf-v5-c-form pf-v5-c-form__actions--right pf-v5-c-form__group--no-top-margin"},n.createElement(s.a,{type:"button",variant:"secondary",onClick:()=>e()},t("public~OK")))))},d=Object(m.f)(p);p.displayName="InstallPlanPreview"}}]);
//# sourceMappingURL=install-plan-chunk-2e5a5f338fc4cd17afcb.min.js.map