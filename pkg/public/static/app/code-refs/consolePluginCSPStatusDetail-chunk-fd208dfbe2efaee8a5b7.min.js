(window.webpackJsonp=window.webpackJsonp||[]).push([[84],{5412:function(e,n,a){"use strict";a.r(n),a.d(n,"developmentMode",(function(){return N})),a.d(n,"useConsoleOperatorConfigData",(function(){return T})),a.d(n,"ConsolePluginStatus",(function(){return D})),a.d(n,"ConsolePluginEnabledStatus",(function(){return _})),a.d(n,"ConsolePluginCSPStatus",(function(){return x})),a.d(n,"ConsoleOperatorConfigDetailsPage",(function(){return H}));var o=a(0),t=a(19),l=a(80),i=a(615),s=a(469),r=a(1340),c=a(2140),d=a(740),u=a(955),m=a(1373),p=a(1182),v=a(7),b=a(764),g=a(14),C=a(13),f=a(77),E=a(988),O=a(872),h=a(40),j=a(5),M=a(108),P=a(10),S=a(8),k=a(69),w=a(991),L=a(15),y=a(6272);const N="off-cluster"===window.SERVER_FLAGS.k8sMode,V=Object(f.b)(P.ConsolePluginModel),F=Object(f.e)(P.ConsolePluginModel),I=Object(S.Hb)(P.ConsoleOperatorConfigModel),T=()=>{const e={kind:Object(S.Hb)(P.ConsoleOperatorConfigModel),isList:!1,name:L.v},[n,a]=Object(M.a)(e),t=Object(C.hc)({group:P.ConsoleOperatorConfigModel.apiGroup,resource:P.ConsoleOperatorConfigModel.plural,verb:"patch",name:L.v});return o.useMemo(()=>({consoleOperatorConfig:n,consoleOperatorConfigLoaded:a,canPatchConsoleOperatorConfig:t}),[n,a,t])},D=({status:e,errorMessage:n})=>o.createElement(L.cc,{status:e,title:"Failed"===e?n:void 0}),_=({pluginName:e,enabled:n})=>{const{t:a}=Object(v.useTranslation)(),{consoleOperatorConfig:l,consoleOperatorConfigLoaded:s,canPatchConsoleOperatorConfig:r}=T(),c=a(n?"console-app~Enabled":"console-app~Disabled");return o.createElement(o.Fragment,null,s&&r&&!N?o.createElement(t.a,{"data-test":"edit-console-plugin",type:"button",isInline:!0,onClick:()=>Object(L.wc)({consoleOperatorConfig:l,pluginName:e,trusted:!1}),variant:"link"},c,o.createElement(i.a,{className:"co-icon-space-l pf-v5-c-button-icon--plain"})):o.createElement(o.Fragment,null,c))},x=({hasViolations:e})=>{const{t:n}=Object(v.useTranslation)();return e?o.createElement(o.Fragment,null,o.createElement(L.tc,{className:"co-icon-space-r",title:n("console-app~This plugin might have violated the Console Content Security Policy. Refer to the browser's console logs for details.")})," ",n("console-app~Yes")):o.createElement(o.Fragment,null,o.createElement(L.X,{className:"co-icon-space-r"})," ",n("console-app~No"))},K=({obj:e,rows:n,loaded:a})=>{var i;const{t:g}=Object(v.useTranslation)(),[C,f]=o.useState(()=>({index:0,direction:s.a.asc})),E=o.useCallback((e,n,a)=>{f({index:n,direction:a})},[]),O=o.useMemo(()=>[{id:"name",name:g("console-app~Name"),sortable:!0},{id:"version",name:g("console-app~Version")},{id:"description",name:g("console-app~Description")},{id:"status",name:g("console-app~Status"),sortable:!0},{id:"enabled",name:g("console-app~Enabled"),sortable:!0},{id:"csp-violations",name:g("console-app~CSP violations")}],[g]),h=o.useCallback((e,n)=>{const{index:a,direction:o}=C,{id:t}=O[a],l=o===s.a.desc,i=(l?n:e)[t],r=(l?e:n)[t];switch(t){case"enabled":return Object(y.a)(i,r);default:return Object(y.b)(i,r)}},[O,C]),M=o.useMemo(()=>n.sort(h),[n,h]);return a?o.createElement("div",{className:"co-m-pane__body"},"Unmanaged"===(null===(i=e.spec)||void 0===i?void 0:i.managementState)&&o.createElement(l.a,{className:"co-alert",variant:"info",isInline:!0,title:g("console-app~Console operator spec.managementState is unmanaged. Changes to plugins will have no effect.")}),o.createElement(j.eb,{model:P.ConsolePluginModel},o.createElement("div",{className:"co-m-pane__createLink--no-title"},o.createElement(b.Link,{className:"co-m-primary-action",to:`/k8s/cluster/${F}/~new`},o.createElement(t.a,{variant:"primary",id:"yaml-create","data-test":"item-create"},g("public~Create {{label}}",{label:g(P.ConsolePluginModel.label)}))))),n.length?o.createElement(r.a,{"aria-label":"console plugins table",ouiaId:"ConsolePluginsTable"},o.createElement(c.a,null,o.createElement(d.a,null,O.map(({id:e,name:n,sortable:a},t)=>o.createElement(u.a,{key:e,sort:a?{sortBy:C,onSort:E,columnIndex:t}:null},n)))),o.createElement(m.a,null,M.map(({name:e,version:n,description:a,status:t,enabled:l,errorMessage:i,hasCSPViolations:s})=>o.createElement(d.a,{key:e},o.createElement(p.a,{dataLabel:O[0].id},N?e:o.createElement(j.hb,{groupVersionKind:V,name:e,hideIcon:!0})),o.createElement(p.a,{dataLabel:O[1].id},n||L.E),o.createElement(p.a,{dataLabel:O[2].id},a||L.E),o.createElement(p.a,{dataLabel:O[3].id},o.createElement(D,{status:t,errorMessage:i})),o.createElement(p.a,{dataLabel:O[4].id},o.createElement(_,{pluginName:e,enabled:l})),o.createElement(p.a,{dataLabel:O[5].id},o.createElement(x,{hasViolations:null!=s&&s})))))):o.createElement(j.u,{label:g("console-app~Console plugins")})):o.createElement(j.S,null)},R=N?e=>{const[n,a]=Object(w.a)(),t=o.useMemo(()=>a?n.filter(k.o).map(e=>{var n,a,o;return{name:e.metadata.name,version:e.metadata.version,description:null===(o=null===(a=null===(n=e.metadata)||void 0===n?void 0:n.customProperties)||void 0===a?void 0:a.console)||void 0===o?void 0:o.description,enabled:e.enabled,status:e.status,hasCSPViolations:e.hasCSPViolations}}):[],[n,a]);return o.createElement(K,Object.assign({},e,{rows:t,loaded:a}))}:e=>{var n,a;const[t,l]=Object(w.a)(),[i,s]=Object(M.a)({isList:!0,kind:Object(S.Hb)(P.ConsolePluginModel)}),r=o.useMemo(()=>{var n,a,o;return null!==(o=null===(a=null===(n=null==e?void 0:e.obj)||void 0===n?void 0:n.spec)||void 0===a?void 0:a.plugins)&&void 0!==o?o:[]},[null===(a=null===(n=null==e?void 0:e.obj)||void 0===n?void 0:n.spec)||void 0===a?void 0:a.plugins]),c=o.useMemo(()=>l&&s?i.map(e=>{var n,a,o,l,i,s,c,d;const u=null===(n=null==e?void 0:e.metadata)||void 0===n?void 0:n.name,m=r.includes(u),p=t.filter(k.o).find(e=>{var n;return(null===(n=null==e?void 0:e.metadata)||void 0===n?void 0:n.name)===u}),v=t.filter(k.q).find(e=>(null==e?void 0:e.pluginName)===u);return p?{name:null===(a=null==e?void 0:e.metadata)||void 0===a?void 0:a.name,version:null===(o=null==p?void 0:p.metadata)||void 0===o?void 0:o.version,description:null===(s=null===(i=null===(l=null==p?void 0:p.metadata)||void 0===l?void 0:l.customProperties)||void 0===i?void 0:i.console)||void 0===s?void 0:s.description,enabled:m,status:null==p?void 0:p.status,hasCSPViolations:null==p?void 0:p.hasCSPViolations}:{name:null===(c=null==e?void 0:e.metadata)||void 0===c?void 0:c.name,enabled:m,status:null==v?void 0:v.status,errorMessage:"Failed"===(null==v?void 0:v.status)?null==v?void 0:v.errorMessage:void 0,errorCause:"Failed"===(null==v?void 0:v.status)?null===(d=null==v?void 0:v.errorCause)||void 0===d?void 0:d.toString():void 0}}):[],[l,s,i,t,r]);return o.createElement(K,Object.assign({},e,{rows:c,loaded:l&&s}))},H=e=>{const n=Object(g.useLocation)(),a=[j.mc.details(O.d),j.mc.editYaml(),{href:"console-plugins",nameKey:"console-app~Console plugins",component:R}],t=[()=>({labelKey:"console-app~Customize",labelKind:{kind:P.ConsoleOperatorConfigModel.kind},dataTest:"Customize",href:"/cluster-configuration",accessReview:Object(j.Eb)(P.ConsoleOperatorConfigModel,{spec:{name:"cluster"}},"patch")})];return o.createElement(h.a,Object.assign({},e,{kind:I,pages:a,menuActions:t,breadcrumbsFor:()=>Object(E.b)(P.ConsoleOperatorConfigModel.label,n.pathname)}))}},5433:function(e,n,a){"use strict";a.r(n);var o=a(0),t=a(69),l=a(2256),i=a(30),s=a(5412);n.default=({obj:e})=>{var n,a;const r=Object(l.a)(),c=o.useMemo(()=>{var n;return null===(n=null==e?void 0:e.metadata)||void 0===n?void 0:n.name},[null===(n=null==e?void 0:e.metadata)||void 0===n?void 0:n.name]),d=o.useMemo(()=>r.findDynamicPluginInfo(c),[r,c]);return d?o.createElement(s.ConsolePluginCSPStatus,{hasViolations:!!Object(t.o)(d)&&(null!==(a=d.hasCSPViolations)&&void 0!==a&&a)}):o.createElement(o.Fragment,null,i.s)}},6272:function(e,n,a){"use strict";a.d(n,"b",(function(){return o})),a.d(n,"a",(function(){return t}));a(283);const o=(e,n)=>(e||"").localeCompare(n||""),t=(e,n)=>(e?0:1)-(n?0:1)}}]);
//# sourceMappingURL=consolePluginCSPStatusDetail-chunk-fd208dfbe2efaee8a5b7.min.js.map